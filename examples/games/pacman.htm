<html>
<head>
  <script type='text/javascript' src="../../lib/js/json.js"></script>
    <script type='text/javascript' src="../../lib/js/regex.js"></script>
    <script type='text/javascript' src="../../lib/js/yahoo/yahoo.js"></script>
    <script type='text/javascript' src="../../lib/js/yahoo/event.js"></script>
    <script type='text/javascript'>var DEBUGGING=false;</script>  <script type='text/javascript' src="../../lib/js/jslib.js"></script>
<script type='text/javascript'><!--
    function _getDatabaseConfig() {
      return {}
    }
    var getDatabaseConfig = LINKS.kify(_getDatabaseConfig);

--> </script>
<script type='text/javascript'><!--
  var cgiEnv = {};
  _makeCgiEnvironment();

--> </script>
<script type='text/javascript'><!--

--> </script>
<!-- $Id: js.ml 1367 2007-12-10 16:24:38Z sam $ -->
</head><body onload=''>
  <script type='text/javascript'>
  _startTimer();function xmlToVariant(x1, __kappa) { LINKS.remoteCall(__kappa)('xmlToVariant', {}, {'1':x1}) }
function serverTime(__kappa) { LINKS.remoteCall(__kappa)('serverTime', {}, {}) }
function InsertRows(x1, x2, __kappa) { LINKS.remoteCall(__kappa)('InsertRows', {}, {'1':x1, '2':x2}) }
function InsertReturning(x1, x2, x3, __kappa) { LINKS.remoteCall(__kappa)('InsertReturning', {}, {'1':x1, '2':x2, '3':x3}) }
function ltilde(x1, x2, __kappa) { LINKS.remoteCall(__kappa)('ltilde', {}, {'1':x1, '2':x2}) }
function stilde(x1, x2, __kappa) { LINKS.remoteCall(__kappa)('stilde', {}, {'1':x1, '2':x2}) }
function unsafePickleCont(x1, __kappa) { LINKS.remoteCall(__kappa)('unsafePickleCont', {}, {'1':x1}) }
function pickle_value(x1, __kappa) { LINKS.remoteCall(__kappa)('pickle_value', {}, {'1':x1}) }
function unpickle_value(x1, __kappa) { LINKS.remoteCall(__kappa)('unpickle_value', {}, {'1':x1}) }
function unsafe_cast(x1, __kappa) { LINKS.remoteCall(__kappa)('unsafe_cast', {}, {'1':x1}) }
function parseXml(x1, __kappa) { LINKS.remoteCall(__kappa)('parseXml', {}, {'1':x1}) }
function dumpTypes(x1, __kappa) { LINKS.remoteCall(__kappa)('dumpTypes', {}, {'1':x1}) }
function connectSocket(x1, x2, __kappa) { LINKS.remoteCall(__kappa)('connectSocket', {}, {'1':x1, '2':x2}) }
function writeToSocket(x1, x2, __kappa) { LINKS.remoteCall(__kappa)('writeToSocket', {}, {'1':x1, '2':x2}) }
function readFromSocket(x1, __kappa) { LINKS.remoteCall(__kappa)('readFromSocket', {}, {'1':x1}) }
function closeSocket(x1, __kappa) { LINKS.remoteCall(__kappa)('closeSocket', {}, {'1':x1}) }
function _219(_env) { return  (function (_217, _218, __kappa) { LINKS.remoteCall(__kappa)('219', _env, {'1':_217, '2':_218}) }) }
function _228(_env) { return  (function (_226, _227, __kappa) { LINKS.remoteCall(__kappa)('228', _env, {'1':_226, '2':_227}) }) }
function _225(_env) { return  (function (_224, __kappa) { LINKS.remoteCall(__kappa)('225', _env, {'1':_224}) }) }
function _233(_env) { return  (function (_231, _232, __kappa) { LINKS.remoteCall(__kappa)('233', _env, {'1':_231, '2':_232}) }) }
function _239(_env) { return  (function (_237, _238, __kappa) { LINKS.remoteCall(__kappa)('239', _env, {'1':_237, '2':_238}) }) }
function _255(_env) { return  (function (_253, _254, __kappa) { LINKS.remoteCall(__kappa)('255', _env, {'1':_253, '2':_254}) }) }
function _252(_env) { return  (function (_251, __kappa) { LINKS.remoteCall(__kappa)('252', _env, {'1':_251}) }) }
function _260(_env) { return  (function (_258, _259, __kappa) { LINKS.remoteCall(__kappa)('260', _env, {'1':_258, '2':_259}) }) }
function _270(_env) { return  (function (_269, __kappa) { LINKS.remoteCall(__kappa)('270', _env, {'1':_269}) }) }
function _276(_env) { return  (function (_275, __kappa) { LINKS.remoteCall(__kappa)('276', _env, {'1':_275}) }) }
function _284(_env) { return  (function (_282, _283, __kappa) { LINKS.remoteCall(__kappa)('284', _env, {'1':_282, '2':_283}) }) }
function _289(_env) { return  (function (_287, _288, __kappa) { LINKS.remoteCall(__kappa)('289', _env, {'1':_287, '2':_288}) }) }
function _299(_env) { return  (function (_298, __kappa) { LINKS.remoteCall(__kappa)('299', _env, {'1':_298}) }) }
function _309(_env) { return  (function (_308, __kappa) { LINKS.remoteCall(__kappa)('309', _env, {'1':_308}) }) }
function _318(_env) { return  (function (_317, __kappa) { LINKS.remoteCall(__kappa)('318', _env, {'1':_317}) }) }
function _316(_env) { return  (function (_314, _315, __kappa) { LINKS.remoteCall(__kappa)('316', _env, {'1':_314, '2':_315}) }) }
function _327(_env) { return  (function (_326, __kappa) { LINKS.remoteCall(__kappa)('327', _env, {'1':_326}) }) }
function _325(_env) { return  (function (_324, __kappa) { LINKS.remoteCall(__kappa)('325', _env, {'1':_324}) }) }
function _323(_env) { return  (function (_322, __kappa) { LINKS.remoteCall(__kappa)('323', _env, {'1':_322}) }) }
function _330(_env) { return  (function (_329, __kappa) { LINKS.remoteCall(__kappa)('330', _env, {'1':_329}) }) }
function _341(_env) { return  (function (_339, _340, __kappa) { LINKS.remoteCall(__kappa)('341', _env, {'1':_339, '2':_340}) }) }
function _352(_env) { return  (function (_351, __kappa) { LINKS.remoteCall(__kappa)('352', _env, {'1':_351}) }) }
function _355(_env) { return  (function (_354, __kappa) { LINKS.remoteCall(__kappa)('355', _env, {'1':_354}) }) }
function _368(_env) { return  (function (_367, __kappa) { LINKS.remoteCall(__kappa)('368', _env, {'1':_367}) }) }
function _361(_env) { return  (function (_359, _360, __kappa) { LINKS.remoteCall(__kappa)('361', _env, {'1':_359, '2':_360}) }) }
function _371(_env) { return  (function (_370, __kappa) { LINKS.remoteCall(__kappa)('371', _env, {'1':_370}) }) }
function _379(_env) { return  (function (_378, __kappa) { LINKS.remoteCall(__kappa)('379', _env, {'1':_378}) }) }
function _377(_env) { return  (function (_375, _376, __kappa) { LINKS.remoteCall(__kappa)('377', _env, {'1':_375, '2':_376}) }) }
function _382(_env) { return  (function (_381, __kappa) { LINKS.remoteCall(__kappa)('382', _env, {'1':_381}) }) }
function _385(_env) { return  (function (_384, __kappa) { LINKS.remoteCall(__kappa)('385', _env, {'1':_384}) }) }
function _395(_env) { return  (function (_393, _394, __kappa) { LINKS.remoteCall(__kappa)('395', _env, {'1':_393, '2':_394}) }) }
function _404(_env) { return  (function (_403, __kappa) { LINKS.remoteCall(__kappa)('404', _env, {'1':_403}) }) }
function _411(_env) {
return  (function (_408, _409, _410, __kappa) { LINKS.remoteCall(__kappa)('411', _env, {'1':_408, '2':_409, '3':_410}) })
}
function _424(_env) { return  (function (_422, _423, __kappa) { LINKS.remoteCall(__kappa)('424', _env, {'1':_422, '2':_423}) }) }
function _431(_env) {
return  (function (_428, _429, _430, __kappa) { LINKS.remoteCall(__kappa)('431', _env, {'1':_428, '2':_429, '3':_430}) })
}
function _448(_env) {
return  (function (_445, _446, _447, __kappa) { LINKS.remoteCall(__kappa)('448', _env, {'1':_445, '2':_446, '3':_447}) })
}
function _444(_env) { return  (function (_443, __kappa) { LINKS.remoteCall(__kappa)('444', _env, {'1':_443}) }) }
function _455(_env) {
return  (function (_452, _453, _454, __kappa) { LINKS.remoteCall(__kappa)('455', _env, {'1':_452, '2':_453, '3':_454}) })
}
function _466(_env) { return  (function (_464, _465, __kappa) { LINKS.remoteCall(__kappa)('466', _env, {'1':_464, '2':_465}) }) }
function _469(_env) { return  (function (_468, __kappa) { LINKS.remoteCall(__kappa)('469', _env, {'1':_468}) }) }
function _472(_env) { return  (function (_471, __kappa) { LINKS.remoteCall(__kappa)('472', _env, {'1':_471}) }) }
function _475(_env) { return  (function (_474, __kappa) { LINKS.remoteCall(__kappa)('475', _env, {'1':_474}) }) }
function _492(_env) { return  (function (_490, _491, __kappa) { LINKS.remoteCall(__kappa)('492', _env, {'1':_490, '2':_491}) }) }
function _482(_env) { return  (function (_480, _481, __kappa) { LINKS.remoteCall(__kappa)('482', _env, {'1':_480, '2':_481}) }) }
function _495(_env) { return  (function (_494, __kappa) { LINKS.remoteCall(__kappa)('495', _env, {'1':_494}) }) }
function _505(_env) { return  (function (_503, _504, __kappa) { LINKS.remoteCall(__kappa)('505', _env, {'1':_503, '2':_504}) }) }
function _510(_env) { return  (function (_509, __kappa) { LINKS.remoteCall(__kappa)('510', _env, {'1':_509}) }) }
function _522(_env) { return  (function (_520, _521, __kappa) { LINKS.remoteCall(__kappa)('522', _env, {'1':_520, '2':_521}) }) }
function _525(_env) { return  (function (_524, __kappa) { LINKS.remoteCall(__kappa)('525', _env, {'1':_524}) }) }
function _527(_env) { return  (function (_526, __kappa) { LINKS.remoteCall(__kappa)('527', _env, {'1':_526}) }) }
function _530(_env) { return  (function (_529, __kappa) { LINKS.remoteCall(__kappa)('530', _env, {'1':_529}) }) }
function _537(_env) { return  (function (_535, _536, __kappa) { LINKS.remoteCall(__kappa)('537', _env, {'1':_535, '2':_536}) }) }
function _542(_env) { return  (function (_540, _541, __kappa) { LINKS.remoteCall(__kappa)('542', _env, {'1':_540, '2':_541}) }) }
function _560(_env) { return  (function (_558, _559, __kappa) { LINKS.remoteCall(__kappa)('560', _env, {'1':_558, '2':_559}) }) }
function _574(_env) { return  (function (_573, __kappa) { LINKS.remoteCall(__kappa)('574', _env, {'1':_573}) }) }
function _571(_env) { return  (function (_570, __kappa) { LINKS.remoteCall(__kappa)('571', _env, {'1':_570}) }) }
function _577(_env) { return  (function (_576, __kappa) { LINKS.remoteCall(__kappa)('577', _env, {'1':_576}) }) }
function _581(_env) { return  (function (_580, __kappa) { LINKS.remoteCall(__kappa)('581', _env, {'1':_580}) }) }
function _584(_env) { return  (function (_583, __kappa) { LINKS.remoteCall(__kappa)('584', _env, {'1':_583}) }) }
function _587(_env) { return  (function (_586, __kappa) { LINKS.remoteCall(__kappa)('587', _env, {'1':_586}) }) }
function _590(_env) { return  (function (_589, __kappa) { LINKS.remoteCall(__kappa)('590', _env, {'1':_589}) }) }
function _607(_env) { return  (function (_605, _606, __kappa) { LINKS.remoteCall(__kappa)('607', _env, {'1':_605, '2':_606}) }) }
function _617(_env) { return  (function (_616, __kappa) { LINKS.remoteCall(__kappa)('617', _env, {'1':_616}) }) }
function _620(_env) { return  (function (_619, __kappa) { LINKS.remoteCall(__kappa)('620', _env, {'1':_619}) }) }
function _632(_env) { return  (function (_630, _631, __kappa) { LINKS.remoteCall(__kappa)('632', _env, {'1':_630, '2':_631}) }) }
function _629(_env) {
return  (function (_626, _627, _628, __kappa) { LINKS.remoteCall(__kappa)('629', _env, {'1':_626, '2':_627, '3':_628}) })
}
function _637(_env) { return  (function (_635, _636, __kappa) { LINKS.remoteCall(__kappa)('637', _env, {'1':_635, '2':_636}) }) }
function _649(_env) { return  (function (_648, __kappa) { LINKS.remoteCall(__kappa)('649', _env, {'1':_648}) }) }
function _658(_env) { return  (function (_656, _657, __kappa) { LINKS.remoteCall(__kappa)('658', _env, {'1':_656, '2':_657}) }) }
function _661(_env) { return  (function (_660, __kappa) { LINKS.remoteCall(__kappa)('661', _env, {'1':_660}) }) }
function _668(_env) { return  (function (_667, __kappa) { LINKS.remoteCall(__kappa)('668', _env, {'1':_667}) }) }
function _671(_env) { return  (function (_670, __kappa) { LINKS.remoteCall(__kappa)('671', _env, {'1':_670}) }) }
function _676(_env) { return  (function (_674, _675, __kappa) { LINKS.remoteCall(__kappa)('676', _env, {'1':_674, '2':_675}) }) }
function _687(_env) { return  (function (_685, _686, __kappa) { LINKS.remoteCall(__kappa)('687', _env, {'1':_685, '2':_686}) }) }
function _702(_env) { return  (function (_700, _701, __kappa) { LINKS.remoteCall(__kappa)('702', _env, {'1':_700, '2':_701}) }) }
function _716(_env) { return  (function (_714, _715, __kappa) { LINKS.remoteCall(__kappa)('716', _env, {'1':_714, '2':_715}) }) }
function _731(_env) { return  (function (_729, _730, __kappa) { LINKS.remoteCall(__kappa)('731', _env, {'1':_729, '2':_730}) }) }
function _745(_env) { return  (function (_743, _744, __kappa) { LINKS.remoteCall(__kappa)('745', _env, {'1':_743, '2':_744}) }) }
function _757(_env) { return  (function (_755, _756, __kappa) { LINKS.remoteCall(__kappa)('757', _env, {'1':_755, '2':_756}) }) }
function _774(_env) { return  (function (_773, __kappa) { LINKS.remoteCall(__kappa)('774', _env, {'1':_773}) }) }
function _782(_env) { return  (function (_781, __kappa) { LINKS.remoteCall(__kappa)('782', _env, {'1':_781}) }) }
function _788(_env) { return  (function (_786, _787, __kappa) { LINKS.remoteCall(__kappa)('788', _env, {'1':_786, '2':_787}) }) }
function _800(_env) { return  (function (_798, _799, __kappa) { LINKS.remoteCall(__kappa)('800', _env, {'1':_798, '2':_799}) }) }
function _797(_env) { return  (function (_796, __kappa) { LINKS.remoteCall(__kappa)('797', _env, {'1':_796}) }) }
function _803(_env) { return  (function (_802, __kappa) { LINKS.remoteCall(__kappa)('803', _env, {'1':_802}) }) }
function _809(_env) { return  (function (_808, __kappa) { LINKS.remoteCall(__kappa)('809', _env, {'1':_808}) }) }
function _807(_env) { return  (function (_806, __kappa) { LINKS.remoteCall(__kappa)('807', _env, {'1':_806}) }) }
function _816(_env) { return  (function (_815, __kappa) { LINKS.remoteCall(__kappa)('816', _env, {'1':_815}) }) }
function _814(_env) { return  (function (_813, __kappa) { LINKS.remoteCall(__kappa)('814', _env, {'1':_813}) }) }
function _819(_env) { return  (function (_818, __kappa) { LINKS.remoteCall(__kappa)('819', _env, {'1':_818}) }) }
function _836(_env) { return  (function (_834, _835, __kappa) { LINKS.remoteCall(__kappa)('836', _env, {'1':_834, '2':_835}) }) }
function _833(_env) { return  (function (_832, __kappa) { LINKS.remoteCall(__kappa)('833', _env, {'1':_832}) }) }
function _830(_env) { return  (function (_829, __kappa) { LINKS.remoteCall(__kappa)('830', _env, {'1':_829}) }) }
function _852(_env) { return  (function (_850, _851, __kappa) { LINKS.remoteCall(__kappa)('852', _env, {'1':_850, '2':_851}) }) }
function _858(_env) { return  (function (_856, _857, __kappa) { LINKS.remoteCall(__kappa)('858', _env, {'1':_856, '2':_857}) }) }
function _881(_env) { return  (function (_879, _880, __kappa) { LINKS.remoteCall(__kappa)('881', _env, {'1':_879, '2':_880}) }) }
function _878(_env) { return  (function (_877, __kappa) { LINKS.remoteCall(__kappa)('878', _env, {'1':_877}) }) }
function _876(_env) { return  (function (_875, __kappa) { LINKS.remoteCall(__kappa)('876', _env, {'1':_875}) }) }
function _874(_env) { return  (function (_873, __kappa) { LINKS.remoteCall(__kappa)('874', _env, {'1':_873}) }) }
function _886(_env) { return  (function (_885, __kappa) { LINKS.remoteCall(__kappa)('886', _env, {'1':_885}) }) }
function _884(_env) { return  (function (_883, __kappa) { LINKS.remoteCall(__kappa)('884', _env, {'1':_883}) }) }
function _892(_env) { return  (function (_890, _891, __kappa) { LINKS.remoteCall(__kappa)('892', _env, {'1':_890, '2':_891}) }) }
function _897(_env) { return  (function (_895, _896, __kappa) { LINKS.remoteCall(__kappa)('897', _env, {'1':_895, '2':_896}) }) }
function _900(_env) { return  (function (_899, __kappa) { LINKS.remoteCall(__kappa)('900', _env, {'1':_899}) }) }
function _904(_env) { return  (function (_903, __kappa) { LINKS.remoteCall(__kappa)('904', _env, {'1':_903}) }) }
function _908(_env) { return  (function (_907, __kappa) { LINKS.remoteCall(__kappa)('908', _env, {'1':_907}) }) }
function _920(_env) { return  (function (_919, __kappa) { LINKS.remoteCall(__kappa)('920', _env, {'1':_919}) }) }
function _917(_env) { return  (function (_916, __kappa) { LINKS.remoteCall(__kappa)('917', _env, {'1':_916}) }) }
function _924(_env) { return  (function (_923, __kappa) { LINKS.remoteCall(__kappa)('924', _env, {'1':_923}) }) }
function _963(_env) { return  (function (_962, __kappa) { LINKS.remoteCall(__kappa)('963', _env, {'1':_962}) }) }
function _953(_env) { return  (function (_952, __kappa) { LINKS.remoteCall(__kappa)('953', _env, {'1':_952}) }) }
function _959(_env) { return  (function (_958, __kappa) { LINKS.remoteCall(__kappa)('959', _env, {'1':_958}) }) }
function _939(_env) { return  (function (_938, __kappa) { LINKS.remoteCall(__kappa)('939', _env, {'1':_938}) }) }
function _937(_env) { return  (function (_936, __kappa) { LINKS.remoteCall(__kappa)('937', _env, {'1':_936}) }) }
function _948(_env) { return  (function (_947, __kappa) { LINKS.remoteCall(__kappa)('948', _env, {'1':_947}) }) }
function _969(_env) { return  (function (_968, __kappa) { LINKS.remoteCall(__kappa)('969', _env, {'1':_968}) }) }
function _967(_env) { return  (function (_966, __kappa) { LINKS.remoteCall(__kappa)('967', _env, {'1':_966}) }) }
function _978(_env) { return  (function (_977, __kappa) { LINKS.remoteCall(__kappa)('978', _env, {'1':_977}) }) }
function _976(_env) { return  (function (_975, __kappa) { LINKS.remoteCall(__kappa)('976', _env, {'1':_975}) }) }
function _974(_env) { return  (function (_973, __kappa) { LINKS.remoteCall(__kappa)('974', _env, {'1':_973}) }) }
function _982(_env) { return  (function (_981, __kappa) { LINKS.remoteCall(__kappa)('982', _env, {'1':_981}) }) }
function _980(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('980', _env, {}) }) }
function _992(_env) {
return  (function (_989, _990, _991, __kappa) { LINKS.remoteCall(__kappa)('992', _env, {'1':_989, '2':_990, '3':_991}) })
}
function _987(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('987', _env, {}) }) }
function _1005(_env) {
return 
  (function (_999, _1000, _1001, _1002, _1003, _1004, __kappa) {
  LINKS.remoteCall(__kappa)('1005', _env, {'1':_999, '2':_1000, '3':_1001, '4':_1002, '5':_1003, '6':_1004})
  })
}
function _1025(_env) { return  (function (_1024, __kappa) { LINKS.remoteCall(__kappa)('1025', _env, {'1':_1024}) }) }
function _1017(_env) { return  (function (_1016, __kappa) { LINKS.remoteCall(__kappa)('1017', _env, {'1':_1016}) }) }
function _1021(_env) { return  (function (_1020, __kappa) { LINKS.remoteCall(__kappa)('1021', _env, {'1':_1020}) }) }
function _1048(_env) { return  (function (_1046, _1047, __kappa) { LINKS.remoteCall(__kappa)('1048', _env, {'1':_1046, '2':_1047}) }) }
function _1045(_env) { return  (function (_1044, __kappa) { LINKS.remoteCall(__kappa)('1045', _env, {'1':_1044}) }) }
function _1040(_env) { return  (function (_1039, __kappa) { LINKS.remoteCall(__kappa)('1040', _env, {'1':_1039}) }) }
function _1051(_env) { return  (function (_1050, __kappa) { LINKS.remoteCall(__kappa)('1051', _env, {'1':_1050}) }) }
function _1071(_env) { return  (function (_1070, __kappa) { LINKS.remoteCall(__kappa)('1071', _env, {'1':_1070}) }) }
function _1064(_env) { return  (function (_1062, _1063, __kappa) { LINKS.remoteCall(__kappa)('1064', _env, {'1':_1062, '2':_1063}) }) }
function _1061(_env) { return  (function (_1060, __kappa) { LINKS.remoteCall(__kappa)('1061', _env, {'1':_1060}) }) }
function _1068(_env) { return  (function (_1067, __kappa) { LINKS.remoteCall(__kappa)('1068', _env, {'1':_1067}) }) }
function _1082(_env) { return  (function (_1080, _1081, __kappa) { LINKS.remoteCall(__kappa)('1082', _env, {'1':_1080, '2':_1081}) }) }
function _1079(_env) { return  (function (_1078, __kappa) { LINKS.remoteCall(__kappa)('1079', _env, {'1':_1078}) }) }
function _1085(_env) { return  (function (_1084, __kappa) { LINKS.remoteCall(__kappa)('1085', _env, {'1':_1084}) }) }
function _1102(_env) {
return 
  (function (_1098, _1099, _1100, _1101, __kappa) { LINKS.remoteCall(__kappa)('1102', _env, {'1':_1098, '2':_1099, '3':_1100, '4':_1101}) })
}
function _1097(_env) {
return  (function (_1094, _1095, _1096, __kappa) { LINKS.remoteCall(__kappa)('1097', _env, {'1':_1094, '2':_1095, '3':_1096}) })
}
function _1122(_env) {
return  (function (_1119, _1120, _1121, __kappa) { LINKS.remoteCall(__kappa)('1122', _env, {'1':_1119, '2':_1120, '3':_1121}) })
}
function _1118(_env) { return  (function (_1115, __kappa) { LINKS.remoteCall(__kappa)('1118', _env, {'1':_1115}) }) }
function _1113(_env) { return  (function (_1112, __kappa) { LINKS.remoteCall(__kappa)('1113', _env, {'1':_1112}) }) }
function _1137(_env) { return  (function (_1135, _1136, __kappa) { LINKS.remoteCall(__kappa)('1137', _env, {'1':_1135, '2':_1136}) }) }
function _1134(_env) { return  (function (_1133, __kappa) { LINKS.remoteCall(__kappa)('1134', _env, {'1':_1133}) }) }
function _1131(_env) { return  (function (_1130, __kappa) { LINKS.remoteCall(__kappa)('1131', _env, {'1':_1130}) }) }
function _1149(_env) { return  (function (_1148, __kappa) { LINKS.remoteCall(__kappa)('1149', _env, {'1':_1148}) }) }
function _1141(_env) { return  (function (_1140, __kappa) { LINKS.remoteCall(__kappa)('1141', _env, {'1':_1140}) }) }
function _1146(_env) { return  (function (_1144, _1145, __kappa) { LINKS.remoteCall(__kappa)('1146', _env, {'1':_1144, '2':_1145}) }) }
function _1164(_env) { return  (function (_1163, __kappa) { LINKS.remoteCall(__kappa)('1164', _env, {'1':_1163}) }) }
function _1155(_env) { return  (function (_1154, __kappa) { LINKS.remoteCall(__kappa)('1155', _env, {'1':_1154}) }) }
function _1162(_env) { return  (function (_1160, _1161, __kappa) { LINKS.remoteCall(__kappa)('1162', _env, {'1':_1160, '2':_1161}) }) }
function _1168(_env) { return  (function (_1167, __kappa) { LINKS.remoteCall(__kappa)('1168', _env, {'1':_1167}) }) }
function _1174(_env) { return  (function (_1172, _1173, __kappa) { LINKS.remoteCall(__kappa)('1174', _env, {'1':_1172, '2':_1173}) }) }
function _1178(_env) { return  (function (_1177, __kappa) { LINKS.remoteCall(__kappa)('1178', _env, {'1':_1177}) }) }
function _1182(_env) { return  (function (_1181, __kappa) { LINKS.remoteCall(__kappa)('1182', _env, {'1':_1181}) }) }
function _1186(_env) { return  (function (_1185, __kappa) { LINKS.remoteCall(__kappa)('1186', _env, {'1':_1185}) }) }
function _1190(_env) { return  (function (_1189, __kappa) { LINKS.remoteCall(__kappa)('1190', _env, {'1':_1189}) }) }
function _1194(_env) { return  (function (_1193, __kappa) { LINKS.remoteCall(__kappa)('1194', _env, {'1':_1193}) }) }
function _1212(_env) { return  (function (_1211, __kappa) { LINKS.remoteCall(__kappa)('1212', _env, {'1':_1211}) }) }
function _1210(_env) { return  (function (_1209, __kappa) { LINKS.remoteCall(__kappa)('1210', _env, {'1':_1209}) }) }
function _1207(_env) { return  (function (_1206, __kappa) { LINKS.remoteCall(__kappa)('1207', _env, {'1':_1206}) }) }
function _1204(_env) { return  (function (_1203, __kappa) { LINKS.remoteCall(__kappa)('1204', _env, {'1':_1203}) }) }
function _1231(_env) { return  (function (_1229, _1230, __kappa) { LINKS.remoteCall(__kappa)('1231', _env, {'1':_1229, '2':_1230}) }) }
function _1228(_env) { return  (function (_1227, __kappa) { LINKS.remoteCall(__kappa)('1228', _env, {'1':_1227}) }) }
function _1226(_env) { return  (function (_1225, __kappa) { LINKS.remoteCall(__kappa)('1226', _env, {'1':_1225}) }) }
function _1234(_env) { return  (function (_1233, __kappa) { LINKS.remoteCall(__kappa)('1234', _env, {'1':_1233}) }) }
function _1245(_env) { return  (function (_1244, __kappa) { LINKS.remoteCall(__kappa)('1245', _env, {'1':_1244}) }) }
function _1238(_env) { return  (function (_1237, __kappa) { LINKS.remoteCall(__kappa)('1238', _env, {'1':_1237}) }) }
function _1243(_env) { return  (function (_1241, _1242, __kappa) { LINKS.remoteCall(__kappa)('1243', _env, {'1':_1241, '2':_1242}) }) }
function _1248(_env) { return  (function (_1247, __kappa) { LINKS.remoteCall(__kappa)('1248', _env, {'1':_1247}) }) }
function _1251(_env) { return  (function (_1250, __kappa) { LINKS.remoteCall(__kappa)('1251', _env, {'1':_1250}) }) }
function _1255(_env) { return  (function (_1254, __kappa) { LINKS.remoteCall(__kappa)('1255', _env, {'1':_1254}) }) }
function _1278(_env) {
return  (function (_1275, _1276, _1277, __kappa) { LINKS.remoteCall(__kappa)('1278', _env, {'1':_1275, '2':_1276, '3':_1277}) })
}
function _1274(_env) { return  (function (_1273, __kappa) { LINKS.remoteCall(__kappa)('1274', _env, {'1':_1273}) }) }
function _1272(_env) { return  (function (_1271, __kappa) { LINKS.remoteCall(__kappa)('1272', _env, {'1':_1271}) }) }
function _1267(_env) { return  (function (_1266, __kappa) { LINKS.remoteCall(__kappa)('1267', _env, {'1':_1266}) }) }
function _1265(_env) { return  (function (_1264, __kappa) { LINKS.remoteCall(__kappa)('1265', _env, {'1':_1264}) }) }
function _1283(_env) { return  (function (_1281, _1282, __kappa) { LINKS.remoteCall(__kappa)('1283', _env, {'1':_1281, '2':_1282}) }) }
function _1302(_env) { return  (function (_1301, __kappa) { LINKS.remoteCall(__kappa)('1302', _env, {'1':_1301}) }) }
function _1334(_env) { return  (function (_1332, _1333, __kappa) { LINKS.remoteCall(__kappa)('1334', _env, {'1':_1332, '2':_1333}) }) }
function _1331(_env) { return  (function (_1330, __kappa) { LINKS.remoteCall(__kappa)('1331', _env, {'1':_1330}) }) }
function _1327(_env) { return  (function (_1326, __kappa) { LINKS.remoteCall(__kappa)('1327', _env, {'1':_1326}) }) }
function _1323(_env) { return  (function (_1322, __kappa) { LINKS.remoteCall(__kappa)('1323', _env, {'1':_1322}) }) }
function _1319(_env) { return  (function (_1318, __kappa) { LINKS.remoteCall(__kappa)('1319', _env, {'1':_1318}) }) }
function _1373(_env) {
return  (function (_1370, _1371, _1372, __kappa) { LINKS.remoteCall(__kappa)('1373', _env, {'1':_1370, '2':_1371, '3':_1372}) })
}
function _1369(_env) { return  (function (_1368, __kappa) { LINKS.remoteCall(__kappa)('1369', _env, {'1':_1368}) }) }
function _1365(_env) { return  (function (_1364, __kappa) { LINKS.remoteCall(__kappa)('1365', _env, {'1':_1364}) }) }
function _1361(_env) { return  (function (_1360, __kappa) { LINKS.remoteCall(__kappa)('1361', _env, {'1':_1360}) }) }
function _1349(_env) { return  (function (_1348, __kappa) { LINKS.remoteCall(__kappa)('1349', _env, {'1':_1348}) }) }
function _1347(_env) { return  (function (_1346, __kappa) { LINKS.remoteCall(__kappa)('1347', _env, {'1':_1346}) }) }
function _1359(_env) { return  (function (_1358, __kappa) { LINKS.remoteCall(__kappa)('1359', _env, {'1':_1358}) }) }
function _1376(_env) { return  (function (_1375, __kappa) { LINKS.remoteCall(__kappa)('1376', _env, {'1':_1375}) }) }
function _1397(_env) { return  (function (_1396, __kappa) { LINKS.remoteCall(__kappa)('1397', _env, {'1':_1396}) }) }
function _1434(_env) { return  (function (_1433, __kappa) { LINKS.remoteCall(__kappa)('1434', _env, {'1':_1433}) }) }
function _1432(_env) { return  (function (_1431, __kappa) { LINKS.remoteCall(__kappa)('1432', _env, {'1':_1431}) }) }
function _1428(_env) { return  (function (_1427, __kappa) { LINKS.remoteCall(__kappa)('1428', _env, {'1':_1427}) }) }
function _1424(_env) { return  (function (_1423, __kappa) { LINKS.remoteCall(__kappa)('1424', _env, {'1':_1423}) }) }
function _1419(_env) { return  (function (_1418, __kappa) { LINKS.remoteCall(__kappa)('1419', _env, {'1':_1418}) }) }
function _1411(_env) { return  (function (_1410, __kappa) { LINKS.remoteCall(__kappa)('1411', _env, {'1':_1410}) }) }
function _1442(_env) { return  (function (_1441, __kappa) { LINKS.remoteCall(__kappa)('1442', _env, {'1':_1441}) }) }
function _1439(_env) { return  (function (_1438, __kappa) { LINKS.remoteCall(__kappa)('1439', _env, {'1':_1438}) }) }
function _1447(_env) { return  (function (_1446, __kappa) { LINKS.remoteCall(__kappa)('1447', _env, {'1':_1446}) }) }
function _1459(_env) { return  (function (_1457, _1458, __kappa) { LINKS.remoteCall(__kappa)('1459', _env, {'1':_1457, '2':_1458}) }) }
function _1456(_env) { return  (function (_1454, _1455, __kappa) { LINKS.remoteCall(__kappa)('1456', _env, {'1':_1454, '2':_1455}) }) }
function _1484(_env) { return  (function (_1482, _1483, __kappa) { LINKS.remoteCall(__kappa)('1484', _env, {'1':_1482, '2':_1483}) }) }
function _1481(_env) { return  (function (_1480, __kappa) { LINKS.remoteCall(__kappa)('1481', _env, {'1':_1480}) }) }
function _1479(_env) { return  (function (_1478, __kappa) { LINKS.remoteCall(__kappa)('1479', _env, {'1':_1478}) }) }
function _1506(_env) {
return 
  (function (_1502, _1503, _1504, _1505, __kappa) { LINKS.remoteCall(__kappa)('1506', _env, {'1':_1502, '2':_1503, '3':_1504, '4':_1505}) })
}
function _1494(_env) { return  (function (_1493, __kappa) { LINKS.remoteCall(__kappa)('1494', _env, {'1':_1493}) }) }
function _1500(_env) { return  (function (_1499, __kappa) { LINKS.remoteCall(__kappa)('1500', _env, {'1':_1499}) }) }
function _1513(_env) { return  (function (_1512, __kappa) { LINKS.remoteCall(__kappa)('1513', _env, {'1':_1512}) }) }
function _1510(_env) { return  (function (_1509, __kappa) { LINKS.remoteCall(__kappa)('1510', _env, {'1':_1509}) }) }
function _1521(_env) { return  (function (_1520, __kappa) { LINKS.remoteCall(__kappa)('1521', _env, {'1':_1520}) }) }
function _1519(_env) { return  (function (_1518, __kappa) { LINKS.remoteCall(__kappa)('1519', _env, {'1':_1518}) }) }
function _1528(_env) { return  (function (_1527, __kappa) { LINKS.remoteCall(__kappa)('1528', _env, {'1':_1527}) }) }
function _1526(_env) { return  (function (_1525, __kappa) { LINKS.remoteCall(__kappa)('1526', _env, {'1':_1525}) }) }
function _1535(_env) { return  (function (_1534, __kappa) { LINKS.remoteCall(__kappa)('1535', _env, {'1':_1534}) }) }
function _1532(_env) { return  (function (_1531, __kappa) { LINKS.remoteCall(__kappa)('1532', _env, {'1':_1531}) }) }
function _1543(_env) { return  (function (_1542, __kappa) { LINKS.remoteCall(__kappa)('1543', _env, {'1':_1542}) }) }
function _1541(_env) { return  (function (returnf_1538, __kappa) { LINKS.remoteCall(__kappa)('1541', _env, {'1':returnf_1538}) }) }
function _1548(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('1548', _env, {}) }) }
function _1547(_env) { return  (function (esc_1544, __kappa) { LINKS.remoteCall(__kappa)('1547', _env, {'1':esc_1544}) }) }
function _1552(_env) { return  (function (_1551, __kappa) { LINKS.remoteCall(__kappa)('1552', _env, {'1':_1551}) }) }
function _1557(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('1557', _env, {}) }) }
function _1555(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('1555', _env, {}) }) }
function _1566(_env) { return  (function (_1565, __kappa) { LINKS.remoteCall(__kappa)('1566', _env, {'1':_1565}) }) }
function _1563(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('1563', _env, {}) }) }
function _1570(_env) { return  (function (_1569, __kappa) { LINKS.remoteCall(__kappa)('1570', _env, {'1':_1569}) }) }
function _1580(_env) { return  (function (_1579, __kappa) { LINKS.remoteCall(__kappa)('1580', _env, {'1':_1579}) }) }
function _1577(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('1577', _env, {}) }) }
function _1589(_env) { return  (function (_1588, __kappa) { LINKS.remoteCall(__kappa)('1589', _env, {'1':_1588}) }) }
function _1586(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('1586', _env, {}) }) }
function _1594(_env) { return  (function (_1592, _1593, __kappa) { LINKS.remoteCall(__kappa)('1594', _env, {'1':_1592, '2':_1593}) }) }
function _1596(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('1596', _env, {}) }) }
function _1607(_env) { return  (function (_1606, __kappa) { LINKS.remoteCall(__kappa)('1607', _env, {'1':_1606}) }) }
function _1604(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('1604', _env, {}) }) }
function _1615(_env) { return  (function (_1614, __kappa) { LINKS.remoteCall(__kappa)('1615', _env, {'1':_1614}) }) }
function _1621(_env) { return  (function (_1619, _1620, __kappa) { LINKS.remoteCall(__kappa)('1621', _env, {'1':_1619, '2':_1620}) }) }
function _1626(_env) { return  (function (_1624, _1625, __kappa) { LINKS.remoteCall(__kappa)('1626', _env, {'1':_1624, '2':_1625}) }) }
function _1631(_env) { return  (function (_1630, __kappa) { LINKS.remoteCall(__kappa)('1631', _env, {'1':_1630}) }) }
function _1636(_env) { return  (function (_1634, _1635, __kappa) { LINKS.remoteCall(__kappa)('1636', _env, {'1':_1634, '2':_1635}) }) }
function _1641(_env) { return  (function (_1639, _1640, __kappa) { LINKS.remoteCall(__kappa)('1641', _env, {'1':_1639, '2':_1640}) }) }
function _1646(_env) { return  (function (_1644, _1645, __kappa) { LINKS.remoteCall(__kappa)('1646', _env, {'1':_1644, '2':_1645}) }) }
function _1650(_env) { return  (function (_1649, __kappa) { LINKS.remoteCall(__kappa)('1650', _env, {'1':_1649}) }) }
function _1660(_env) { return  (function (_1658, _1659, __kappa) { LINKS.remoteCall(__kappa)('1660', _env, {'1':_1658, '2':_1659}) }) }
function _1669(_env) {
return  (function (_1666, _1667, _1668, __kappa) { LINKS.remoteCall(__kappa)('1669', _env, {'1':_1666, '2':_1667, '3':_1668}) })
}
function _1677(_env) { return  (function (_1675, _1676, __kappa) { LINKS.remoteCall(__kappa)('1677', _env, {'1':_1675, '2':_1676}) }) }
function _1692(_env) { return  (function (_1691, __kappa) { LINKS.remoteCall(__kappa)('1692', _env, {'1':_1691}) }) }
function _1683(_env) { return  (function (_1681, _1682, __kappa) { LINKS.remoteCall(__kappa)('1683', _env, {'1':_1681, '2':_1682}) }) }
function _1699(_env) { return  (function (_1697, _1698, __kappa) { LINKS.remoteCall(__kappa)('1699', _env, {'1':_1697, '2':_1698}) }) }
function _1703(_env) { return  (function (_1702, __kappa) { LINKS.remoteCall(__kappa)('1703', _env, {'1':_1702}) }) }
function _1714(_env) {
return  (function (_1711, _1712, _1713, __kappa) { LINKS.remoteCall(__kappa)('1714', _env, {'1':_1711, '2':_1712, '3':_1713}) })
}
function _1720(_env) { return  (function (_1718, _1719, __kappa) { LINKS.remoteCall(__kappa)('1720', _env, {'1':_1718, '2':_1719}) }) }
function _1726(_env) { return  (function (_1725, __kappa) { LINKS.remoteCall(__kappa)('1726', _env, {'1':_1725}) }) }
function _1737(_env) { return  (function (_1736, __kappa) { LINKS.remoteCall(__kappa)('1737', _env, {'1':_1736}) }) }
function _1735(_env) { return  (function (_1734, __kappa) { LINKS.remoteCall(__kappa)('1735', _env, {'1':_1734}) }) }
function _1744(_env) { return  (function (_1742, _1743, __kappa) { LINKS.remoteCall(__kappa)('1744', _env, {'1':_1742, '2':_1743}) }) }
function _1749(_env) { return  (function (_1747, _1748, __kappa) { LINKS.remoteCall(__kappa)('1749', _env, {'1':_1747, '2':_1748}) }) }
function _1767(_env) { return  (function (_1765, _1766, __kappa) { LINKS.remoteCall(__kappa)('1767', _env, {'1':_1765, '2':_1766}) }) }
function _1759(_env) {
return  (function (_1756, _1757, _1758, __kappa) { LINKS.remoteCall(__kappa)('1759', _env, {'1':_1756, '2':_1757, '3':_1758}) })
}
function _1793(_env) {
return  (function (_1790, _1791, _1792, __kappa) { LINKS.remoteCall(__kappa)('1793', _env, {'1':_1790, '2':_1791, '3':_1792}) })
}
function _1779(_env) {
return 
  (function (_1775, _1776, _1777, _1778, __kappa) { LINKS.remoteCall(__kappa)('1779', _env, {'1':_1775, '2':_1776, '3':_1777, '4':_1778}) })
}
function _1806(_env) {
return  (function (_1803, _1804, _1805, __kappa) { LINKS.remoteCall(__kappa)('1806', _env, {'1':_1803, '2':_1804, '3':_1805}) })
}
function _1802(_env) { return  (function (_1800, _1801, __kappa) { LINKS.remoteCall(__kappa)('1802', _env, {'1':_1800, '2':_1801}) }) }
function _1811(_env) { return  (function (_1809, _1810, __kappa) { LINKS.remoteCall(__kappa)('1811', _env, {'1':_1809, '2':_1810}) }) }
function _1827(_env) {
return  (function (_1824, _1825, _1826, __kappa) { LINKS.remoteCall(__kappa)('1827', _env, {'1':_1824, '2':_1825, '3':_1826}) })
}
function _1823(_env) { return  (function (_1821, _1822, __kappa) { LINKS.remoteCall(__kappa)('1823', _env, {'1':_1821, '2':_1822}) }) }
function _1848(_env) {
return  (function (_1845, _1846, _1847, __kappa) { LINKS.remoteCall(__kappa)('1848', _env, {'1':_1845, '2':_1846, '3':_1847}) })
}
function _1839(_env) {
return 
  (function (_1835, _1836, _1837, _1838, __kappa) { LINKS.remoteCall(__kappa)('1839', _env, {'1':_1835, '2':_1836, '3':_1837, '4':_1838}) })
}
function _1853(_env) { return  (function (_1852, __kappa) { LINKS.remoteCall(__kappa)('1853', _env, {'1':_1852}) }) }
function _1864(_env) {
return  (function (_1861, _1862, _1863, __kappa) { LINKS.remoteCall(__kappa)('1864', _env, {'1':_1861, '2':_1862, '3':_1863}) })
}
function _1860(_env) { return  (function (_1858, _1859, __kappa) { LINKS.remoteCall(__kappa)('1860', _env, {'1':_1858, '2':_1859}) }) }
function _1867(_env) { return  (function (_1866, __kappa) { LINKS.remoteCall(__kappa)('1867', _env, {'1':_1866}) }) }
function _1870(_env) { return  (function (_1869, __kappa) { LINKS.remoteCall(__kappa)('1870', _env, {'1':_1869}) }) }
function _1875(_env) { return  (function (_1873, _1874, __kappa) { LINKS.remoteCall(__kappa)('1875', _env, {'1':_1873, '2':_1874}) }) }
function _1885(_env) { return  (function (_1884, __kappa) { LINKS.remoteCall(__kappa)('1885', _env, {'1':_1884}) }) }
function _1897(_env) { return  (function (_1895, _1896, __kappa) { LINKS.remoteCall(__kappa)('1897', _env, {'1':_1895, '2':_1896}) }) }
function _1902(_env) { return  (function (_1901, __kappa) { LINKS.remoteCall(__kappa)('1902', _env, {'1':_1901}) }) }
function _2618(_env) { return  (main) }
function _1967(_env) { return  (function (_1966, __kappa) { LINKS.remoteCall(__kappa)('1967', _env, {'1':_1966}) }) }
function _1960(_env) { return  (function (_1959, __kappa) { LINKS.remoteCall(__kappa)('1960', _env, {'1':_1959}) }) }
function _1973(_env) { return  (function (_1971, _1972, __kappa) { LINKS.remoteCall(__kappa)('1973', _env, {'1':_1971, '2':_1972}) }) }
function _1978(_env) { return  (function (_1976, _1977, __kappa) { LINKS.remoteCall(__kappa)('1978', _env, {'1':_1976, '2':_1977}) }) }
function _2024(_env) {
return  (function (_2021, _2022, _2023, __kappa) { LINKS.remoteCall(__kappa)('2024', _env, {'1':_2021, '2':_2022, '3':_2023}) })
}
function _2038(_env) { return  (function (_2036, _2037, __kappa) { LINKS.remoteCall(__kappa)('2038', _env, {'1':_2036, '2':_2037}) }) }
function _2284(_env) {
return 
  (function (_2280, _2281, _2282, _2283, __kappa) { LINKS.remoteCall(__kappa)('2284', _env, {'1':_2280, '2':_2281, '3':_2282, '4':_2283}) })
}
function _2070(_env) {
return 
  (function (_2066, _2067, _2068, _2069, __kappa) { LINKS.remoteCall(__kappa)('2070', _env, {'1':_2066, '2':_2067, '3':_2068, '4':_2069}) })
}
function _2082(_env) {
return 
  (function (_2078, _2079, _2080, _2081, __kappa) { LINKS.remoteCall(__kappa)('2082', _env, {'1':_2078, '2':_2079, '3':_2080, '4':_2081}) })
}
function _2117(_env) { return  (function (_2115, _2116, __kappa) { LINKS.remoteCall(__kappa)('2117', _env, {'1':_2115, '2':_2116}) }) }
function _2169(_env) { return  (function (_2167, _2168, __kappa) { LINKS.remoteCall(__kappa)('2169', _env, {'1':_2167, '2':_2168}) }) }
function _2271(_env) { return  (function (_2270, __kappa) { LINKS.remoteCall(__kappa)('2271', _env, {'1':_2270}) }) }
function _2261(_env) { return  (function (_2260, __kappa) { LINKS.remoteCall(__kappa)('2261', _env, {'1':_2260}) }) }
function _2229(_env) { return  (function (_2228, __kappa) { LINKS.remoteCall(__kappa)('2229', _env, {'1':_2228}) }) }
function _2215(_env) { return  (function (_2214, __kappa) { LINKS.remoteCall(__kappa)('2215', _env, {'1':_2214}) }) }
function _2213(_env) { return  (function (_2212, __kappa) { LINKS.remoteCall(__kappa)('2213', _env, {'1':_2212}) }) }
function _2291(_env) { return  (function (_2289, _2290, __kappa) { LINKS.remoteCall(__kappa)('2291', _env, {'1':_2289, '2':_2290}) }) }
function _2296(_env) { return  (function (_2294, _2295, __kappa) { LINKS.remoteCall(__kappa)('2296', _env, {'1':_2294, '2':_2295}) }) }
function _2303(_env) { return  (function (_2301, _2302, __kappa) { LINKS.remoteCall(__kappa)('2303', _env, {'1':_2301, '2':_2302}) }) }
function _2310(_env) {
return  (function (_2307, _2308, _2309, __kappa) { LINKS.remoteCall(__kappa)('2310', _env, {'1':_2307, '2':_2308, '3':_2309}) })
}
function _2317(_env) {
return  (function (_2314, _2315, _2316, __kappa) { LINKS.remoteCall(__kappa)('2317', _env, {'1':_2314, '2':_2315, '3':_2316}) })
}
function _2338(_env) { return  (function (_2337, __kappa) { LINKS.remoteCall(__kappa)('2338', _env, {'1':_2337}) }) }
function _2344(_env) { return  (function (_2342, _2343, __kappa) { LINKS.remoteCall(__kappa)('2344', _env, {'1':_2342, '2':_2343}) }) }
function _2349(_env) { return  (function (_2347, _2348, __kappa) { LINKS.remoteCall(__kappa)('2349', _env, {'1':_2347, '2':_2348}) }) }
function _2355(_env) { return  (function (_2353, _2354, __kappa) { LINKS.remoteCall(__kappa)('2355', _env, {'1':_2353, '2':_2354}) }) }
function _2362(_env) { return  (function (_2360, _2361, __kappa) { LINKS.remoteCall(__kappa)('2362', _env, {'1':_2360, '2':_2361}) }) }
function _2368(_env) { return  (function (_2366, _2367, __kappa) { LINKS.remoteCall(__kappa)('2368', _env, {'1':_2366, '2':_2367}) }) }
function _2386(_env) { return  (function (_2384, _2385, __kappa) { LINKS.remoteCall(__kappa)('2386', _env, {'1':_2384, '2':_2385}) }) }
function _2391(_env) { return  (function (_2389, _2390, __kappa) { LINKS.remoteCall(__kappa)('2391', _env, {'1':_2389, '2':_2390}) }) }
function _2408(_env) { return  (function (_2406, _2407, __kappa) { LINKS.remoteCall(__kappa)('2408', _env, {'1':_2406, '2':_2407}) }) }
function _2416(_env) { return  (function (_2415, __kappa) { LINKS.remoteCall(__kappa)('2416', _env, {'1':_2415}) }) }
function _2549(_env) { return  (function (_2547, _2548, __kappa) { LINKS.remoteCall(__kappa)('2549', _env, {'1':_2547, '2':_2548}) }) }
function _2422(_env) { return  (function (_2421, __kappa) { LINKS.remoteCall(__kappa)('2422', _env, {'1':_2421}) }) }
function _2425(_env) { return  (function (_2424, __kappa) { LINKS.remoteCall(__kappa)('2425', _env, {'1':_2424}) }) }
function _2428(_env) { return  (function (_2427, __kappa) { LINKS.remoteCall(__kappa)('2428', _env, {'1':_2427}) }) }
function _2433(_env) { return  (function (_2431, _2432, __kappa) { LINKS.remoteCall(__kappa)('2433', _env, {'1':_2431, '2':_2432}) }) }
function _2434(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('2434', _env, {}) }) }
function _2468(_env) { return  (function (_2467, __kappa) { LINKS.remoteCall(__kappa)('2468', _env, {'1':_2467}) }) }
function _2476(_env) { return  (function (_2475, __kappa) { LINKS.remoteCall(__kappa)('2476', _env, {'1':_2475}) }) }
function _2485(_env) { return  (function (_2484, __kappa) { LINKS.remoteCall(__kappa)('2485', _env, {'1':_2484}) }) }
function _2495(_env) { return  (function (_2494, __kappa) { LINKS.remoteCall(__kappa)('2495', _env, {'1':_2494}) }) }
function _2505(_env) { return  (function (_2504, __kappa) { LINKS.remoteCall(__kappa)('2505', _env, {'1':_2504}) }) }
function _2514(_env) { return  (function (_2513, __kappa) { LINKS.remoteCall(__kappa)('2514', _env, {'1':_2513}) }) }
function _2550(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('2550', _env, {}) }) }
function _2557(_env) {
return  (function (_2554, _2555, _2556, __kappa) { LINKS.remoteCall(__kappa)('2557', _env, {'1':_2554, '2':_2555, '3':_2556}) })
}
function _2559(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('2559', _env, {}) }) }
function _2570(_env) {
return 
  (function (_2565, _2566, _2567, _2568, _2569, __kappa) {
  LINKS.remoteCall(__kappa)('2570', _env, {'1':_2565, '2':_2566, '3':_2567, '4':_2568, '5':_2569})
  })
}
function _2576(_env) { return  (function (_2575, __kappa) { LINKS.remoteCall(__kappa)('2576', _env, {'1':_2575}) }) }
function _2593(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('2593', _env, {}) }) }
function _2598(_env) { return  (function (_2597, __kappa) { LINKS.remoteCall(__kappa)('2598', _env, {'1':_2597}) }) }
function _2602(_env) { return  (function (_2601, __kappa) { LINKS.remoteCall(__kappa)('2602', _env, {'1':_2601}) }) }
function _2610(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('2610', _env, {}) }) }
function _2611(_env) { return  (function (__kappa) { LINKS.remoteCall(__kappa)('2611', _env, {}) }) }
function _2616(_env) { return  (function (_2615, __kappa) { LINKS.remoteCall(__kappa)('2616', _env, {'1':_2615}) }) }
function selectElem(_217, _218, __kappa) { var i_215 = _218; var xs_216 = _217; __kappa(_hd(_drop(i_215, xs_216))) }
function compose(_226, _227, __kappa) {
var g_220 = _227;
  var f_221 = _226;
  function _fun__g16_225(_224, __kappa) {
  var x_222 = _224; _yield(function () { g_220(x_222, (function (_223) { _yield(function () { f_221(_223, __kappa) }) })) })
  }
  _yieldCont(__kappa, _fun__g16_225)
}
function replicate(_231, _232, __kappa) {
var item_229 = _232;
  var n_230 = _231;
  if ( LINKS.eq(n_230, 0) ) {
  _yieldCont(__kappa, Nil)
  } else { _yield(function () { replicate(n_230 - 1, item_229, (function (_234) { _yieldCont(__kappa, _Cons(item_229, _234)) })) }) }
}
function concatMap(_237, _238, __kappa) {
var l_235 = _238;
  var f_236 = _237;
  var _242 = l_235;
  if ( LINKS.eq(_242, Nil) ) {
  _yieldCont(__kappa, Nil)
  } else {
  (function (_243) {
    (function (_244) {
      var tl_241 = _244;
        var hd_240 = _243;
        _yield(function () { f_236(hd_240, (function (_246) {
        _yield(function () { concatMap(f_236, tl_241, (function (_245) { _yieldCont(__kappa, _Concat(_246, _245)) })) })
        })) })
      })(_tl(_242))
    })(_hd(_242))
  }
}
function filter(_253, _254, __kappa) {
var l_247 = _254;
  var p_248 = _253;
  function _fun__g17_252(_251, __kappa) {
  var x_249 = _251;
    _yield(function () { p_248(x_249, (function (_250) {
    if ( _250 ) { _yieldCont(__kappa, _Cons(x_249, Nil)) } else { _yieldCont(__kappa, Nil) }
    })) })
  }
  _yield(function () { concatMap(_fun__g17_252, l_247, __kappa) })
}
function sortBy(_258, _259, __kappa) {
var l_256 = _259;
  var f_257 = _258;
  var _263 = l_256;
  if ( LINKS.eq(_263, Nil) ) {
  _yieldCont(__kappa, Nil)
  } else {
  (function (_264) {
    (function (_265) {
      var xs_262 = _265;
        var x_261 = _264;
        function _fun__g18_270(_269, __kappa) {
        var y_266 = _269;
          _yield(function () { f_257(y_266, (function (_268) {
          _yield(function () { f_257(x_261, (function (_267) { _yieldCont(__kappa, _268 < _267) })) })
          })) })
        }
        _yield(function () { filter(_fun__g18_270, xs_262, (function (lt_271) {
        function _fun__g19_276(_275, __kappa) {
          var y_272 = _275;
            _yield(function () { f_257(y_272, (function (_274) {
            _yield(function () { f_257(x_261, (function (_273) { _yieldCont(__kappa, _274 >= _273) })) })
            })) })
          }
          _yield(function () { filter(_fun__g19_276, xs_262, (function (ge_277) {
          _yield(function () { sortBy(f_257, lt_271, (function (_279) {
            _yield(function () { sortBy(f_257, ge_277, (function (_278) {
              _yieldCont(__kappa, _Concat(_279, _Concat(_Cons(x_261, Nil), _278)))
              })) })
            })) })
          })) })
        })) })
      })(_tl(_263))
    })(_hd(_263))
  }
}
function sortByBase(_282, _283, __kappa) { var l_280 = _283; var f_281 = _282; _yield(function () { sortBy(f_281, l_280, __kappa) }) }
function map(_287, _288, __kappa) {
var l_285 = _288;
  var f_286 = _287;
  var _292 = l_285;
  if ( LINKS.eq(_292, Nil) ) {
  _yieldCont(__kappa, Nil)
  } else {
  (function (_293) {
    (function (_294) {
      var tl_291 = _294;
        var hd_290 = _293;
        _yield(function () { f_286(hd_290, (function (_296) {
        _yield(function () { map(f_286, tl_291, (function (_295) { _yieldCont(__kappa, _Cons(_296, _295)) })) })
        })) })
      })(_tl(_292))
    })(_hd(_292))
  }
}
function init(_298, __kappa) {
var list_297 = _298;
  var _303 = list_297;
  if ( LINKS.eq(_303, Nil) ) {
  error('Internal Error: Pattern matching failed', __kappa)
  } else {
  (function (_304) {
    (function (_305) {
      if ( LINKS.eq(_305, Nil) ) {
        var y_300 = _304; _yieldCont(__kappa, Nil)
        } else {
        var t_302 = _305; var h_301 = _304; _yield(function () { init(t_302, (function (_306) { _yieldCont(__kappa, _Cons(h_301, _306)) })) })
        }
      })(_tl(_303))
    })(_hd(_303))
  }
}
function id(_308, __kappa) { var x_307 = _308; _yieldCont(__kappa, x_307) }
function uncurry(_317, __kappa) {
var f_310 = _317;
  function _fun__g20_316(_314, _315, __kappa) {
  var y_311 = _315; var x_312 = _314; _yield(function () { f_310(x_312, (function (_313) { _yield(function () { _313(y_311, __kappa) }) })) })
  }
  _yieldCont(__kappa, _fun__g20_316)
}
function curry(_326, __kappa) {
var f_319 = _326;
  function _fun__g21_325(_324, __kappa) {
  var x_320 = _324;
    function _fun__g22_323(_322, __kappa) { var y_321 = _322; _yield(function () { f_319(x_320, y_321, __kappa) }) }
    _yieldCont(__kappa, _fun__g22_323)
  }
  _yieldCont(__kappa, _fun__g21_325)
}
function concat(_329, __kappa) {
var list_328 = _329;
  var _333 = list_328;
  if ( LINKS.eq(_333, Nil) ) {
  _yieldCont(__kappa, Nil)
  } else {
  (function (_334) {
    (function (_335) {
      var xs_332 = _335;
        var x_331 = _334;
        _yield(function () { concat(xs_332, (function (_336) { _yieldCont(__kappa, _Concat(x_331, _336)) })) })
      })(_tl(_333))
    })(_hd(_333))
  }
}
function dropWhile(_339, _340, __kappa) {
var list_337 = _340;
  var pred_338 = _339;
  var _344 = list_337;
  if ( LINKS.eq(_344, Nil) ) {
  _yieldCont(__kappa, Nil)
  } else {
  (function (_345) {
    (function (_346) {
      var t_343 = _346;
        var h_342 = _345;
        _yield(function () { pred_338(h_342, (function (_347) {
        var _348 = _347;
          if ( LINKS.eq(_348, true) ) {
          _yield(function () { dropWhile(pred_338, t_343, __kappa) })
          } else {
          if ( LINKS.eq(_348, false) ) { _yieldCont(__kappa, list_337) } else { error('Internal Error: Pattern matching failed', __kappa) }
          }
        })) })
      })(_tl(_344))
    })(_hd(_344))
  }
}
function even(_351, __kappa) { var i_349 = _351; _yieldCont(function (_350) { _yieldCont(__kappa, LINKS.eq(_350, 0)) }, i_349 % 2) }
function first(_354, __kappa) { var p_353 = _354; _yieldCont(__kappa, p_353['1']) }
function reverse(_367, __kappa) {
var l_356 = _367;
  function aux_361(_359, _360, __kappa) {
  var o_357 = _360;
    var l_358 = _359;
    var _364 = l_358;
    if ( LINKS.eq(_364, Nil) ) {
    _yieldCont(__kappa, o_357)
    } else {
    (function (_365) {
      (function (_366) {
        var xs_363 = _366; var x_362 = _365; _yield(function () { aux_361(xs_363, _Cons(x_362, o_357), __kappa) })
        })(_tl(_364))
      })(_hd(_364))
    }
  }
  _yield(function () { aux_361(l_356, Nil, __kappa) })
}
function sixth(_370, __kappa) { var p_369 = _370; _yieldCont(__kappa, p_369['6']) }
function flip(_378, __kappa) {
var f_372 = _378;
  function _fun__g23_377(_375, _376, __kappa) { var y_373 = _376; var x_374 = _375; _yield(function () { f_372(y_373, x_374, __kappa) }) }
  _yieldCont(__kappa, _fun__g23_377)
}
function third(_381, __kappa) { var p_380 = _381; _yieldCont(__kappa, p_380['3']) }
function and(_384, __kappa) {
var l_383 = _384;
  var _388 = l_383;
  if ( LINKS.eq(_388, Nil) ) {
  _yieldCont(__kappa, true)
  } else {
  (function (_389) {
    (function (_390) {
      var xs_387 = _390; var x_386 = _389; if ( x_386 ) { _yield(function () { and(xs_387, __kappa) }) } else { _yieldCont(__kappa, false) }
      })(_tl(_388))
    })(_hd(_388))
  }
}
function any(_393, _394, __kappa) {
var l_391 = _394;
  var p_392 = _393;
  var _398 = l_391;
  if ( LINKS.eq(_398, Nil) ) {
  _yieldCont(__kappa, false)
  } else {
  (function (_399) {
    (function (_400) {
      var xs_397 = _400;
        var x_396 = _399;
        _yield(function () { p_392(x_396, (function (_401) {
        if ( _401 ) { _yieldCont(__kappa, true) } else { _yield(function () { any(p_392, xs_397, __kappa) }) }
        })) })
      })(_tl(_398))
    })(_hd(_398))
  }
}
function second(_403, __kappa) { var p_402 = _403; _yieldCont(__kappa, p_402['2']) }
function fold_right(_408, _409, _410, __kappa) {
var l_405 = _410;
  var u_406 = _409;
  var f_407 = _408;
  var _414 = l_405;
  if ( LINKS.eq(_414, Nil) ) {
  _yieldCont(__kappa, u_406)
  } else {
  (function (_415) {
    (function (_416) {
      var xs_413 = _416;
        var x_412 = _415;
        _yield(function () { fold_right(f_407, u_406, xs_413, (function (_417) { _yield(function () { f_407(x_412, _417, __kappa) }) })) })
      })(_tl(_414))
    })(_hd(_414))
  }
}
function fold_right1(_422, _423, __kappa) {
var l_418 = _423;
  var f_419 = _422;
  (function (_420) { (function (_421) { _yield(function () { fold_right(f_419, _420, _421, __kappa) }) })(_tl(l_418)) })(_hd(l_418))
}
function substAt(_428, _429, _430, __kappa) {
var y_425 = _430;
  var i_426 = _429;
  var xs_427 = _428;
  var _434 = xs_427;
  if ( LINKS.eq(_434, Nil) ) {
  _yieldCont(__kappa, Nil)
  } else {
  (function (_435) {
    (function (_436) {
      var xs_433 = _436;
        var x_432 = _435;
        if ( i_426 <= 0 ) {
        _yieldCont(__kappa, _Cons(y_425, xs_433))
        } else { _yield(function () { substAt(xs_433, i_426 - 1, y_425, (function (_437) { _yieldCont(__kappa, _Cons(x_432, _437)) })) }) }
      })(_tl(_434))
    })(_hd(_434))
  }
}
function swap(_445, _446, _447, __kappa) {
var x2_438 = _447;
  var x1_439 = _446;
  var xs_440 = _445;
  function _fun__g24_444(_443, __kappa) {
  var _for__g1_441 = _443;
    var x_442 = _443;
    if ( LINKS.eq(x_442, x1_439) ) {
    _yieldCont(__kappa, _Cons(x2_438, Nil))
    } else { if ( LINKS.eq(x_442, x2_438) ) { _yieldCont(__kappa, _Cons(x1_439, Nil)) } else { _yieldCont(__kappa, _Cons(x_442, Nil)) } }
  }
  _yield(function () { concatMap(_fun__g24_444, xs_440, __kappa) })
}
function fold_left(_452, _453, _454, __kappa) {
var l_449 = _454;
  var u_450 = _453;
  var p_451 = _452;
  var _458 = l_449;
  if ( LINKS.eq(_458, Nil) ) {
  _yieldCont(__kappa, u_450)
  } else {
  (function (_459) {
    (function (_460) {
      var xs_457 = _460;
        var x_456 = _459;
        _yield(function () { p_451(u_450, x_456, (function (_461) { _yield(function () { fold_left(p_451, _461, xs_457, __kappa) }) })) })
      })(_tl(_458))
    })(_hd(_458))
  }
}
function _bang_bang(_464, _465, __kappa) { var n_462 = _465; var xs_463 = _464; _yield(function () { selectElem(xs_463, n_462, __kappa) }) }
function fourth(_468, __kappa) { var p_467 = _468; _yieldCont(__kappa, p_467['4']) }
function product(_471, __kappa) {
var ns_470 = _471; _yield(function () { fold_left(function (x, y, __kappa) { _yieldCont(__kappa, x * y) }, 1, ns_470, __kappa) })
}
function ninth(_474, __kappa) { var p_473 = _474; _yieldCont(__kappa, p_473['9']) }
function mapi(_490, _491, __kappa) {
var xs_476 = _491;
  var f_477 = _490;
  function mi_482(_480, _481, __kappa) {
  var xs_478 = _481;
    var i_479 = _480;
    var _485 = xs_478;
    if ( LINKS.eq(_485, Nil) ) {
    _yieldCont(__kappa, Nil)
    } else {
    (function (_486) {
      (function (_487) {
        var xs_484 = _487;
          var x_483 = _486;
          _yield(function () { f_477(x_483, i_479, (function (_489) {
          _yield(function () { mi_482(i_479 + 1, xs_484, (function (_488) { _yieldCont(__kappa, _Cons(_489, _488)) })) })
          })) })
        })(_tl(_485))
      })(_hd(_485))
    }
  }
  _yield(function () { mi_482(0, xs_476, __kappa) })
}
function or(_494, __kappa) {
var l_493 = _494;
  var _498 = l_493;
  if ( LINKS.eq(_498, Nil) ) {
  _yieldCont(__kappa, false)
  } else {
  (function (_499) {
    (function (_500) {
      var xs_497 = _500; var x_496 = _499; if ( x_496 ) { _yieldCont(__kappa, true) } else { _yield(function () { or(xs_497, __kappa) }) }
      })(_tl(_498))
    })(_hd(_498))
  }
}
function elem(_503, _504, __kappa) {
var l_501 = _504;
  var x_502 = _503;
  if ( _not(LINKS.eq(l_501, Nil)) ) {
  (function (_507) {
    if ( LINKS.eq(x_502, _507) ) {
      _yieldCont(__kappa, true)
      } else { (function (_506) { _yield(function () { elem(x_502, _506, __kappa) }) })(_tl(l_501)) }
    })(_hd(l_501))
  } else { _yieldCont(__kappa, false) }
}
function last(_509, __kappa) {
var list_508 = _509;
  var _514 = list_508;
  if ( LINKS.eq(_514, Nil) ) {
  error('Internal Error: Pattern matching failed', __kappa)
  } else {
  (function (_515) {
    (function (_516) {
      if ( LINKS.eq(_516, Nil) ) {
        var x_511 = _515; _yieldCont(__kappa, x_511)
        } else { var t_513 = _516; var h_512 = _515; _yield(function () { last(t_513, __kappa) }) }
      })(_tl(_514))
    })(_hd(_514))
  }
}
function assert(_520, _521, __kappa) {
var msg_517 = _521;
  var ok_518 = _520;
  var _kappa2622 = function (_519) { _yieldCont(__kappa, {}) };
  if ( _not(ok_518) ) { _kappa2622(_debug('assertion failed: ' + msg_517)) } else { _yieldCont(_kappa2622, {}) }
}
function abs(_524, __kappa) { var i_523 = _524; if ( i_523 < 0 ) { _yieldCont(__kappa, - i_523) } else { _yieldCont(__kappa, i_523) } }
function ignore(_526, __kappa) { _yieldCont(__kappa, {}) }
function curtail(_529, __kappa) { var list_528 = _529; _yield(function () { init(list_528, __kappa) }) }
function fold_left1(_535, _536, __kappa) {
var l_531 = _536;
  var p_532 = _535;
  (function (_533) { (function (_534) { _yield(function () { fold_left(p_532, _533, _534, __kappa) }) })(_tl(l_531)) })(_hd(l_531))
}
function zip(_540, _541, __kappa) {
var r_538 = _541;
  var l_539 = _540;
  var _547 = {'2':r_538, '1':l_539};
  var _549 = _547['1'];
  var _550 = _547['2'];
  if ( LINKS.eq(_549, Nil) ) {
  if ( LINKS.eq(_550, Nil) ) { _yieldCont(__kappa, Nil) } else { _yieldCont(__kappa, Nil) }
  } else {
  (function (_551) {
    (function (_552) {
      if ( LINKS.eq(_550, Nil) ) {
        _yieldCont(__kappa, Nil)
        } else {
        (function (_553) {
          (function (_554) {
            var rt_544 = _554;
              var rh_543 = _553;
              var lt_546 = _552;
              var lh_545 = _551;
              _yield(function () { zip(lt_546, rt_544, (function (_555) { _yieldCont(__kappa, _Cons({'2':rh_543, '1':lh_545}, _555)) })) })
            })(_tl(_550))
          })(_hd(_550))
        }
      })(_tl(_549))
    })(_hd(_549))
  }
}
function all(_558, _559, __kappa) {
var l_556 = _559;
  var p_557 = _558;
  var _563 = l_556;
  if ( LINKS.eq(_563, Nil) ) {
  _yieldCont(__kappa, true)
  } else {
  (function (_564) {
    (function (_565) {
      var xs_562 = _565;
        var x_561 = _564;
        _yield(function () { p_557(x_561, (function (_566) {
        if ( _566 ) { _yield(function () { all(p_557, xs_562, __kappa) }) } else { _yieldCont(__kappa, false) }
        })) })
      })(_tl(_563))
    })(_hd(_563))
  }
}
function the(_573, __kappa) {
var l_567 = _573;
  (function (x_568) {
  function _fun__g25_571(_570, __kappa) { var y_569 = _570; _yieldCont(__kappa, LINKS.eq(x_568, y_569)) }
    _yield(function () { all(_fun__g25_571, l_567, (function (_572) {
    if ( _572 ) { _yieldCont(__kappa, x_568) } else { __kappa(_error('list argument to \'the\' had varying values.')) }
    })) })
  })(_hd(l_567))
}
function sum(_576, __kappa) {
var ns_575 = _576; _yield(function () { fold_left(function (x, y, __kappa) { _yieldCont(__kappa, x + y) }, 0, ns_575, __kappa) })
}
function odd(_580, __kappa) { var i_578 = _580; _yieldCont(function (_579) { _yieldCont(__kappa, LINKS.eq(_579, 1)) }, i_578 % 2) }
function seventh(_583, __kappa) { var p_582 = _583; _yieldCont(__kappa, p_582['7']) }
function tenth(_586, __kappa) { var p_585 = _586; _yieldCont(__kappa, p_585['10']) }
function unzip(_589, __kappa) {
var l_588 = _589;
  var _594 = l_588;
  if ( LINKS.eq(_594, Nil) ) {
  _yieldCont(__kappa, {'2':Nil, '1':Nil})
  } else {
  (function (_595) {
    (function (_596) {
      var _598 = _595['1'];
        var _599 = _595['2'];
        var xs_593 = _596;
        var b_591 = _599;
        var a_592 = _598;
        _yield(function () { unzip(xs_593, (function (_602) {
        var d_600 = _602['2']; var c_601 = _602['1']; _yieldCont(__kappa, {'2':_Cons(b_591, d_600), '1':_Cons(a_592, c_601)})
        })) })
      })(_tl(_594))
    })(_hd(_594))
  }
}
function join(_605, _606, __kappa) {
var list_603 = _606;
  var glue_604 = _605;
  var _611 = list_603;
  if ( LINKS.eq(_611, Nil) ) {
  _yieldCont(__kappa, Nil)
  } else {
  (function (_612) {
    (function (_613) {
      if ( LINKS.eq(_613, Nil) ) {
        var x_608 = _612; _yieldCont(__kappa, x_608)
        } else {
        var xs_610 = _613;
          var x_609 = _612;
          _yield(function () { join(glue_604, xs_610, (function (_614) { _yieldCont(__kappa, _Concat(x_609, _Concat(glue_604, _614))) })) })
        }
      })(_tl(_611))
    })(_hd(_611))
  }
}
function fifth(_616, __kappa) { var p_615 = _616; _yieldCont(__kappa, p_615['5']) }
function eighth(_619, __kappa) { var p_618 = _619; _yieldCont(__kappa, p_618['8']) }
function intRange(_630, _631, __kappa) {
var n_621 = _631;
  var m_622 = _630;
  function intRangeAux_629(_626, _627, _628, __kappa) {
  var result_623 = _628;
    var n_624 = _627;
    var m_625 = _626;
    if ( m_625 > n_624 ) {
    _yieldCont(__kappa, result_623)
    } else { _yield(function () { intRangeAux_629(m_625, n_624 - 1, _Cons(n_624, result_623), __kappa) }) }
  }
  _yield(function () { intRangeAux_629(m_622, n_621, Nil, __kappa) })
}
function takeWhile(_635, _636, __kappa) {
var list_633 = _636;
  var pred_634 = _635;
  var _640 = list_633;
  if ( LINKS.eq(_640, Nil) ) {
  _yieldCont(__kappa, Nil)
  } else {
  (function (_641) {
    (function (_642) {
      var t_639 = _642;
        var h_638 = _641;
        _yield(function () { pred_634(h_638, (function (_643) {
        var _644 = _643;
          if ( LINKS.eq(_644, true) ) {
          _yield(function () { takeWhile(pred_634, t_639, (function (_645) { _yieldCont(__kappa, _Cons(h_638, _645)) })) })
          } else {
          if ( LINKS.eq(_644, false) ) { _yieldCont(__kappa, Nil) } else { error('Internal Error: Pattern matching failed', __kappa) }
          }
        })) })
      })(_tl(_640))
    })(_hd(_640))
  }
}
function empty(_648, __kappa) {
var l_646 = _648; var _647 = l_646; if ( LINKS.eq(_647, Nil) ) { _yieldCont(__kappa, true) } else { _yieldCont(__kappa, false) }
}
function fromMaybe(_656, _657, __kappa) {
var y_650 = _657;
  var x_651 = _656;
  var _653 = x_651;
  switch (_653._label) {case 'Just': {var _654 = _653._value; var x_652 = _654; _yieldCont(__kappa, x_652); break;}
   case 'Nothing': {var _655 = _653._value; _yieldCont(__kappa, y_650); break;}
  }
}
function isInt(_660, __kappa) {
var x_659 = _660;
  _yieldCont(__kappa, _tilde(x_659, {'_label':'Seq', '_value':_Cons({'_label':'Repeat', '_value':{'2':{'_label':'Simply', '_value':'-'}, '1':{'_label':'Question', '_value':{}}}}, _Cons({'_label':'Repeat', '_value':{'2':{'_label':'Range', '_value':{'2':{'_c':'9'}, '1':{'_c':'0'}}}, '1':{'_label':'Plus', '_value':{}}}}, _Cons({'_label':'EndAnchor', '_value':{}}, Nil)))}))
}
function isJust(_667, __kappa) {
var x_662 = _667;
  var _664 = x_662;
  switch (_664._label) {case 'Just': {var _665 = _664._value; var x_663 = _665; _yieldCont(__kappa, true); break;}
   case 'Nothing': {var _666 = _664._value; _yieldCont(__kappa, false); break;}
  }
}
function isFloat(_670, __kappa) {
var x_669 = _670;
  _yieldCont(__kappa, _tilde(x_669, {'_label':'Seq', '_value':_Cons({'_label':'Repeat', '_value':{'2':{'_label':'Simply', '_value':'-'}, '1':{'_label':'Question', '_value':{}}}}, _Cons({'_label':'Repeat', '_value':{'2':{'_label':'Range', '_value':{'2':{'_c':'9'}, '1':{'_c':'0'}}}, '1':{'_label':'Plus', '_value':{}}}}, _Cons({'_label':'Repeat', '_value':{'2':{'_label':'Group', '_value':{'_label':'Seq', '_value':_Cons({'_label':'Quote', '_value':{'_label':'Simply', '_value':'.'}}, _Cons({'_label':'Repeat', '_value':{'2':{'_label':'Range', '_value':{'2':{'_c':'9'}, '1':{'_c':'0'}}}, '1':{'_label':'Plus', '_value':{}}}}, Nil))}}, '1':{'_label':'Question', '_value':{}}}}, _Cons({'_label':'EndAnchor', '_value':{}}, Nil))))}))
}
function search(_674, _675, __kappa) {
var l_672 = _675;
  var p_673 = _674;
  var _679 = l_672;
  if ( LINKS.eq(_679, Nil) ) {
  _yieldCont(__kappa, {'_label':'Nothing', '_value':{}})
  } else {
  (function (_680) {
    (function (_681) {
      var xs_678 = _681;
        var x_677 = _680;
        _yield(function () { p_673(x_677, (function (_682) {
        if ( _682 ) { _yieldCont(__kappa, {'_label':'Just', '_value':x_677}) } else { _yield(function () { search(p_673, xs_678, __kappa) }) }
        })) })
      })(_tl(_679))
    })(_hd(_679))
  }
}
function assoc(_685, _686, __kappa) {
var l_683 = _686;
  var x_684 = _685;
  var _691 = l_683;
  if ( LINKS.eq(_691, Nil) ) {
  (function (_697) { _yieldCont(__kappa, _697) })(_error('Not found ' + x_684))
  } else {
  (function (_692) {
    (function (_693) {
      var _695 = _692['1'];
        var _696 = _692['2'];
        var xs_690 = _693;
        var v_688 = _696;
        var k_689 = _695;
        if ( LINKS.eq(k_689, x_684) ) { _yieldCont(__kappa, v_688) } else { _yield(function () { assoc(x_684, xs_690, __kappa) }) }
      })(_tl(_691))
    })(_hd(_691))
  }
}
function memassoc(_700, _701, __kappa) {
var l_698 = _701;
  var x_699 = _700;
  var _706 = l_698;
  if ( LINKS.eq(_706, Nil) ) {
  _yieldCont(__kappa, false)
  } else {
  (function (_707) {
    (function (_708) {
      var _710 = _707['1'];
        var _711 = _707['2'];
        var xs_705 = _708;
        var v_703 = _711;
        var k_704 = _710;
        if ( LINKS.eq(k_704, x_699) ) { _yieldCont(__kappa, true) } else { _yield(function () { memassoc(x_699, xs_705, __kappa) }) }
      })(_tl(_706))
    })(_hd(_706))
  }
}
function assocAll(_714, _715, __kappa) {
var l_712 = _715;
  var x_713 = _714;
  var _720 = l_712;
  if ( LINKS.eq(_720, Nil) ) {
  _yieldCont(__kappa, Nil)
  } else {
  (function (_721) {
    (function (_722) {
      var _724 = _721['1'];
        var _725 = _721['2'];
        var xs_719 = _722;
        var v_717 = _725;
        var k_718 = _724;
        if ( LINKS.eq(k_718, x_713) ) {
        _yield(function () { assocAll(x_713, xs_719, (function (_726) { _yieldCont(__kappa, _Cons(v_717, _726)) })) })
        } else { _yield(function () { assocAll(x_713, xs_719, __kappa) }) }
      })(_tl(_720))
    })(_hd(_720))
  }
}
function lookup(_729, _730, __kappa) {
var l_727 = _730;
  var x_728 = _729;
  var _735 = l_727;
  if ( LINKS.eq(_735, Nil) ) {
  _yieldCont(__kappa, {'_label':'Nothing', '_value':{}})
  } else {
  (function (_736) {
    (function (_737) {
      var _739 = _736['1'];
        var _740 = _736['2'];
        var xs_734 = _737;
        var b_732 = _740;
        var a_733 = _739;
        if ( LINKS.eq(a_733, x_728) ) {
        _yieldCont(__kappa, {'_label':'Just', '_value':b_732})
        } else { _yield(function () { lookup(x_728, xs_734, __kappa) }) }
      })(_tl(_735))
    })(_hd(_735))
  }
}
function find(_743, _744, __kappa) {
var l_741 = _744;
  var p_742 = _743;
  var _748 = l_741;
  if ( LINKS.eq(_748, Nil) ) {
  (function (_752) { _yieldCont(__kappa, _752) })(_error('Not_found'))
  } else {
  (function (_749) {
    (function (_750) {
      var xs_747 = _750;
        var x_746 = _749;
        _yield(function () { p_742(x_746, (function (_751) {
        if ( _751 ) { _yieldCont(__kappa, x_746) } else { _yield(function () { find(p_742, xs_747, __kappa) }) }
        })) })
      })(_tl(_748))
    })(_hd(_748))
  }
}
function removeAssoc(_755, _756, __kappa) {
var l_753 = _756;
  var x_754 = _755;
  var _761 = l_753;
  if ( LINKS.eq(_761, Nil) ) {
  _yieldCont(__kappa, Nil)
  } else {
  (function (_762) {
    (function (_763) {
      var _765 = _762['1'];
        var _766 = _762['2'];
        var xs_760 = _763;
        var v_758 = _766;
        var k_759 = _765;
        if ( LINKS.eq(k_759, x_754) ) {
        _yieldCont(__kappa, xs_760)
        } else {
        _yield(function () { removeAssoc(x_754, xs_760, (function (_767) { _yieldCont(__kappa, _Cons({'2':v_758, '1':k_759}, _767)) })) })
        }
      })(_tl(_761))
    })(_hd(_761))
  }
}
function fromJust(_773, __kappa) {
var x_768 = _773;
  var _770 = x_768;
  switch (_770._label) {case 'Just': {var _771 = _770._value; var x_769 = _771; _yieldCont(__kappa, x_769); break;}
   case 'Nothing': {var _772 = _770._value; __kappa(_error('fromJust failed')); break;}
  }
}
function asList(_781, __kappa) { LINKS.remoteCall(__kappa)('782', {}, {'1':_781}) }
var multipart = _Cons({'2':'multipart/form-data', '1':'enctype'}, Nil);
function runState(_786, _787, __kappa) { var i_784 = _787; var s_785 = _786; _yield(function () { s_785(i_784, __kappa) }) }
function _greaterthan_greaterthan_equals(_798, _799, __kappa) {
var f_789 = _799;
  var x_790 = _798;
  function _fun__g27_797(_796, __kappa) {
  var s1_791 = _796;
    _yield(function () { x_790(s1_791, (function (_794) {
    var s2_792 = _794['2'];
      var v_793 = _794['1'];
      _yield(function () { f_789(v_793, (function (_795) { _yield(function () { runState(_795, s2_792, __kappa) }) })) })
    })) })
  }
  _yieldCont(__kappa, _fun__g27_797)
}
function pureE(_802, __kappa) { var x_801 = _802; _yieldCont(__kappa, {'_label':'Just', '_value':x_801}) }
function _return(_808, __kappa) {
var a_804 = _808;
  function _fun__g28_807(_806, __kappa) { var s_805 = _806; _yieldCont(__kappa, {'2':s_805, '1':a_804}) }
  _yieldCont(__kappa, _fun__g28_807)
}
function xml(_815, __kappa) {
var x_810 = _815;
  function _fun__g29_814(_813, __kappa) {
  var e_811 = _813; _yield(function () { pureE({}, (function (_812) { _yieldCont(__kappa, {'2':_812, '1':x_810}) })) })
  }
  _yield(function () { _return({'2':_fun__g29_814, '1':x_810}, __kappa) })
}
function text(_818, __kappa) { var s_817 = _818; _yield(function () { xml(_stringToXml(s_817), __kappa) }) }
function plug(_834, _835, __kappa) {
var m_820 = _835;
  var f_821 = _834;
  function _fun__g31_833(_832, __kappa) {
  var collector_822 = _832['2'];
    var x_823 = _832['1'];
    _yield(function () { f_821(x_823, (function (_831) {
    function _fun__g30_830(_829, __kappa) {
      var env_824 = _829;
        _yield(function () { collector_822(env_824, (function (_827) {
        var c_825 = _827['2'];
          var xml_826 = _827['1'];
          _yield(function () { f_821(xml_826, (function (_828) { _yieldCont(__kappa, {'2':c_825, '1':_828}) })) })
        })) })
      }
      _yield(function () { _return({'2':_fun__g30_830, '1':_831}, __kappa) })
    })) })
  }
  _yield(function () { _greaterthan_greaterthan_equals(m_820, _fun__g31_833, __kappa) })
}
function applyE(_850, _851, __kappa) {
var x_837 = _851;
  var f_838 = _850;
  var _841 = {'2':x_837, '1':f_838};
  var _843 = _841['1'];
  var _844 = _841['2'];
  switch (_843._label) {case 'Just': {var _845 = _843._value; switch (_844._label) {case 'Just': {var _846 = _844._value; var x_839 = _846;
  var f_840 = _845;
  _yield(function () { f_840(x_839, (function (_847) { _yieldCont(__kappa, {'_label':'Just', '_value':_847}) })) }); break;}
   default: {var _848 = _844; _yieldCont(__kappa, {'_label':'Nothing', '_value':{}}); break;}
  }; break;}
   default: {var _849 = _843; _yieldCont(__kappa, {'_label':'Nothing', '_value':{}}); break;}
  }
}
function fmap(_856, _857, __kappa) {
var x_853 = _857;
  var f_854 = _856;
  _yield(function () { compose(_return, f_854, (function (_855) {
  _yield(function () { _greaterthan_greaterthan_equals(x_853, _855, __kappa) })
  })) })
}
function _monkey_monkey_monkey(_879, _880, __kappa) {
var k_859 = _880;
  var m_860 = _879;
  function _fun__g34_878(_877, __kappa) {
  var c_861 = _877['2'];
    var x_862 = _877['1'];
    function _fun__g33_876(_875, __kappa) {
    var f_863 = _875['2'];
      var y_864 = _875['1'];
      function _fun__g32_874(_873, __kappa) {
      var e_865 = _873;
        _yield(function () { f_863(e_865, (function (_868) {
        var f_866 = _868['2'];
          var fx_867 = _868['1'];
          _yield(function () { c_861(e_865, (function (_871) {
          var c_869 = _871['2'];
            var cx_870 = _871['1'];
            _yield(function () { applyE(f_866, c_869, (function (_872) { _yieldCont(__kappa, {'2':_872, '1':_Concat(cx_870, fx_867)}) })) })
          })) })
        })) })
      }
      _yield(function () { _return({'2':_fun__g32_874, '1':_Concat(x_862, y_864)}, __kappa) })
    }
    _yield(function () { _greaterthan_greaterthan_equals(k_859, _fun__g33_876, __kappa) })
  }
  _yield(function () { _greaterthan_greaterthan_equals(m_860, _fun__g34_878, __kappa) })
}
function pure(_885, __kappa) {
var v_882 = _885;
  function _fun__g35_884(_883, __kappa) { _yieldCont(__kappa, {'2':{'_label':'Just', '_value':v_882}, '1':Nil}) }
  _yield(function () { _return({'2':_fun__g35_884, '1':Nil}, __kappa) })
}
function _monkey_monkey_equals_greaterthan(_890, _891, __kappa) {
var f_887 = _891;
  var m_888 = _890;
  _yield(function () { pure(f_887, (function (_889) { _yield(function () { _monkey_monkey_monkey(m_888, _889, __kappa) }) })) })
}
function _dollar(_895, _896, __kappa) { var x_893 = _896; var f_894 = _895; _yield(function () { f_894(x_893, __kappa) }) }
function makeName(_899, __kappa) { var i_898 = _899; _yieldCont(__kappa, 'input_' + _intToString(i_898)) }
function _fun__g36_904(_903, __kappa) {
var i_901 = _903; _yield(function () { makeName(i_901, (function (_902) { _yieldCont(__kappa, {'2':i_901 + 1, '1':_902}) })) })
}
var nextName = _fun__g36_904;
function sequence(_907, __kappa) {
var xs_906 = _907;
  var _911 = xs_906;
  if ( LINKS.eq(_911, Nil) ) {
  _yield(function () { _return(Nil, (function (_921) { _yieldCont(__kappa, _921) })) })
  } else {
  (function (_912) {
    (function (_913) {
      var xs_910 = _913;
        var x_909 = _912;
        function _fun__g38_920(_919, __kappa) {
        var x_914 = _919;
          _yield(function () { sequence(xs_910, (function (_918) {
          function _fun__g37_917(_916, __kappa) { var xs_915 = _916; _yield(function () { _return(_Cons(x_914, xs_915), __kappa) }) }
            _yield(function () { _greaterthan_greaterthan_equals(_918, _fun__g37_917, __kappa) })
          })) })
        }
        _yield(function () { _greaterthan_greaterthan_equals(x_909, _fun__g38_920, __kappa) })
      })(_tl(_911))
    })(_hd(_911))
  }
}
function formlets(_923, __kappa) {
var fs_922 = _923;
  var _928 = fs_922;
  if ( LINKS.eq(_928, Nil) ) {
  _yield(function () { xml(Nil, (function (_961) {
    function _fun__g39_963(_962, __kappa) { _yieldCont(__kappa, Nil) }
      _yield(function () { pure(_fun__g39_963, (function (_964) { _yield(function () { _monkey_monkey_monkey(_961, _964, __kappa) }) })) })
    })) })
  } else {
  (function (_929) {
    (function (_930) {
      if ( LINKS.eq(_930, Nil) ) {
        var x_925 = _929;
          function _fun__g40_953(_952, __kappa) { var _formlet__g9_950 = _952; var f_951 = _952; _yieldCont(__kappa, _formlet__g9_950) }
          _yield(function () { pure(_fun__g40_953, (function (_954) {
          _yield(function () { _monkey_monkey_monkey(x_925, _954, (function (_955) {
            function _fun__g41_959(_958, __kappa) { var _formlet__g8_956 = _958; var f_957 = _958; _yieldCont(__kappa, _Cons(f_957, Nil)) }
              _yield(function () { pure(_fun__g41_959, (function (_960) {
              _yield(function () { _monkey_monkey_monkey(_955, _960, __kappa) })
              })) })
            })) })
          })) })
        } else {
        var xs_927 = _930;
          var x_926 = _929;
          _yield(function () { formlets(xs_927, (function (_931) {
          function _fun__g42_939(_938, __kappa) {
            var _formlet__g13_932 = _938;
              var fs_933 = _938;
              function _fun__g43_937(_936, __kappa) {
              var _formlet__g12_934 = _936; var f_935 = _936; _yieldCont(__kappa, {'2':_formlet__g13_932, '1':_formlet__g12_934})
              }
              _yieldCont(__kappa, _fun__g43_937)
            }
            _yield(function () { pure(_fun__g42_939, (function (_940) {
            _yield(function () { _monkey_monkey_monkey(_931, _940, (function (_941) {
              _yield(function () { _monkey_monkey_monkey(x_926, _941, (function (_942) {
                function _fun__g44_948(_947, __kappa) {
                  var _formlet__g11_943 = _947['2'];
                    var fs_944 = _947['2'];
                    var _formlet__g10_945 = _947['1'];
                    var f_946 = _947['1'];
                    _yieldCont(__kappa, _Cons(f_946, fs_944))
                  }
                  _yield(function () { pure(_fun__g44_948, (function (_949) {
                  _yield(function () { _monkey_monkey_monkey(_942, _949, __kappa) })
                  })) })
                })) })
              })) })
            })) })
          })) })
        }
      })(_tl(_928))
    })(_hd(_928))
  }
}
function _fun__g45_969(_968, __kappa) {
if ( LINKS.eq(_968, Nil) ) { _yieldCont(__kappa, Nil) } else { error('Internal Error: Pattern matching failed', __kappa) }
}
function _fun__g46_967(_966, __kappa) { var gen_965 = _966; _yieldCont(__kappa, {'2':gen_965, '1':Nil}) }
var unitP = {'3':_fun__g46_967, '2':_fun__g45_969, '1':0};
function bodyP(_977, __kappa) {
var xml_971 = _977;
  function _fun__g47_976(_975, __kappa) {
  if ( LINKS.eq(_975, Nil) ) { _yieldCont(__kappa, xml_971) } else { error('Internal Error: Pattern matching failed', __kappa) }
  }
  function _fun__g48_974(_973, __kappa) { var gen_972 = _973; _yieldCont(__kappa, {'2':gen_972, '1':Nil}) }
  _yieldCont(__kappa, {'3':_fun__g48_974, '2':_fun__g47_976, '1':0})
}
function pickleCont(_981, __kappa) {
var cont_979 = _981;
  function _fun__g49_980(__kappa) { _yield(function () { cont_979(__kappa) }) }
  _yield(function () { unsafePickleCont(_fun__g49_980, __kappa) })
}
function mkForm(_989, _990, _991, __kappa) {
var attributes_983 = _991;
  var contents_984 = _990;
  var cont_985 = _989;
  function _fun__g50_987(__kappa) { (function (_986) { _yield(function () { cont_985(_986, __kappa) }) })(_environment()) }
  (function (_988) {
  _yieldCont(__kappa, _addAttributes(LINKS.XML('form', {'method':'POST', 'enctype':'application/x-www-form-urlencoded', 'action':'#'}, [_stringToXml('\n    '), LINKS.XML('input', {'value':_988, 'type':'hidden', 'name':'_k'}, []), _stringToXml('\n    '), contents_984, _stringToXml('\n  ')]), attributes_983))
  })(_Concat('BAHbBwDbBw==&_jsonArgs=', stringifyB64({'985':cont_985})))
}
function validate(_999, _1000, _1001, _1002, _1003, _1004, __kappa) {
var attributes_993 = _1004;
  var i_994 = _1003;
  var zs_995 = _1002;
  var k_996 = _1001;
  var h_997 = _1000;
  var c_998 = _999;
  function _fun__g52_1025(_1024, __kappa) {
  var env_1006 = _1024;
    _yield(function () { c_998(env_1006, (function (_1009) {
    var v_1007 = _1009['2'];
      var xml_1008 = _1009['1'];
      var _1011 = v_1007;
      switch (_1011._label) {case 'Just': {var _1012 = _1011._value; var v_1010 = _1012; _yield(function () { h_997(v_1010, __kappa) }); break;}
       case 'Nothing': {var _1013 = _1011._value; function z_1017(_1016, __kappa) {
      var zs_1014 = _1016;
        _yield(function () { validate(c_998, h_997, k_996, zs_1014, i_994, attributes_993, (function (_1015) {
        _yield(function () { mkForm(_1015, xml_1008, attributes_993, __kappa) })
        })) })
      }
      _yield(function () { substAt(zs_995, i_994, z_1017, (function (zs_1018) {
      function _fun__g51_1021(_1020, __kappa) { var z_1019 = _1020; _yield(function () { z_1019(zs_1018, __kappa) }) }
        _yield(function () { map(_fun__g51_1021, zs_1018, (function (_1022) {
        _yield(function () { k_996(_1022, (function (_1023) { _yield(function () { bodyP(_1023, __kappa) }) })) })
        })) })
      })) }); break;}
      }
    })) })
  }
  _yieldCont(__kappa, _fun__g52_1025)
}
function joinP(_1046, _1047, __kappa) {
var fs2_1026 = _1047['3'];
  var k2_1027 = _1047['2'];
  var i2_1028 = _1047['1'];
  var fs1_1029 = _1046['3'];
  var k1_1030 = _1046['2'];
  var i1_1031 = _1046['1'];
  function _fun__g53_1045(_1044, __kappa) {
  var xs_1041 = _1044;
    _yield(function () { k1_1030(_take(i1_1031, xs_1041), (function (_1042) {
    _yield(function () { k2_1027(_drop(i1_1031, xs_1041), (function (_1043) { _yieldCont(__kappa, _Concat(_1042, _1043)) })) })
    })) })
  }
  function _fun__g54_1040(_1039, __kappa) {
  var gen_1032 = _1039;
    _yield(function () { fs1_1029(gen_1032, (function (_1035) {
    var gen_1033 = _1035['2'];
      var ms1_1034 = _1035['1'];
      _yield(function () { fs2_1026(gen_1033, (function (_1038) {
      var gen_1036 = _1038['2']; var ms2_1037 = _1038['1']; _yieldCont(__kappa, {'2':gen_1036, '1':_Concat(ms1_1034, ms2_1037)})
      })) })
    })) })
  }
  _yieldCont(__kappa, {'3':_fun__g54_1040, '2':_fun__g53_1045, '1':i1_1031 + i2_1028})
}
function joinManyP(_1050, __kappa) { var gs_1049 = _1050; _yield(function () { fold_left(joinP, unitP, gs_1049, __kappa) }) }
function renderPagePure(_1070, __kappa) {
var fs_1052 = _1070['3'];
  var k_1053 = _1070['2'];
  var n_1054 = _1070['1'];
  _yield(function () { fs_1052(0, (function (_1056) {
  var ms_1055 = _1056['1'];
    function _fun__g55_1064(_1062, _1063, __kappa) {
    var i_1057 = _1063;
      var m_1058 = _1062;
      function _fun__g56_1061(_1060, __kappa) { var zs_1059 = _1060; _yield(function () { m_1058(k_1053, zs_1059, i_1057, __kappa) }) }
      _yieldCont(__kappa, _fun__g56_1061)
    }
    _yield(function () { mapi(_fun__g55_1064, ms_1055, (function (zs_1065) {
    function _fun__g57_1068(_1067, __kappa) { var z_1066 = _1067; _yield(function () { z_1066(zs_1065, __kappa) }) }
      _yield(function () { map(_fun__g57_1068, zs_1065, (function (_1069) { _yield(function () { k_1053(_1069, __kappa) }) })) })
    })) })
  })) })
}
function plugP(_1080, _1081, __kappa) {
var fs_1072 = _1081['3'];
  var k_1073 = _1081['2'];
  var i_1074 = _1081['1'];
  var context_1075 = _1080;
  function _fun__g58_1079(_1078, __kappa) {
  var xs_1076 = _1078; _yield(function () { k_1073(xs_1076, (function (_1077) { _yield(function () { context_1075(_1077, __kappa) }) })) })
  }
  _yieldCont(__kappa, {'3':fs_1072, '2':_fun__g58_1079, '1':i_1074})
}
function renderPage(_1084, __kappa) { var p_1083 = _1084; _yield(function () { renderPagePure(p_1083, __kappa) }) }
function mkCheckedFormBuilder(_1098, _1099, _1100, _1101, __kappa) {
var attributes_1086 = _1101;
  var h_1087 = _1100;
  var c_1088 = _1099;
  var x_1089 = _1098;
  function _fun__g59_1097(_1094, _1095, _1096, __kappa) {
  var i_1090 = _1096;
    var zs_1091 = _1095;
    var k_1092 = _1094;
    _yield(function () { validate(c_1088, h_1087, k_1092, zs_1091, i_1090, attributes_1086, (function (_1093) {
    _yield(function () { mkForm(_1093, x_1089, attributes_1086, __kappa) })
    })) })
  }
  _yieldCont(__kappa, _fun__g59_1097)
}
function formP(_1119, _1120, _1121, __kappa) {
var attributes_1103 = _1121;
  var h_1104 = _1120;
  var f_1105 = _1119;
  function _fun__g60_1118(_1115, __kappa) {
  (function (_1116) {
    (function (_1117) {
      var x_1114 = _1116;
        if ( LINKS.eq(_1117, Nil) ) { _yieldCont(__kappa, x_1114) } else { error('Internal Error: Pattern matching failed', __kappa) }
      })(_tl(_1115))
    })(_hd(_1115))
  }
  function _fun__g61_1113(_1112, __kappa) {
  var gen_1106 = _1112;
    _yield(function () { runState(f_1105, gen_1106, (function (_1110) {
    var gen_1107 = _1110['2'];
      var c_1108 = _1110['1']['2'];
      var x_1109 = _1110['1']['1'];
      _yield(function () { mkCheckedFormBuilder(x_1109, c_1108, h_1104, attributes_1103, (function (_1111) {
      _yieldCont(__kappa, {'2':gen_1107, '1':_Cons(_1111, Nil)})
      })) })
    })) })
  }
  _yieldCont(__kappa, {'3':_fun__g61_1113, '2':_fun__g60_1118, '1':1})
}
function mkInput(_1135, _1136, __kappa) {
var mkFilledXml_1123 = _1136;
  var mkXml_1124 = _1135;
  function _fun__g63_1134(_1133, __kappa) {
  var name_1125 = _1133;
    _yield(function () { mkXml_1124(name_1125, (function (_1132) {
    function _fun__g62_1131(_1130, __kappa) {
      var env_1126 = _1130;
        _yield(function () { assoc(name_1125, env_1126, (function (v_1127) {
        _yield(function () { mkFilledXml_1123(name_1125, v_1127, (function (_1129) {
          _yield(function () { pureE(v_1127, (function (_1128) { _yieldCont(__kappa, {'2':_1128, '1':_1129}) })) })
          })) })
        })) })
      }
      _yield(function () { _return({'2':_fun__g62_1131, '1':_1132}, __kappa) })
    })) })
  }
  _yield(function () { _greaterthan_greaterthan_equals(nextName, _fun__g63_1134, __kappa) })
}
function _fun__g66_1149(_1148, __kappa) {
var gen_1138 = _1148;
  function _fun__g64_1141(_1140, __kappa) { var name_1139 = _1140; _yieldCont(__kappa, LINKS.XML('input', {'name':name_1139}, [])) }
  function _fun__g65_1146(_1144, _1145, __kappa) {
  var v_1142 = _1145; var name_1143 = _1144; _yieldCont(__kappa, LINKS.XML('input', {'value':v_1142, 'name':name_1143}, []))
  }
  _yield(function () { mkInput(_fun__g64_1141, _fun__g65_1146, (function (_1147) { _yield(function () { _1147(gen_1138, __kappa) }) })) })
}
var input = _fun__g66_1149;
function inputA(_1163, __kappa) {
var attributes_1151 = _1163;
  function _fun__g67_1155(_1154, __kappa) {
  var name_1152 = _1154;
    _yield(function () { removeAssoc('name', attributes_1151, (function (_1153) {
    _yieldCont(__kappa, _addAttributes(LINKS.XML('input', {'name':name_1152}, []), _1153))
    })) })
  }
  function _fun__g68_1162(_1160, _1161, __kappa) {
  var v_1156 = _1161;
    var name_1157 = _1160;
    _yield(function () { removeAssoc('value', attributes_1151, (function (_1158) {
    _yield(function () { removeAssoc('name', _1158, (function (_1159) {
      _yieldCont(__kappa, _addAttributes(LINKS.XML('input', {'value':v_1156, 'name':name_1157}, []), _1159))
      })) })
    })) })
  }
  _yield(function () { mkInput(_fun__g67_1155, _fun__g68_1162, __kappa) })
}
function inputFileA(_1167, __kappa) {
var attributes_1165 = _1167;
  _yield(function () { removeAssoc('type', attributes_1165, (function (_1166) {
  _yield(function () { inputA(_Cons({'2':'file', '1':'type'}, _1166), __kappa) })
  })) })
}
function inputValueA(_1172, _1173, __kappa) {
var attributes_1169 = _1173;
  var v_1170 = _1172;
  _yield(function () { removeAssoc('value', attributes_1169, (function (_1171) {
  _yield(function () { inputA(_Cons({'2':v_1170, '1':'value'}, _1171), __kappa) })
  })) })
}
function inputPasswordA(_1177, __kappa) {
var attributes_1175 = _1177;
  _yield(function () { removeAssoc('type', attributes_1175, (function (_1176) {
  _yield(function () { inputA(_Cons({'2':'password', '1':'type'}, _1176), __kappa) })
  })) })
}
function _fun__g69_1182(_1181, __kappa) {
var gen_1179 = _1181; _yield(function () { inputPasswordA(Nil, (function (_1180) { _yield(function () { _1180(gen_1179, __kappa) }) })) })
}
var inputPassword = _fun__g69_1182;
function inputValue(_1185, __kappa) { var v_1184 = _1185; _yield(function () { inputValueA(v_1184, Nil, __kappa) }) }
function _fun__g70_1190(_1189, __kappa) {
var gen_1187 = _1189; _yield(function () { inputFileA(Nil, (function (_1188) { _yield(function () { _1188(gen_1187, __kappa) }) })) })
}
var inputFile = _fun__g70_1190;
function submit(_1193, __kappa) {
var text_1192 = _1193; _yieldCont(__kappa, LINKS.XML('button', {'type':'submit'}, [_stringToXml(text_1192)]))
}
function checkboxDefault(_1211, __kappa) {
var checked_1195 = _1211;
  function _fun__g73_1210(_1209, __kappa) {
  var gen_1196 = _1209;
    function _fun__g72_1207(_1206, __kappa) {
    var name_1197 = _1206;
      var xml_1198 = LINKS.XML('input', {'value':'yes', 'type':'checkbox', 'name':name_1197}, []);
      var _kappa2624 = function (_1205) {
      function _fun__g71_1204(_1203, __kappa) {
        var env_1199 = _1203;
          _yield(function () { memassoc(name_1197, env_1199, (function (checked_1200) {
          var _kappa2623 = function (_1202) {
            _yield(function () { pureE(checked_1200, (function (_1201) {
              _yieldCont(__kappa, {'2':_1201, '1':_addAttributes(xml_1198, _1202)})
              })) })
            };
            if ( checked_1200 ) { _yieldCont(_kappa2623, _Cons({'2':'Y', '1':'checked'}, Nil)) } else { _yieldCont(_kappa2623, Nil) }
          })) })
        }
        _yield(function () { _return({'2':_fun__g71_1204, '1':_addAttributes(xml_1198, _1205)}, __kappa) })
      };
      if ( checked_1195 ) { _yieldCont(_kappa2624, _Cons({'2':'Y', '1':'checked'}, Nil)) } else { _yieldCont(_kappa2624, Nil) }
    }
    _yield(function () { _greaterthan_greaterthan_equals(nextName, _fun__g72_1207, (function (_1208) {
    _yield(function () { _1208(gen_1196, __kappa) })
    })) })
  }
  _yieldCont(__kappa, _fun__g73_1210)
}
function button(_1229, _1230, __kappa) {
var behaviour_1213 = _1230;
  var text_1214 = _1229;
  function _fun__g75_1228(_1227, __kappa) {
  var name_1215 = _1227;
    var _1216 = behaviour_1213;
    var _kappa2625 = function (behaviour_1220) {
    var xml_1221 = LINKS.XML('button', {'value':'here', 'type':behaviour_1220, 'name':name_1215}, [_stringToXml(text_1214)]);
      function _fun__g74_1226(_1225, __kappa) {
      var env_1222 = _1225;
        _yield(function () { memassoc(name_1215, env_1222, (function (_1223) {
        _yield(function () { pureE(_1223, (function (_1224) { _yieldCont(__kappa, {'2':_1224, '1':xml_1221}) })) })
        })) })
      }
      _yield(function () { _return({'2':_fun__g74_1226, '1':xml_1221}, __kappa) })
    };
    switch (_1216._label) {case 'Button': {var _1217 = _1216._value; _yieldCont(_kappa2625, 'button'); break;}
     case 'Reset': {var _1218 = _1216._value; _yieldCont(_kappa2625, 'reset'); break;}
     case 'Submit': {var _1219 = _1216._value; _yieldCont(_kappa2625, 'submit'); break;}
    }
  }
  _yield(function () { _greaterthan_greaterthan_equals(nextName, _fun__g75_1228, __kappa) })
}
function pushButton(_1233, __kappa) {
var text_1232 = _1233; _yield(function () { button(text_1232, {'_label':'Button', '_value':{}}, __kappa) })
}
function textarea(_1244, __kappa) {
var value_1235 = _1244;
  function _fun__g76_1238(_1237, __kappa) {
  var name_1236 = _1237; _yieldCont(__kappa, LINKS.XML('textarea', {'name':name_1236}, [_stringToXml(value_1235)]))
  }
  function _fun__g77_1243(_1241, _1242, __kappa) {
  var value_1239 = _1242; var name_1240 = _1241; _yieldCont(__kappa, LINKS.XML('textarea', {'name':name_1240}, [_stringToXml(value_1239)]))
  }
  _yield(function () { mkInput(_fun__g76_1238, _fun__g77_1243, __kappa) })
}
function resetButton(_1247, __kappa) {
var text_1246 = _1247; _yield(function () { button(text_1246, {'_label':'Reset', '_value':{}}, __kappa) })
}
function submitButton(_1250, __kappa) {
var text_1249 = _1250; _yield(function () { button(text_1249, {'_label':'Submit', '_value':{}}, __kappa) })
}
function _fun__g78_1255(_1254, __kappa) {
var gen_1252 = _1254; _yield(function () { checkboxDefault(false, (function (_1253) { _yield(function () { _1253(gen_1252, __kappa) }) })) })
}
var checkbox = _fun__g78_1255;
function preludeOptionKeyed(_1275, _1276, _1277, __kappa) {
var selected_1257 = _1277;
  var text_1258 = _1276['2'];
  var data_1259 = _1276['1'];
  var key_1260 = _1275;
  if ( selected_1257 ) {
  function _fun__g79_1274(_1273, __kappa) {
    var k_1268 = _1273;
      function _fun__g80_1272(_1271, __kappa) {
      var aKey_1269 = _1271;
        if ( LINKS.eq(aKey_1269, key_1260) ) {
        _yield(function () { k_1268(aKey_1269, (function (_1270) { _yieldCont(__kappa, _Cons(data_1259, _1270)) })) })
        } else { _yield(function () { k_1268(aKey_1269, __kappa) }) }
      }
      _yieldCont(__kappa, _fun__g80_1272)
    }
    _yieldCont(__kappa, {'2':_fun__g79_1274, '1':LINKS.XML('option', {'value':key_1260, 'selected':'SELECTED'}, [_stringToXml(text_1258)])})
  } else {
  function _fun__g81_1267(_1266, __kappa) {
    var k_1261 = _1266;
      function _fun__g82_1265(_1264, __kappa) {
      var aKey_1262 = _1264;
        if ( LINKS.eq(aKey_1262, key_1260) ) {
        _yield(function () { k_1261(aKey_1262, (function (_1263) { _yieldCont(__kappa, _Cons(data_1259, _1263)) })) })
        } else { _yield(function () { k_1261(aKey_1262, __kappa) }) }
      }
      _yieldCont(__kappa, _fun__g82_1265)
    }
    _yieldCont(__kappa, {'2':_fun__g81_1267, '1':LINKS.XML('option', {'value':key_1260}, [_stringToXml(text_1258)])})
  }
}
function preludeOptionsKeyed(_1281, _1282, __kappa) {
var def_1279 = _1282;
  var items_1280 = _1281;
  var _1287 = items_1280;
  if ( LINKS.eq(_1287, Nil) ) {
  function _fun__g83_1302(_1301, __kappa) { _yieldCont(__kappa, Nil) } _yieldCont(__kappa, {'2':_fun__g83_1302, '1':Nil})
  } else {
  (function (_1288) {
    (function (_1289) {
      var _1291 = _1288['1'];
        var _1292 = _1288['2'];
        var items_1286 = _1289;
        var item_1284 = _1292;
        var itemKey_1285 = _1291;
        _yield(function () { first(item_1284, (function (_1295) {
        _yield(function () { preludeOptionKeyed(itemKey_1285, item_1284, LINKS.eq(_1295, def_1279), (function (_1296) {
          var r1_1293 = _1296['2'];
            var xml_1294 = _1296['1'];
            _yield(function () { preludeOptionsKeyed(items_1286, def_1279, (function (_1299) {
            var r2_1297 = _1299['2'];
              var morexml_1298 = _1299['1'];
              _yield(function () { r1_1293(r2_1297, (function (_1300) {
              _yieldCont(__kappa, {'2':_1300, '1':_Concat(xml_1294, morexml_1298)})
              })) })
            })) })
          })) })
        })) })
      })(_tl(_1287))
    })(_hd(_1287))
  }
}
function choiceDefault(_1332, _1333, __kappa) {
var selected_1303 = _1333;
  var items_1304 = _1332;
  function _fun__g87_1331(_1330, __kappa) {
  var fieldName_1305 = _1330;
    function _fun__g84_1327(_1326, __kappa) { var _for__g3_1324 = _1326; var x_1325 = _1326; _yieldCont(__kappa, _Cons(nextName, Nil)) }
    _yield(function () { concatMap(_fun__g84_1327, items_1304, (function (_1328) {
    _yield(function () { sequence(_1328, (function (_1329) {
      function _fun__g86_1323(_1322, __kappa) {
        var optKeys_1306 = _1322;
          _yield(function () { zip(optKeys_1306, items_1304, (function (keyedItems_1307) {
          _yield(function () { preludeOptionsKeyed(keyedItems_1307, selected_1303, (function (_1321) {
            var optsXml_1320 = _1321['1'];
              function _fun__g85_1319(_1318, __kappa) {
              var env_1308 = _1318;
                _yield(function () { assoc(fieldName_1305, env_1308, (function (selectedKey_1309) {
                _yield(function () { assoc(selectedKey_1309, keyedItems_1307, (function (_1311) {
                  var selected_1310 = _1311['1'];
                    _yield(function () { preludeOptionsKeyed(keyedItems_1307, selected_1310, (function (_1314) {
                    var retrieve_1312 = _1314['2'];
                      var optsXml_1313 = _1314['1'];
                      _yield(function () { retrieve_1312(selectedKey_1309, (function (_1315) {
                      (function (_1316) {
                        _yield(function () { pureE(_1316, (function (_1317) {
                          _yieldCont(__kappa, {'2':_1317, '1':LINKS.XML('select', {'name':fieldName_1305}, [optsXml_1313])})
                          })) })
                        })(_hd(_1315))
                      })) })
                    })) })
                  })) })
                })) })
              }
              _yield(function () { _return({'2':_fun__g85_1319, '1':LINKS.XML('select', {'name':fieldName_1305}, [optsXml_1320])}, __kappa) })
            })) })
          })) })
        }
        _yield(function () { _greaterthan_greaterthan_equals(_1329, _fun__g86_1323, __kappa) })
      })) })
    })) })
  }
  _yield(function () { _greaterthan_greaterthan_equals(nextName, _fun__g87_1331, __kappa) })
}
function inputRadiogroup(_1370, _1371, _1372, __kappa) {
var layout_1335 = _1372;
  var selected_1336 = _1371;
  var items_1337 = _1370;
  function _fun__g92_1369(_1368, __kappa) {
  var name_1338 = _1368;
    function _fun__g88_1365(_1364, __kappa) { var _for__g4_1362 = _1364; var x_1363 = _1364; _yieldCont(__kappa, _Cons(nextName, Nil)) }
    _yield(function () { concatMap(_fun__g88_1365, items_1337, (function (_1366) {
    _yield(function () { sequence(_1366, (function (_1367) {
      function _fun__g91_1361(_1360, __kappa) {
        var keys_1339 = _1360;
          _yield(function () { zip(keys_1339, items_1337, (function (keyedItems_1340) {
          function itemXml_1349(_1348, __kappa) {
            var selected_1341 = _1348;
              function _fun__g89_1347(_1346, __kappa) {
              var _for__g5_1342 = _1346;
                var data_1343 = _1346['2'];
                var key_1344 = _1346['1'];
                var _kappa2626 = function (_1345) {
                _yieldCont(__kappa, _Cons({'2':data_1343, '1':_addAttributes(LINKS.XML('input', {'value':key_1344, 'type':'radio', 'name':name_1338}, []), _1345)}, Nil))
                };
                if ( LINKS.eq(data_1343, selected_1341) ) {
                _yieldCont(_kappa2626, _Cons({'2':'on', '1':'checked'}, Nil))
                } else { _yieldCont(_kappa2626, Nil) }
              }
              _yield(function () { concatMap(_fun__g89_1347, keyedItems_1340, __kappa) })
            }
            _yield(function () { itemXml_1349(selected_1336, (function (_1350) {
            _yield(function () { layout_1335(_1350, (function (xml_1351) {
              function _fun__g90_1359(_1358, __kappa) {
                var env_1352 = _1358;
                  _yield(function () { assoc(name_1338, env_1352, (function (selectedValue_1353) {
                  _yield(function () { assoc(selectedValue_1353, keyedItems_1340, (function (selectedData_1354) {
                    _yield(function () { itemXml_1349(selectedData_1354, (function (_1355) {
                      _yield(function () { layout_1335(_1355, (function (xml_1356) {
                        _yield(function () { pureE(selectedData_1354, (function (_1357) { _yieldCont(__kappa, {'2':_1357, '1':xml_1356}) })) })
                        })) })
                      })) })
                    })) })
                  })) })
                }
                _yield(function () { _return({'2':_fun__g90_1359, '1':xml_1351}, __kappa) })
              })) })
            })) })
          })) })
        }
        _yield(function () { _greaterthan_greaterthan_equals(_1367, _fun__g91_1361, __kappa) })
      })) })
    })) })
  }
  _yield(function () { _greaterthan_greaterthan_equals(nextName, _fun__g92_1369, __kappa) })
}
function preludeMultiOptionsKeyed(_1375, __kappa) {
var items_1374 = _1375;
  var _1380 = items_1374;
  if ( LINKS.eq(_1380, Nil) ) {
  function _fun__g93_1397(_1396, __kappa) { _yieldCont(__kappa, Nil) } _yieldCont(__kappa, {'2':_fun__g93_1397, '1':Nil})
  } else {
  (function (_1381) {
    (function (_1382) {
      var _1384 = _1381['1'];
        var _1385 = _1381['2'];
        var items_1379 = _1382;
        var item_1377 = _1385;
        var itemKey_1378 = _1384;
        _yield(function () { first(item_1377, (function (_1389) {
        _yield(function () { second(item_1377, (function (_1388) {
          _yield(function () { third(item_1377, (function (_1390) {
            _yield(function () { preludeOptionKeyed(itemKey_1378, {'2':_1388, '1':_1389}, _1390, (function (_1391) {
              var r1_1386 = _1391['2'];
                var xml_1387 = _1391['1'];
                _yield(function () { preludeMultiOptionsKeyed(items_1379, (function (_1394) {
                var r2_1392 = _1394['2'];
                  var morexml_1393 = _1394['1'];
                  _yield(function () { r1_1386(r2_1392, (function (_1395) {
                  _yieldCont(__kappa, {'2':_1395, '1':_Concat(xml_1387, morexml_1393)})
                  })) })
                })) })
              })) })
            })) })
          })) })
        })) })
      })(_tl(_1380))
    })(_hd(_1380))
  }
}
function choices(_1433, __kappa) {
var items_1398 = _1433;
  function _fun__g98_1432(_1431, __kappa) {
  var fieldName_1399 = _1431;
    function _fun__g94_1428(_1427, __kappa) { var _for__g6_1425 = _1427; var x_1426 = _1427; _yieldCont(__kappa, _Cons(nextName, Nil)) }
    _yield(function () { concatMap(_fun__g94_1428, items_1398, (function (_1429) {
    _yield(function () { sequence(_1429, (function (_1430) {
      function _fun__g97_1424(_1423, __kappa) {
        var optKeys_1400 = _1423;
          _yield(function () { zip(optKeys_1400, items_1398, (function (keyedItems_1401) {
          _yield(function () { preludeMultiOptionsKeyed(keyedItems_1401, (function (_1422) {
            var retrieve_1420 = _1422['2'];
              var xml_1421 = _1422['1'];
              function _fun__g96_1419(_1418, __kappa) {
              var env_1402 = _1418;
                _yield(function () { assocAll(fieldName_1399, env_1402, (function (selectedKeys_1403) {
                function _fun__g95_1411(_1410, __kappa) {
                  var _for__g7_1404 = _1410;
                    var sel_1405 = _1410['2']['3'];
                    var text_1406 = _1410['2']['2'];
                    var data_1407 = _1410['2']['1'];
                    var key_1408 = _1410['1'];
                    _yield(function () { elem(key_1408, selectedKeys_1403, (function (_1409) {
                    _yieldCont(__kappa, _Cons({'2':{'3':_1409, '2':text_1406, '1':data_1407}, '1':key_1408}, Nil))
                    })) })
                  }
                  _yield(function () { concatMap(_fun__g95_1411, keyedItems_1401, (function (keyedItems_1412) {
                  _yield(function () { preludeMultiOptionsKeyed(keyedItems_1412, (function (_1415) {
                    var retrieve_1413 = _1415['2'];
                      var xml_1414 = _1415['1'];
                      _yield(function () { concatMap(retrieve_1413, selectedKeys_1403, (function (_1416) {
                      _yield(function () { pureE(_1416, (function (_1417) {
                        _yieldCont(__kappa, {'2':_1417, '1':LINKS.XML('select', {'name':fieldName_1399, 'multiple':'multiple'}, [xml_1414])})
                        })) })
                      })) })
                    })) })
                  })) })
                })) })
              }
              _yield(function () { _return({'2':_fun__g96_1419, '1':LINKS.XML('select', {'name':fieldName_1399, 'multiple':'multiple'}, [xml_1421])}, __kappa) })
            })) })
          })) })
        }
        _yield(function () { _greaterthan_greaterthan_equals(_1430, _fun__g97_1424, __kappa) })
      })) })
    })) })
  }
  _yield(function () { _greaterthan_greaterthan_equals(nextName, _fun__g98_1432, __kappa) })
}
function choicesNone(_1441, __kappa) {
var items_1435 = _1441;
  function _fun__g99_1439(_1438, __kappa) {
  var text_1436 = _1438['2']; var v_1437 = _1438['1']; _yieldCont(__kappa, {'3':false, '2':text_1436, '1':v_1437})
  }
  _yield(function () { map(_fun__g99_1439, items_1435, (function (_1440) { _yield(function () { choices(_1440, __kappa) }) })) })
}
function choice(_1446, __kappa) {
var items_1443 = _1446;
  (function (_1445) {
  var selected_1444 = _1445['1']; _yield(function () { choiceDefault(items_1443, selected_1444, __kappa) })
  })(_hd(items_1443))
}
function errorMsg(_1457, _1458, __kappa) {
var msg_1448 = _1458;
  var f_1449 = _1457;
  function _fun__g100_1456(_1454, _1455, __kappa) {
  var xml_1450 = _1455;
    var x_1451 = _1454;
    _yield(function () { f_1449(x_1451, (function (_1453) {
    if ( _1453 ) {
      _yieldCont(__kappa, {'_label':'Left', '_value':xml_1450})
      } else {
      _yield(function () { msg_1448(x_1451, (function (_1452) {
        _yieldCont(__kappa, {'_label':'Right', '_value':_Concat(LINKS.XML('span', {'class':'errorinput'}, [xml_1450, _stringToXml(' ')]), LINKS.XML('span', {'class':'error'}, [_stringToXml(' '), _stringToXml(_1452)]))})
        })) })
      }
    })) })
  }
  _yieldCont(__kappa, _fun__g100_1456)
}
function satisfies(_1482, _1483, __kappa) {
var validate_1460 = _1483;
  var f_1461 = _1482;
  function _fun__g102_1481(_1480, __kappa) {
  var collector_1462 = _1480['2'];
    var xml_1463 = _1480['1'];
    function _fun__g101_1479(_1478, __kappa) {
    var env_1464 = _1478;
      _yield(function () { collector_1462(env_1464, (function (_1467) {
      var val_1465 = _1467['2'];
        var cxml_1466 = _1467['1'];
        var _1469 = val_1465;
        switch (_1469._label) {case 'Just': {var _1470 = _1469._value; var v_1468 = _1470;
        _yield(function () { validate_1460(v_1468, cxml_1466, (function (_1473) {
        var _1474 = _1473;
          switch (_1474._label) {case 'Left': {var _1475 = _1474._value; var xml_1472 = _1475;
          _yieldCont(__kappa, {'2':{'_label':'Just', '_value':v_1468}, '1':xml_1472}); break;}
           case 'Right': {var _1476 = _1474._value; var xml_1471 = _1476;
          _yieldCont(__kappa, {'2':{'_label':'Nothing', '_value':{}}, '1':xml_1471}); break;}
          }
        })) }); break;}
         case 'Nothing': {var _1477 = _1469._value; _yieldCont(__kappa, {'2':{'_label':'Nothing', '_value':{}}, '1':cxml_1466}); break;}
        }
      })) })
    }
    _yield(function () { _return({'2':_fun__g101_1479, '1':xml_1463}, __kappa) })
  }
  _yield(function () { _greaterthan_greaterthan_equals(f_1461, _fun__g102_1481, __kappa) })
}
function transform(_1502, _1503, _1504, _1505, __kappa) {
var g_1485 = _1505;
  var error_1486 = _1504;
  var predicate_1487 = _1503;
  var f_1488 = _1502;
  _yield(function () { errorMsg(predicate_1487, error_1486, (function (_1489) {
  _yield(function () { satisfies(f_1488, _1489, (function (_1490) {
    function _fun__g103_1494(_1493, __kappa) { var _formlet__g15_1491 = _1493; var v_1492 = _1493; _yieldCont(__kappa, _formlet__g15_1491) }
      _yield(function () { pure(_fun__g103_1494, (function (_1495) {
      _yield(function () { _monkey_monkey_monkey(_1490, _1495, (function (_1496) {
        function _fun__g104_1500(_1499, __kappa) {
          var _formlet__g14_1497 = _1499; var v_1498 = _1499; _yield(function () { g_1485(v_1498, __kappa) })
          }
          _yield(function () { pure(_fun__g104_1500, (function (_1501) {
          _yield(function () { _monkey_monkey_monkey(_1496, _1501, __kappa) })
          })) })
        })) })
      })) })
    })) })
  })) })
}
function _fun__g106_1513(_1512, __kappa) {
var gen_1507 = _1512;
  function _fun__g105_1510(_1509, __kappa) { var s_1508 = _1509; _yieldCont(__kappa, s_1508 + ' is not an integer') }
  _yield(function () { transform(input, isInt, _fun__g105_1510, stringToInt, (function (_1511) {
  _yield(function () { _1511(gen_1507, __kappa) })
  })) })
}
var inputInt = _fun__g106_1513;
function inputIntValue(_1520, __kappa) {
var v_1515 = _1520;
  _yield(function () { inputA(_Cons({'2':_intToString(v_1515), '1':'value'}, Nil), (function (_1516) {
  function _fun__g107_1519(_1518, __kappa) { var s_1517 = _1518; _yieldCont(__kappa, s_1517 + 'is not an integer') }
    _yield(function () { transform(_1516, isInt, _fun__g107_1519, stringToInt, __kappa) })
  })) })
}
function inputIntA(_1527, __kappa) {
var attributes_1522 = _1527;
  _yield(function () { inputA(attributes_1522, (function (_1523) {
  function _fun__g108_1526(_1525, __kappa) { var s_1524 = _1525; _yieldCont(__kappa, s_1524 + ' is not an integer') }
    _yield(function () { transform(_1523, isInt, _fun__g108_1526, stringToInt, __kappa) })
  })) })
}
function _fun__g110_1535(_1534, __kappa) {
var gen_1529 = _1534;
  function _fun__g109_1532(_1531, __kappa) { var s_1530 = _1531; _yieldCont(__kappa, s_1530 + ' is not a float') }
  _yield(function () { transform(input, isFloat, _fun__g109_1532, stringToFloat, (function (_1533) {
  _yield(function () { _1533(gen_1529, __kappa) })
  })) })
}
var inputFloat = _fun__g110_1535;
function sendSuspend(_1542, __kappa) {
var pagef_1537 = _1542;
  function _1541(returnf_1538, __kappa) {
  _yield(function () { pagef_1537(returnf_1538, (function (_1539) {
    _yield(function () { renderPage(_1539, (function (_1540) { __kappa(_exit(_1540)) })) })
    })) })
  }
  _yield(function () { _1541(__kappa, __kappa) })
}
function freshResource(__kappa) {
function _1547(esc_1544, __kappa) {
  (function (_1545) { (function (_1546) { __kappa(_exit(0)) })(_redirect('?_cont=' + _1545)) })(_reifyK(esc_1544))
  }
  _yield(function () { _1547(__kappa, __kappa) })
}
function wait(_1551, __kappa) {
var s_1549 = _1551; _yield(function () { receive(s_1549, (function (_1550) { _yield(function () { ignore(_1550, __kappa) }) })) })
}
function makeEndBang(__kappa) {
(function (ap_1553) {
  function _fun__g111_1555(__kappa) {
    _yield(function () { accept(ap_1553, (function (c_1554) { _yield(function () { wait(c_1554, __kappa) }) })) })
    }
    (function (_1556) { _yield(function () { request(ap_1553, __kappa) }) })(_spawn(_fun__g111_1555))
  })(_new())
}
function linknife(_1565, __kappa) {
var f_1558 = _1565;
  (function (_1559) {
  var ap_1560 = _1559;
    function _fun__g112_1563(__kappa) {
    _yield(function () { accept(ap_1560, (function (c_1561) {
      _yield(function () { f_1558(c_1561, (function (_1562) { _yieldCont(__kappa, {}) })) })
      })) })
    }
    (function (_1564) { _yield(function () { request(ap_1560, __kappa) }) })(_spawn(_fun__g112_1563))
  })(_new())
}
function close(_1569, __kappa) { var s_1567 = _1569; (function (_1568) { _yield(function () { ignore(_1568, __kappa) }) })(_send({}, s_1567)) }
function fork(_1579, __kappa) {
var f_1571 = _1579;
  (function (_1572) {
  var ap_1573 = _1572;
    function _fun__g113_1577(__kappa) {
    _yield(function () { accept(ap_1573, (function (c_1574) {
      _yield(function () { f_1571(c_1574, (function (c_1575) {
        _yield(function () { close(c_1575, (function (_1576) { _yieldCont(__kappa, {}) })) })
        })) })
      })) })
    }
    (function (_1578) { _yield(function () { request(ap_1573, __kappa) }) })(_spawn(_fun__g113_1577))
  })(_new())
}
function knife(_1588, __kappa) {
var f_1581 = _1588;
  (function (_1582) {
  var ap_1583 = _1582;
    function _fun__g114_1586(__kappa) {
    _yield(function () { accept(ap_1583, (function (c_1584) {
      _yield(function () { f_1581(c_1584, (function (_1585) { _yieldCont(__kappa, {}) })) })
      })) })
    }
    (function (_1587) { _yield(function () { request(ap_1583, __kappa) }) })(_spawn(_fun__g114_1586))
  })(_new())
}
function reproduce(_1592, _1593, __kappa) {
var f_1590 = _1593;
  var ap_1591 = _1592;
  _yield(function () { accept(ap_1591, (function (x_1595) {
  function _fun__g115_1596(__kappa) { _yield(function () { f_1590(x_1595, __kappa) }) }
    (function (_1597) { _yield(function () { reproduce(ap_1591, f_1590, __kappa) }) })(_spawn(_fun__g115_1596))
  })) })
}
function linfork(_1606, __kappa) {
var f_1598 = _1606;
  (function (_1599) {
  var ap_1600 = _1599;
    function _fun__g116_1604(__kappa) {
    _yield(function () { accept(ap_1600, (function (c_1601) {
      _yield(function () { f_1598(c_1601, (function (c_1602) {
        _yield(function () { close(c_1602, (function (_1603) { _yieldCont(__kappa, {}) })) })
        })) })
      })) })
    }
    (function (_1605) { _yield(function () { request(ap_1600, __kappa) }) })(_spawn(_fun__g116_1604))
  })(_new())
}
function run(_1614, __kappa) {
var f_1608 = _1614;
  _yield(function () { fork(f_1608, (function (c_1609) {
  _yield(function () { receive(c_1609, (function (_1612) {
    var c_1610 = _1612['2']; var v_1611 = _1612['1']; _yield(function () { wait(c_1610, (function (_1613) { _yieldCont(__kappa, v_1611) })) })
    })) })
  })) })
}
function fuse(_1619, _1620, __kappa) {
var c_1616 = _1620; var s_1617 = _1619; (function (_1618) { _yield(function () { close(_1618, __kappa) }) })(_link(s_1617, c_1616))
}
function lsMap(_1624, _1625, __kappa) {
var l_1622 = _1625;
  var f_1623 = _1624;
  if ( _lsEmpty(l_1622) ) {
  _yieldCont(__kappa, _lsNilF())
  } else {
  _yield(function () { f_1623(_lsHead(l_1622), (function (_1627) {
    _yield(function () { lsMap(f_1623, _lsTail(l_1622), (function (_1628) { _yieldCont(__kappa, _lsCons(_1627, _1628)) })) })
    })) })
  }
}
function fabs(_1630, __kappa) { var x_1629 = _1630; if ( x_1629 < 0 ) { _yieldCont(__kappa, - x_1629) } else { _yieldCont(__kappa, x_1629) } }
function fmin(_1634, _1635, __kappa) {
var b_1632 = _1635; var a_1633 = _1634; if ( a_1633 < b_1632 ) { _yieldCont(__kappa, a_1633) } else { _yieldCont(__kappa, b_1632) }
}
function fmax(_1639, _1640, __kappa) {
var b_1637 = _1640; var a_1638 = _1639; if ( a_1638 > b_1637 ) { _yieldCont(__kappa, a_1638) } else { _yieldCont(__kappa, b_1637) }
}
function lsMapIgnore(_1644, _1645, __kappa) {
var l_1642 = _1645;
  var f_1643 = _1644;
  if ( _lsEmpty(l_1642) ) {
  _yieldCont(__kappa, {})
  } else {
  _yield(function () { f_1643(_lsHead(l_1642), (function (_1647) { _yield(function () { lsMapIgnore(f_1643, _lsTail(l_1642), __kappa) }) })) })
  }
}
function lsCatMaybes(_1649, __kappa) {
var l_1648 = _1649;
  if ( _lsEmpty(l_1648) ) {
  _yieldCont(__kappa, _lsNilF())
  } else {
  var _1652 = _lsHead(l_1648);
    switch (_1652._label) {case 'Just': {var _1653 = _1652._value; var x_1651 = _1653;
    _yield(function () { lsCatMaybes(_lsTail(l_1648), (function (_1654) { _yieldCont(__kappa, _lsCons(x_1651, _1654)) })) }); break;}
     case 'Nothing': {var _1655 = _1652._value; _yield(function () { lsCatMaybes(_lsTail(l_1648), __kappa) }); break;}
    }
  }
}
function lsFilter(_1658, _1659, __kappa) {
var l_1656 = _1659;
  var p_1657 = _1658;
  if ( _lsEmpty(l_1656) ) {
  _yieldCont(__kappa, _lsNilF())
  } else {
  _yield(function () { p_1657(_lsHead(l_1656), (function (_1662) {
    if ( _1662 ) {
      _yield(function () { lsFilter(p_1657, _lsTail(l_1656), (function (_1661) { _yieldCont(__kappa, _lsCons(_lsHead(l_1656), _1661)) })) })
      } else { _yield(function () { lsFilter(p_1657, _lsTail(l_1656), __kappa) }) }
    })) })
  }
}
function lsFoldLeft(_1666, _1667, _1668, __kappa) {
var l_1663 = _1668;
  var i_1664 = _1667;
  var f_1665 = _1666;
  if ( _lsEmpty(l_1663) ) {
  _yieldCont(__kappa, i_1664)
  } else {
  _yield(function () { f_1665(i_1664, _lsHead(l_1663), (function (_1670) {
    _yield(function () { lsFoldLeft(f_1665, _1670, _lsTail(l_1663), __kappa) })
    })) })
  }
}
function vectorSub(_1675, _1676, __kappa) {
var v2y_1671 = _1676['2'];
  var v2x_1672 = _1676['1'];
  var v1y_1673 = _1675['2'];
  var v1x_1674 = _1675['1'];
  _yieldCont(__kappa, {'2':v1y_1673 - v2y_1671, '1':v1x_1674 - v2x_1672})
}
function minimum(_1691, __kappa) {
var l_1678 = _1691;
  function minimumHelper_1683(_1681, _1682, __kappa) {
  var currentMinimum_1679 = _1682;
    var l_1680 = _1681;
    var _1686 = l_1680;
    if ( LINKS.eq(_1686, Nil) ) {
    _yieldCont(__kappa, currentMinimum_1679)
    } else {
    (function (_1687) {
      (function (_1688) {
        var xs_1685 = _1688;
          var x_1684 = _1687;
          if ( x_1684 < currentMinimum_1679 ) {
          _yield(function () { minimumHelper_1683(xs_1685, x_1684, __kappa) })
          } else { _yield(function () { minimumHelper_1683(xs_1685, currentMinimum_1679, __kappa) }) }
        })(_tl(_1686))
      })(_hd(_1686))
    }
  }
  (function (_1689) { (function (_1690) { _yield(function () { minimumHelper_1683(_1689, _1690, __kappa) }) })(_hd(l_1678)) })(_tl(l_1678))
}
function vectorAddI(_1697, _1698, __kappa) {
var v2y_1693 = _1698['2'];
  var v2x_1694 = _1698['1'];
  var v1y_1695 = _1697['2'];
  var v1x_1696 = _1697['1'];
  _yieldCont(__kappa, {'2':v1y_1695 + v2y_1693, '1':v1x_1696 + v2x_1694})
}
function isNull(_1702, __kappa) {
var l_1700 = _1702; var _1701 = l_1700; if ( LINKS.eq(_1701, Nil) ) { _yieldCont(__kappa, true) } else { _yieldCont(__kappa, false) }
}
function maybe(_1711, _1712, _1713, __kappa) {
var m_1704 = _1713;
  var f_1705 = _1712;
  var n_1706 = _1711;
  var _1708 = m_1704;
  switch (_1708._label) {case 'Just': {var _1709 = _1708._value; var x_1707 = _1709; _yield(function () { f_1705(x_1707, __kappa) }); break;}
   case 'Nothing': {var _1710 = _1708._value; _yieldCont(__kappa, n_1706); break;}
  }
}
function vectorMulS(_1718, _1719, __kappa) {
var s_1715 = _1719; var v1y_1716 = _1718['2']; var v1x_1717 = _1718['1']; _yieldCont(__kappa, {'2':v1y_1716 * s_1715, '1':v1x_1717 * s_1715})
}
function isNothing(_1725, __kappa) {
var x_1721 = _1725;
  var _1722 = x_1721;
  switch (_1722._label) {case 'Nothing': {var _1723 = _1722._value; _yieldCont(__kappa, true); break;}
   default: {var _1724 = _1722; _yieldCont(__kappa, false); break;}
  }
}
function catMaybes(_1736, __kappa) {
var ls_1727 = _1736;
  function _fun__g118_1735(_1734, __kappa) {
  var _for__g117_1728 = _1734;
    var x_1729 = _1734;
    var _1731 = x_1729;
    switch (_1731._label) {case 'Just': {var _1732 = _1731._value; var x_1730 = _1732; _yieldCont(__kappa, _Cons(x_1730, Nil)); break;}
     case 'Nothing': {var _1733 = _1731._value; _yieldCont(__kappa, Nil); break;}
    }
  }
  _yield(function () { concatMap(_fun__g118_1735, ls_1727, __kappa) })
}
function vectorAdd(_1742, _1743, __kappa) {
var v2y_1738 = _1743['2'];
  var v2x_1739 = _1743['1'];
  var v1y_1740 = _1742['2'];
  var v1x_1741 = _1742['1'];
  _yieldCont(__kappa, {'2':v1y_1740 + v2y_1738, '1':v1x_1741 + v2x_1739})
}
function replica(_1747, _1748, __kappa) {
var item_1745 = _1748;
  var n_1746 = _1747;
  if ( LINKS.eq(n_1746, 0) ) {
  _yieldCont(__kappa, Nil)
  } else { _yield(function () { replica(n_1746 - 1, item_1745, (function (_1750) { _yieldCont(__kappa, _Cons(item_1745, _1750)) })) }) }
}
function intMapDelete(_1765, _1766, __kappa) {
var im_1751 = _1766;
  var i_1752 = _1765;
  function h_1759(_1756, _1757, _1758, __kappa) {
  var t_1753 = _1758;
    var im2_1754 = _1757;
    var i_1755 = _1756;
    var _1762 = im2_1754;
    if ( LINKS.eq(_1762, Nil) ) {
    _yieldCont(__kappa, im_1751)
    } else {
    (function (_1763) {
      (function (_1764) {
        var xs_1761 = _1764;
          var x_1760 = _1763;
          if ( LINKS.eq(x_1760['1'], i_1755) ) {
          _yieldCont(__kappa, _Concat(t_1753, xs_1761))
          } else { _yield(function () { h_1759(i_1755, xs_1761, _Concat(t_1753, _Cons(x_1760, Nil)), __kappa) }) }
        })(_tl(_1762))
      })(_hd(_1762))
    }
  }
  _yield(function () { h_1759(i_1752, im_1751, Nil, __kappa) })
}
function intMapUpdateWithKey(_1790, _1791, _1792, __kappa) {
var im_1768 = _1792;
  var i_1769 = _1791;
  var f_1770 = _1790;
  function h_1779(_1775, _1776, _1777, _1778, __kappa) {
  var t_1771 = _1778;
    var im2_1772 = _1777;
    var i_1773 = _1776;
    var f_1774 = _1775;
    var _1782 = im2_1772;
    if ( LINKS.eq(_1782, Nil) ) {
    _yieldCont(__kappa, im_1768)
    } else {
    (function (_1783) {
      (function (_1784) {
        var xs_1781 = _1784;
          var x_1780 = _1783;
          if ( LINKS.eq(i_1773, x_1780['1']) ) {
          _yield(function () { f_1774(x_1780['1'], x_1780['2'], (function (newValue_1785) {
            var _1787 = newValue_1785;
              switch (_1787._label) {case 'Just': {var _1788 = _1787._value; var y_1786 = _1788;
              _yieldCont(__kappa, _Concat(t_1771, _Concat(_Cons({'2':y_1786, '1':i_1773}, Nil), xs_1781))); break;}
               case 'Nothing': {var _1789 = _1787._value; _yield(function () { intMapDelete(i_1773, im_1768, __kappa) }); break;}
              }
            })) })
          } else { _yield(function () { h_1779(f_1774, i_1773, xs_1781, _Concat(t_1771, _Cons(x_1780, Nil)), __kappa) }) }
        })(_tl(_1782))
      })(_hd(_1782))
    }
  }
  _yield(function () { h_1779(f_1770, i_1769, im_1768, Nil, __kappa) })
}
function intMapAdjustWithKey(_1803, _1804, _1805, __kappa) {
var im_1794 = _1805;
  var i_1795 = _1804;
  var f_1796 = _1803;
  function _fun__g119_1802(_1800, _1801, __kappa) {
  var x_1797 = _1801;
    var k_1798 = _1800;
    _yield(function () { f_1796(k_1798, x_1797, (function (_1799) { _yieldCont(__kappa, {'_label':'Just', '_value':_1799}) })) })
  }
  _yield(function () { intMapUpdateWithKey(_fun__g119_1802, i_1795, im_1794, __kappa) })
}
function intMapLookup(_1809, _1810, __kappa) {
var im_1807 = _1810;
  var i_1808 = _1809;
  var _1814 = im_1807;
  if ( LINKS.eq(_1814, Nil) ) {
  _yieldCont(__kappa, {'_label':'Nothing', '_value':{}})
  } else {
  (function (_1815) {
    (function (_1816) {
      var xs_1813 = _1816;
        var x_1812 = _1815;
        if ( LINKS.eq(x_1812['1'], i_1808) ) {
        _yieldCont(__kappa, {'_label':'Just', '_value':x_1812['2']})
        } else { _yield(function () { intMapLookup(i_1808, xs_1813, __kappa) }) }
      })(_tl(_1814))
    })(_hd(_1814))
  }
}
function intMapUpdate(_1824, _1825, _1826, __kappa) {
var im_1817 = _1826;
  var i_1818 = _1825;
  var f_1819 = _1824;
  function _fun__g120_1823(_1821, _1822, __kappa) { var x_1820 = _1822; _yield(function () { f_1819(x_1820, __kappa) }) }
  _yield(function () { intMapUpdateWithKey(_fun__g120_1823, i_1818, im_1817, __kappa) })
}
function intMapInsert(_1845, _1846, _1847, __kappa) {
var im_1828 = _1847;
  var v_1829 = _1846;
  var i_1830 = _1845;
  function h_1839(_1835, _1836, _1837, _1838, __kappa) {
  var t_1831 = _1838;
    var im2_1832 = _1837;
    var v_1833 = _1836;
    var i_1834 = _1835;
    var _1842 = im2_1832;
    if ( LINKS.eq(_1842, Nil) ) {
    _yieldCont(__kappa, _Cons({'2':v_1833, '1':i_1834}, im_1828))
    } else {
    (function (_1843) {
      (function (_1844) {
        var xs_1841 = _1844;
          var x_1840 = _1843;
          if ( LINKS.eq(i_1834, x_1840['1']) ) {
          _yieldCont(__kappa, _Concat(t_1831, _Concat(_Cons({'2':v_1833, '1':i_1834}, Nil), xs_1841)))
          } else { _yield(function () { h_1839(i_1834, v_1833, xs_1841, _Concat(t_1831, _Cons(x_1840, Nil)), __kappa) }) }
        })(_tl(_1842))
      })(_hd(_1842))
    }
  }
  _yield(function () { h_1839(i_1830, v_1829, im_1828, Nil, __kappa) })
}
function clear(_1852, __kappa) {
var ctx_1849 = _1852;
  (function (_1850) {
  (function (_1851) { __kappa(_jsClearRect(ctx_1849, 0, 0, _1850, _1851)) })(_jsCanvasHeight(ctx_1849))
  })(_jsCanvasWidth(ctx_1849))
}
function intMapAdjust(_1861, _1862, _1863, __kappa) {
var im_1854 = _1863;
  var i_1855 = _1862;
  var f_1856 = _1861;
  function _fun__g121_1860(_1858, _1859, __kappa) { var x_1857 = _1859; _yield(function () { f_1856(x_1857, __kappa) }) }
  _yield(function () { intMapAdjustWithKey(_fun__g121_1860, i_1855, im_1854, __kappa) })
}
function intMapFromList(_1866, __kappa) { var xs_1865 = _1866; _yieldCont(__kappa, xs_1865) }
function intMapToList(_1869, __kappa) { var im_1868 = _1869; _yieldCont(__kappa, im_1868) }
function intMapFilter(_1873, _1874, __kappa) {
var im_1871 = _1874;
  var p_1872 = _1873;
  var _1878 = im_1871;
  if ( LINKS.eq(_1878, Nil) ) {
  _yieldCont(__kappa, Nil)
  } else {
  (function (_1879) {
    (function (_1880) {
      var xs_1877 = _1880;
        var x_1876 = _1879;
        _yield(function () { p_1872(x_1876['2'], (function (_1882) {
        if ( _1882 ) {
          _yield(function () { intMapFilter(p_1872, xs_1877, (function (_1881) { _yieldCont(__kappa, _Cons(x_1876, _1881)) })) })
          } else { _yield(function () { intMapFilter(p_1872, xs_1877, __kappa) }) }
        })) })
      })(_tl(_1878))
    })(_hd(_1878))
  }
}
function intMapKeys(_1884, __kappa) {
var im_1883 = _1884;
  var _1888 = im_1883;
  if ( LINKS.eq(_1888, Nil) ) {
  _yieldCont(__kappa, Nil)
  } else {
  (function (_1889) {
    (function (_1890) {
      var xs_1887 = _1890;
        var x_1886 = _1889;
        _yield(function () { intMapKeys(xs_1887, (function (_1891) { _yieldCont(__kappa, _Cons(x_1886['1'], _1891)) })) })
      })(_tl(_1888))
    })(_hd(_1888))
  }
}
function intMapAt(_1895, _1896, __kappa) {
var i_1892 = _1896;
  var im_1893 = _1895;
  _yield(function () { _bang_bang(im_1893, i_1892, (function (_1894) { _yieldCont(__kappa, _1894['2']) })) })
}
function intMapElems(_1901, __kappa) {
var im_1898 = _1901; _yield(function () { unzip(im_1898, (function (_1900) { var elems_1899 = _1900['2']; _yieldCont(__kappa, elems_1899) })) })
}
function main(__kappa) {
var lsNil_1903 = _lsNilF();
  var gameName_1904 = 'Links Pillman';
  var pi_1905 = 3.14159265359;
  var margin_1906 = 8;
  var pillR_1907 = 2;
  var powerPillR_1908 = 4;
  var ghostR_1909 = 6;
  var ghostTrappedOrbit_1910 = 6;
  var pillmanR_1911 = 7;
  var vulnerableColor_1912 = '#66c';
  var timeouts_1913 = {'vulnerable':720, 'trapped':240, 'transition':60, 'idle':120, 'eaten':120, 'eat':10, 'ate':60};
  var regularPillScore_1914 = 10;
  var powerPillScore_1915 = 50;
  var gameAreaWidth_1916 = 400;
  var gameAreaHeight_1917 = 400;
  var bigR_1918 = 24;
  var mediumR_1919 = 16;
  var smallR_1920 = 8;
  var longSpace_1921 = 80;
  var gameAreaCenterX_1922 = gameAreaWidth_1916 / 2;
  var gameAreaCenterY_1923 = gameAreaHeight_1917 / 2;
  var ghostPlanet_1924 = {'y':gameAreaCenterY_1923, 'x':gameAreaCenterX_1922, 'r':bigR_1918};
  var innerLeftGhostPlanet_1925 = {'y':ghostPlanet_1924['y'] - 8, 'x':ghostPlanet_1924['x'] - 72, 'r':mediumR_1919};
  var innerRightGhostPlanet_1926 = {'y':ghostPlanet_1924['y'] - 8, 'x':ghostPlanet_1924['x'] + 72, 'r':mediumR_1919};
  var leftGhostPlanet_1927 = {'y':innerLeftGhostPlanet_1925['y'] + 28, 'x':innerLeftGhostPlanet_1925['x'] - 56, 'r':mediumR_1919};
  var rightGhostPlanet_1928 = {'y':innerRightGhostPlanet_1926['y'] + 28, 'x':innerRightGhostPlanet_1926['x'] + 56, 'r':mediumR_1919};
  var overGhostPlanet_1929 = {'y':ghostPlanet_1924['y'] - 80, 'x':ghostPlanet_1924['x'], 'r':bigR_1918};
  var innerLeftOverGhostPlanet_1930 = {'y':overGhostPlanet_1929['y'], 'x':overGhostPlanet_1929['x'] - 80, 'r':bigR_1918};
  var innerRightOverGhostPlanet_1931 = {'y':overGhostPlanet_1929['y'], 'x':overGhostPlanet_1929['x'] + 80, 'r':bigR_1918};
  var leftOverGhostPlanet_1932 = {'y':innerLeftOverGhostPlanet_1930['y'], 'x':innerLeftOverGhostPlanet_1930['x'] - 64, 'r':smallR_1920};
  var rightOverGhostPlanet_1933 = {'y':innerRightOverGhostPlanet_1931['y'], 'x':innerRightOverGhostPlanet_1931['x'] + 64, 'r':smallR_1920};
  var topPlanet_1934 = {'y':overGhostPlanet_1929['y'] - 64, 'x':overGhostPlanet_1929['x'], 'r':smallR_1920};
  var innerLeftTopPlanet_1935 = {'y':topPlanet_1934['y'], 'x':topPlanet_1934['x'] - 56, 'r':mediumR_1919};
  var innerRightTopPlanet_1936 = {'y':topPlanet_1934['y'], 'x':topPlanet_1934['x'] + 56, 'r':mediumR_1919};
  var leftTopPlanet_1937 = {'y':innerLeftTopPlanet_1935['y'] + 4, 'x':innerLeftTopPlanet_1935['x'] - 64, 'r':mediumR_1919};
  var rightTopPlanet_1938 = {'y':innerRightTopPlanet_1936['y'] + 4, 'x':innerRightTopPlanet_1936['x'] + 64, 'r':mediumR_1919};
  var leftPortal_1939 = {'y':leftGhostPlanet_1927['y'], 'x':leftGhostPlanet_1927['x'] - 48, 'r':2};
  var rightPortal_1940 = {'y':rightGhostPlanet_1928['y'], 'x':rightGhostPlanet_1928['x'] + 48, 'r':2};
  var underGhostPlanet_1941 = {'y':ghostPlanet_1924['y'] + 80, 'x':ghostPlanet_1924['x'], 'r':bigR_1918};
  var innerLeftUnderGhostPlanet_1942 = {'y':underGhostPlanet_1941['y'] - 16, 'x':underGhostPlanet_1941['x'] - 80, 'r':mediumR_1919};
  var innerRightUnderGhostPlanet_1943 = {'y':underGhostPlanet_1941['y'] - 16, 'x':underGhostPlanet_1941['x'] + 80, 'r':mediumR_1919};
  var leftUnderGhostPlanet_1944 = {'y':innerLeftUnderGhostPlanet_1942['y'] + 44, 'x':innerLeftUnderGhostPlanet_1942['x'] - 48, 'r':mediumR_1919};
  var rightUnderGhostPlanet_1945 = {'y':innerRightUnderGhostPlanet_1943['y'] + 44, 'x':innerRightUnderGhostPlanet_1943['x'] + 48, 'r':mediumR_1919};
  var bottomPlanet_1946 = {'y':underGhostPlanet_1941['y'] + 80, 'x':underGhostPlanet_1941['x'], 'r':bigR_1918};
  var innerLeftBottomPlanet_1947 = {'y':bottomPlanet_1946['y'], 'x':bottomPlanet_1946['x'] - 80, 'r':bigR_1918};
  var innerRightBottomPlanet_1948 = {'y':bottomPlanet_1946['y'], 'x':bottomPlanet_1946['x'] + 80, 'r':bigR_1918};
  var leftBottomPlanet_1949 = {'y':innerLeftBottomPlanet_1947['y'], 'x':innerLeftBottomPlanet_1947['x'] - 64, 'r':smallR_1920};
  var rightBottomPlanet_1950 = {'y':innerRightBottomPlanet_1948['y'], 'x':innerRightBottomPlanet_1948['x'] + 64, 'r':smallR_1920};
  var planets_1951 = _ls(_Cons(innerLeftTopPlanet_1935, _Cons(innerRightTopPlanet_1936, _Cons(leftTopPlanet_1937, _Cons(rightTopPlanet_1938, _Cons(topPlanet_1934, _Cons(innerLeftOverGhostPlanet_1930, _Cons(innerRightOverGhostPlanet_1931, _Cons(overGhostPlanet_1929, _Cons(leftOverGhostPlanet_1932, _Cons(rightOverGhostPlanet_1933, _Cons(innerLeftGhostPlanet_1925, _Cons(innerRightGhostPlanet_1926, _Cons(leftGhostPlanet_1927, _Cons(rightGhostPlanet_1928, _Cons(ghostPlanet_1924, _Cons(leftPortal_1939, _Cons(rightPortal_1940, _Cons(innerLeftUnderGhostPlanet_1942, _Cons(innerRightUnderGhostPlanet_1943, _Cons(leftUnderGhostPlanet_1944, _Cons(rightUnderGhostPlanet_1945, _Cons(underGhostPlanet_1941, _Cons(innerLeftBottomPlanet_1947, _Cons(innerRightBottomPlanet_1948, _Cons(leftBottomPlanet_1949, _Cons(rightBottomPlanet_1950, _Cons(bottomPlanet_1946, Nil))))))))))))))))))))))))))));
  var connections_1952 = _ls(_Cons({'2':innerLeftGhostPlanet_1925, '1':ghostPlanet_1924}, _Cons({'2':innerRightGhostPlanet_1926, '1':ghostPlanet_1924}, _Cons({'2':leftGhostPlanet_1927, '1':innerLeftGhostPlanet_1925}, _Cons({'2':rightGhostPlanet_1928, '1':innerRightGhostPlanet_1926}, _Cons({'2':innerLeftUnderGhostPlanet_1942, '1':leftGhostPlanet_1927}, _Cons({'2':innerRightUnderGhostPlanet_1943, '1':rightGhostPlanet_1928}, _Cons({'2':leftUnderGhostPlanet_1944, '1':innerLeftUnderGhostPlanet_1942}, _Cons({'2':rightUnderGhostPlanet_1945, '1':innerRightUnderGhostPlanet_1943}, _Cons({'2':innerLeftBottomPlanet_1947, '1':leftUnderGhostPlanet_1944}, _Cons({'2':innerRightBottomPlanet_1948, '1':rightUnderGhostPlanet_1945}, _Cons({'2':leftBottomPlanet_1949, '1':innerLeftBottomPlanet_1947}, _Cons({'2':rightBottomPlanet_1950, '1':innerRightBottomPlanet_1948}, _Cons({'2':bottomPlanet_1946, '1':innerLeftBottomPlanet_1947}, _Cons({'2':bottomPlanet_1946, '1':innerRightBottomPlanet_1948}, _Cons({'2':underGhostPlanet_1941, '1':bottomPlanet_1946}, _Cons({'2':ghostPlanet_1924, '1':underGhostPlanet_1941}, _Cons({'2':overGhostPlanet_1929, '1':ghostPlanet_1924}, _Cons({'2':leftPortal_1939, '1':leftGhostPlanet_1927}, _Cons({'2':rightPortal_1940, '1':rightGhostPlanet_1928}, _Cons({'2':innerLeftOverGhostPlanet_1930, '1':overGhostPlanet_1929}, _Cons({'2':innerRightOverGhostPlanet_1931, '1':overGhostPlanet_1929}, _Cons({'2':innerLeftGhostPlanet_1925, '1':innerLeftOverGhostPlanet_1930}, _Cons({'2':innerRightGhostPlanet_1926, '1':innerRightOverGhostPlanet_1931}, _Cons({'2':leftOverGhostPlanet_1932, '1':innerLeftOverGhostPlanet_1930}, _Cons({'2':rightOverGhostPlanet_1933, '1':innerRightOverGhostPlanet_1931}, _Cons({'2':leftTopPlanet_1937, '1':innerLeftOverGhostPlanet_1930}, _Cons({'2':rightTopPlanet_1938, '1':innerRightOverGhostPlanet_1931}, _Cons({'2':innerLeftTopPlanet_1935, '1':innerLeftOverGhostPlanet_1930}, _Cons({'2':innerRightTopPlanet_1936, '1':innerRightOverGhostPlanet_1931}, _Cons({'2':innerLeftTopPlanet_1935, '1':leftTopPlanet_1937}, _Cons({'2':innerRightTopPlanet_1936, '1':rightTopPlanet_1938}, _Cons({'2':topPlanet_1934, '1':innerLeftTopPlanet_1935}, _Cons({'2':topPlanet_1934, '1':innerRightTopPlanet_1936}, _Cons({'2':overGhostPlanet_1929, '1':topPlanet_1934}, Nil)))))))))))))))))))))))))))))))))));
  function _fun__g123_1967(_1966, __kappa) {
  var x_1953 = _1966;
    var rr2_1954 = (x_1953['r'] + 5) + margin_1906;
    var _kappa2630 = function (_1964) {
    var _kappa2629 = function (_1965) {
      if ( _1965 ) {
        _yieldCont(__kappa, {'2':lsNil_1903, '1':x_1953})
        } else {
        var _kappa2628 = function (_1957) {
          var pillRange_1955 = _1957['2'];
            var specialPill_1956 = _1957['1'];
            function _fun__g122_1960(_1959, __kappa) {
            var y_1958 = _1959;
              _yieldCont(__kappa, {'3':{'_label':'Regular', '_value':{}}, '2':x_1953['y'] + (rr2_1954 * _cos((_intToFloat(y_1958) / 11) * pi_1905)), '1':x_1953['x'] + (rr2_1954 * _sin((_intToFloat(y_1958) / 11) * pi_1905))})
            }
            _yield(function () { lsMap(_fun__g122_1960, pillRange_1955, (function (_1961) {
            var regularPills_1962 = _1961;
              var _kappa2627 = function (_1963) { _yieldCont(__kappa, {'2':_1963, '1':x_1953}) };
              if ( LINKS.eq(specialPill_1956, lsNil_1903) ) {
              _yieldCont(_kappa2627, regularPills_1962)
              } else { _yieldCont(_kappa2627, _lsCons(specialPill_1956, regularPills_1962)) }
            })) })
          };
          if ( LINKS.eq(x_1953, leftBottomPlanet_1949) ) {
          _yieldCont(_kappa2628, {'2':_lsRange(- 4, 15), '1':{'3':{'_label':'Power', '_value':{}}, '2':x_1953['y'] + (rr2_1954 * _cos((- 0.5) * pi_1905)), '1':x_1953['x'] + (rr2_1954 * _sin((- 0.5) * pi_1905))}})
          } else {
          if ( LINKS.eq(x_1953, rightBottomPlanet_1950) ) {
            _yieldCont(_kappa2628, {'2':_lsRange(- 15, 4), '1':{'3':{'_label':'Power', '_value':{}}, '2':x_1953['y'] + (rr2_1954 * _cos((- 1.5) * pi_1905)), '1':x_1953['x'] + (rr2_1954 * _sin((- 1.5) * pi_1905))}})
            } else {
            if ( LINKS.eq(x_1953, leftOverGhostPlanet_1932) ) {
              _yieldCont(_kappa2628, {'2':_lsRange(- 4, 15), '1':{'3':{'_label':'Power', '_value':{}}, '2':x_1953['y'] + (rr2_1954 * _cos((- 0.5) * pi_1905)), '1':x_1953['x'] + (rr2_1954 * _sin((- 0.5) * pi_1905))}})
              } else {
              if ( LINKS.eq(x_1953, rightOverGhostPlanet_1933) ) {
                _yieldCont(_kappa2628, {'2':_lsRange(- 15, 4), '1':{'3':{'_label':'Power', '_value':{}}, '2':x_1953['y'] + (rr2_1954 * _cos((- 1.5) * pi_1905)), '1':x_1953['x'] + (rr2_1954 * _sin((- 1.5) * pi_1905))}})
                } else { _yieldCont(_kappa2628, {'2':_lsRange(0, 21), '1':lsNil_1903}) }
              }
            }
          }
        }
      };
      if ( _1964 ) { _yieldCont(_kappa2629, true) } else { _yieldCont(_kappa2629, LINKS.eq(x_1953, rightPortal_1940)) }
    };
    if ( LINKS.eq(x_1953, ghostPlanet_1924) ) {
    _yieldCont(_kappa2630, true)
    } else { _yieldCont(_kappa2630, LINKS.eq(x_1953, leftPortal_1939)) }
  }
  _yield(function () { lsMap(_fun__g123_1967, planets_1951, (function (initialPills_1968) {
  function countPills_1973(_1971, _1972, __kappa) {
    var n_1969 = _1972;
      var l_1970 = _1971;
      function pillLength_1978(_1976, _1977, __kappa) {
      var n_1974 = _1977;
        var l_1975 = _1976;
        if ( _lsEmpty(l_1975) ) {
        _yieldCont(__kappa, n_1974)
        } else {
        var p_1979 = _lsHead(l_1975);
          if ( LINKS.eq(p_1979['3'], {'_label':'Regular', '_value':{}}) ) {
          _yield(function () { pillLength_1978(_lsTail(l_1975), n_1974 + 1, __kappa) })
          } else { _yield(function () { pillLength_1978(_lsTail(l_1975), n_1974, __kappa) }) }
        }
      }
      if ( _lsEmpty(l_1970) ) {
      _yieldCont(__kappa, n_1969)
      } else {
      var p_1980 = _lsHead(l_1970);
        _yield(function () { pillLength_1978(p_1980['2'], 0, (function (_1981) {
        _yield(function () { countPills_1973(_lsTail(l_1970), n_1969 + _1981, __kappa) })
        })) })
      }
    }
    _yield(function () { countPills_1973(initialPills_1968, 0, (function (pillCount_1982) {
    var rogerGhost_1983 = {'timeout2':0, 'timeout':timeouts_1913['trapped'], 'state2':{'_label':'Normal', '_value':{}}, 'state':{'_label':'Trapped', '_value':{}}, 'speed':0.015, 'r':ghostR_1909, 'position':{'2':ghostPlanet_1924['y'], '1':ghostPlanet_1924['x']}, 'planet':ghostPlanet_1924, 'nextPlanet':ghostPlanet_1924, 'idx':1, 'dir':1, 'baseSpeed':0.015, 'angle':pi_1905 * 1};
      var johnnyGhost_1984 = {'timeout2':0, 'timeout':timeouts_1913['trapped'], 'state2':{'_label':'Normal', '_value':{}}, 'state':{'_label':'Trapped', '_value':{}}, 'speed':0.012, 'r':ghostR_1909, 'position':{'2':ghostPlanet_1924['y'], '1':ghostPlanet_1924['x']}, 'planet':ghostPlanet_1924, 'nextPlanet':ghostPlanet_1924, 'idx':2, 'dir':1, 'baseSpeed':0.012, 'angle':pi_1905 * 1.6};
      var gregGhost_1985 = {'timeout2':0, 'timeout':timeouts_1913['trapped'], 'state2':{'_label':'Normal', '_value':{}}, 'state':{'_label':'Trapped', '_value':{}}, 'speed':0.01, 'r':ghostR_1909, 'position':{'2':ghostPlanet_1924['y'], '1':ghostPlanet_1924['x']}, 'planet':ghostPlanet_1924, 'nextPlanet':ghostPlanet_1924, 'idx':3, 'dir':1, 'baseSpeed':0.01, 'angle':pi_1905 * 1.2};
      var billGhost_1986 = {'timeout2':0, 'timeout':timeouts_1913['trapped'], 'state2':{'_label':'Normal', '_value':{}}, 'state':{'_label':'Trapped', '_value':{}}, 'speed':0.012, 'r':ghostR_1909, 'position':{'2':ghostPlanet_1924['y'], '1':ghostPlanet_1924['x']}, 'planet':ghostPlanet_1924, 'nextPlanet':ghostPlanet_1924, 'idx':4, 'dir':1, 'baseSpeed':0.012, 'angle':pi_1905 * 1.4};
      var canvasId_1987 = 'gameCanvas';
      var canvas2Id_1988 = 'gameCanvas2';
      var containerId_1989 = 'gameContainer';
      var canvasWidth_1990 = 600;
      var canvasHeight_1991 = 480;
      var leftKeyCode_1992 = 37;
      var rightKeyCode_1993 = 39;
      var upKeyCode_1994 = 38;
      var downKeyCode_1995 = 40;
      var spaceKeyCode_1996 = 32;
      var zKeyCode_1997 = 90;
      var xKeyCode_1998 = 88;
      var restartKeyCode_1999 = 113;
      var downloadKeyCode_2000 = 115;
      var doubleBuffer_2001 = true;
      var step_2002 = 1 / 60;
      var initialFpsInfo_2003 = {'upFrames':0, 'loFpsFrame':0, 'loFps':1000000, 'hiFps':0, 'frameCount':0, 'fpsAcc':0, 'downFrames':0, 'dFps':0, 'avgFps':0};
      var debug_2004 = false;
      var rr_2005 = (bottomPlanet_1946['r'] + pillmanR_1911) + margin_1906;
      var pillmanDescription_2006 = {'timeout2':0, 'timeout':0, 'state2':{'_label':'Normal', '_value':{}}, 'state':{'_label':'Normal', '_value':{}}, 'speed':0.02, 'r':pillmanR_1911, 'position':{'2':bottomPlanet_1946['y'] + (rr_2005 * _cos(pi_1905)), '1':bottomPlanet_1946['x'] + (rr_2005 * _sin(pi_1905))}, 'planet':bottomPlanet_1946, 'nextPlanet':bottomPlanet_1946, 'idx':0, 'dir':1, 'baseSpeed':0.02, 'angle':pi_1905};
      function drawFps_2024(_2021, _2022, _2023, __kappa) {
      var dFps_2007 = _2023;
        var fpsInfo_2008 = _2022;
        var ctx_2009 = _2021;
        var fpsInfo_2010 = LINKS.union(LINKS.erase(fpsInfo_2008, ['dFps', 'frameCount']), {'frameCount':fpsInfo_2008['frameCount'] + 1, 'dFps':dFps_2007});
        (function (_2019) {
        (function (_2020) {
          var _kappa2635 = function (fpsInfo_2011) {
            var _kappa2634 = function (fpsInfo_2012) {
              var fpsInfo_2013 = LINKS.union(LINKS.erase(fpsInfo_2012, ['fpsAcc']), {'fpsAcc':fpsInfo_2012['fpsAcc'] + dFps_2007});
                var aFpsFrames_2014 = 100;
                var _kappa2633 = function (fpsInfo_2015) {
                var _kappa2632 = function (fpsInfo_2016) {
                  var _kappa2631 = function (_2018) { _yieldCont(__kappa, fpsInfo_2016) };
                    if ( _floatEq(fpsInfo_2016['hiFps'], 0) ) {
                    _kappa2631(_jsFillText(ctx_2009, 'loading data: ' + (_intToString(fpsInfo_2016['frameCount']) + ('/' + _intToString(aFpsFrames_2014))), 100, 10))
                    } else {
                    (function (_2017) {
                      _kappa2631(_jsFillText(ctx_2009, 'highest FPS: ' + _2017, 100, 10))
                      })(_strsub(_floatToString(fpsInfo_2016['hiFps']), 0, 7))
                    }
                  };
                  if ( fpsInfo_2015['avgFps'] > 0 ) {
                  if ( dFps_2007 < (fpsInfo_2015['avgFps'] * 0.5) ) {
                    _yieldCont(_kappa2632, LINKS.union(LINKS.erase(fpsInfo_2015, ['downFrames']), {'downFrames':fpsInfo_2015['downFrames'] + 1}))
                    } else {
                    _yieldCont(_kappa2632, LINKS.union(LINKS.erase(fpsInfo_2015, ['upFrames']), {'upFrames':fpsInfo_2015['upFrames'] + 1}))
                    }
                  } else { _yieldCont(_kappa2632, LINKS.union(LINKS.erase(fpsInfo_2015, ['hiFps']), {'hiFps':0})) }
                };
                if ( fpsInfo_2013['frameCount'] > aFpsFrames_2014 ) {
                _yieldCont(_kappa2633, LINKS.union(LINKS.erase(fpsInfo_2013, ['avgFps', 'fpsAcc', 'frameCount']), {'frameCount':0, 'fpsAcc':0, 'avgFps':fpsInfo_2013['fpsAcc'] / _intToFloat(aFpsFrames_2014)}))
                } else { _yieldCont(_kappa2633, fpsInfo_2013) }
              };
              if ( fpsInfo_2011['hiFps'] < dFps_2007 ) {
              _yieldCont(_kappa2634, LINKS.union(LINKS.erase(fpsInfo_2011, ['hiFps']), {'hiFps':dFps_2007}))
              } else { _yieldCont(_kappa2634, fpsInfo_2011) }
            };
            if ( fpsInfo_2010['loFps'] > dFps_2007 ) {
            _yieldCont(_kappa2635, LINKS.union(LINKS.erase(fpsInfo_2010, ['loFps', 'loFpsFrame']), {'loFpsFrame':fpsInfo_2010['frameCount'] - 1, 'loFps':dFps_2007}))
            } else { _yieldCont(_kappa2635, fpsInfo_2010) }
          })(_jsFillText(ctx_2009, 'FPS: ' + _2019, 10, 10))
        })(_strsub(_floatToString(dFps_2007), 0, 7))
      }
      function swapBuffers_2038(_2036, _2037, __kappa) {
      var dispCanvas_2025 = _2037;
        var mainCanvas_2026 = _2036;
        (function (_2027) {
        (function (_2028) {
          var ctx_2029 = _2028;
            (function (_2034) {
            (function (_2035) {
              (function (_2030) {
                (function (_2031) {
                  (function (_2032) {
                    (function (_2033) { _yield(function () { clear(ctx_2029, __kappa) }) })(_domSetStyleAttrFromRef(_2032, 'display', 'none'))
                    })(_getNodeById(dispCanvas_2025))
                  })(_domSetStyleAttrFromRef(_2030, 'display', 'block'))
                })(_getNodeById(mainCanvas_2026))
              })(_jsDrawImage(ctx_2029, _2034, 0, 0))
            })(_getNodeById(mainCanvas_2026))
          })(_jsGetContext2D(_2027))
        })(_getNodeById(dispCanvas_2025))
      }
      function draw_2284(_2280, _2281, _2282, _2283, __kappa) {
      var fpsInfo_2039 = _2283;
        var now_2040 = _2282;
        var lastTime_2041 = _2281;
        var gameState_2042 = _2280;
        (function (_2045) {
        (function (_2046) {
          var _kappa2660 = function (_2047) {
            var _kappa2659 = function (_2048) {
              var dispCanvas_2043 = _2048['2'];
                var mainCanvas_2044 = _2048['1'];
                (function (_2049) {
                (function (ctx_2050) {
                  var pillmanColor_2051 = '#cc4';
                    var pupilColor_2052 = '#111';
                    var eyeColor_2053 = '#ddd';
                    var textColor_2054 = '#ddd';
                    var blinkColor_2055 = '#ddd';
                    var gameOverColor_2056 = '#c66';
                    var planetColor_2057 = '#115';
                    var highlightColor_2058 = '#282';
                    _yield(function () { clear(ctx_2050, (function (_2279) {
                    function drawGhostEyes_2070(_2066, _2067, _2068, _2069, __kappa) {
                      var color_2059 = _2069;
                        var rr_2060 = _2068;
                        var angle_2061 = _2067;
                        var ghost_2062 = _2066;
                        (function (_2065) {
                        (function (_2064) {
                          (function (_2063) {
                            _yieldCont(__kappa, {})
                            })(_jsFillCircle(ctx_2050, ghost_2062['planet']['x'] + ((rr_2060 - 4) * _sin(angle_2061)), ghost_2062['planet']['y'] + ((rr_2060 - 4) * _cos(angle_2061)), ghostR_1909 / 3))
                          })(_jsFillCircle(ctx_2050, ghost_2062['planet']['x'] + ((rr_2060 + 4) * _sin(angle_2061)), ghost_2062['planet']['y'] + ((rr_2060 + 4) * _cos(angle_2061)), ghostR_1909 / 3))
                        })(_jsSetFillColor(ctx_2050, color_2059))
                      }
                      function drawGhostPupils_2082(_2078, _2079, _2080, _2081, __kappa) {
                      var color_2071 = _2081;
                        var rr_2072 = _2080;
                        var angle_2073 = _2079;
                        var ghost_2074 = _2078;
                        (function (_2077) {
                        (function (_2076) {
                          (function (_2075) {
                            _yieldCont(__kappa, {})
                            })(_jsFillCircle(ctx_2050, ghost_2074['planet']['x'] + ((rr_2072 - 4) * _sin(angle_2073)), ghost_2074['planet']['y'] + ((rr_2072 - 4) * _cos(angle_2073)), ghostR_1909 / 5))
                          })(_jsFillCircle(ctx_2050, ghost_2074['planet']['x'] + ((rr_2072 + 4) * _sin(angle_2073)), ghost_2074['planet']['y'] + ((rr_2072 + 4) * _cos(angle_2073)), ghostR_1909 / 5))
                        })(_jsSetFillColor(ctx_2050, color_2071))
                      }
                      function drawGhost_2117(_2115, _2116, __kappa) {
                      var color_2083 = _2116;
                        var ghost_2084 = _2115;
                        var ghostRR_2085 = (ghost_2084['planet']['r'] + ghostR_1909) + margin_1906;
                        var ghostRR2_2086 = ghostRR_2085 + 4;
                        var ghostRR3_2087 = ghostRR_2085 - 4;
                        var bottomPartR_2088 = ghostR_1909 / 3;
                        var b_2089 = ((0.15 * ((bigR_1918 + ghostR_1909) + margin_1906)) / ghostRR_2085) * ghost_2084['dir'];
                        var bottomAngle_2090 = ghost_2084['angle'] - b_2089;
                        var eyesAngle_2091 = ghost_2084['angle'] - (b_2089 * (- 0.1));
                        var mouthAngle_2092 = ghost_2084['angle'] - (b_2089 * 0.7);
                        var _kappa2642 = function (_2113) {
                        var _kappa2640 = function (_2114) {
                          var _kappa2639 = function (_2109) {
                            var _kappa2638 = function (_2105) {
                              var _kappa2637 = function (_2106) {
                                if ( _2106 ) {
                                  (function (_2104) {
                                    (function (_2103) {
                                      (function (_2102) {
                                        _yield(function () { drawGhostEyes_2070(ghost_2084, eyesAngle_2091, ghostRR_2085, eyeColor_2053, (function (_2101) {
                                          var _kappa2636 = function (_2100) {
                                            if ( _2100 ) {
                                              _yield(function () { drawGhostPupils_2082(ghost_2084, eyesAngle_2091, ghostRR_2085, pupilColor_2052, __kappa) })
                                              } else {
                                              (function (_2099) {
                                                (function (_2098) {
                                                  (function (_2097) {
                                                    (function (_2096) {
                                                      (function (_2095) {
                                                        (function (_2094) {
                                                          (function (_2093) { _yieldCont(__kappa, {}) })(_jsStroke(ctx_2050))
                                                          })(_jsClosePath(ctx_2050))
                                                        })(_jsLineTo(ctx_2050, ghost_2084['planet']['x'] + (ghostRR2_2086 * _sin(mouthAngle_2092)), ghost_2084['planet']['y'] + (ghostRR2_2086 * _cos(mouthAngle_2092))))
                                                      })(_jsMoveTo(ctx_2050, ghost_2084['planet']['x'] + (ghostRR3_2087 * _sin(mouthAngle_2092)), ghost_2084['planet']['y'] + (ghostRR3_2087 * _cos(mouthAngle_2092))))
                                                    })(_jsLineWidth(ctx_2050, 1.5))
                                                  })(_jsStrokeStyle(ctx_2050, eyeColor_2053))
                                                })(_jsBeginPath(ctx_2050))
                                              }
                                            };
                                            if ( LINKS.eq(ghost_2084['state'], {'_label':'Normal', '_value':{}}) ) {
                                            _yieldCont(_kappa2636, true)
                                            } else { _yieldCont(_kappa2636, LINKS.eq(ghost_2084['state'], {'_label':'Idle', '_value':{}})) }
                                          })) })
                                        })(_jsFillCircle(ctx_2050, ghost_2084['planet']['x'] + (ghostRR3_2087 * _sin(bottomAngle_2090)), ghost_2084['planet']['y'] + (ghostRR3_2087 * _cos(bottomAngle_2090)), bottomPartR_2088))
                                      })(_jsFillCircle(ctx_2050, ghost_2084['planet']['x'] + (ghostRR2_2086 * _sin(bottomAngle_2090)), ghost_2084['planet']['y'] + (ghostRR2_2086 * _cos(bottomAngle_2090)), bottomPartR_2088))
                                    })(_jsFillCircle(ctx_2050, ghost_2084['planet']['x'] + (ghostRR_2085 * _sin(bottomAngle_2090)), ghost_2084['planet']['y'] + (ghostRR_2085 * _cos(bottomAngle_2090)), bottomPartR_2088))
                                  } else { _yieldCont(__kappa, {}) }
                                };
                                if ( _2105 ) {
                                _yieldCont(_kappa2637, true)
                                } else { _yieldCont(_kappa2637, LINKS.eq(ghost_2084['state'], {'_label':'Idle', '_value':{}})) }
                              };
                              if ( LINKS.eq(ghost_2084['state'], {'_label':'Normal', '_value':{}}) ) {
                              _yieldCont(_kappa2638, true)
                              } else { _yieldCont(_kappa2638, LINKS.eq(ghost_2084['state'], {'_label':'Vulnerable', '_value':{}})) }
                            };
                            if ( LINKS.eq(ghost_2084['state'], {'_label':'Points', '_value':{}}) ) {
                            (function (_2108) {
                              _kappa2639(_jsFillText(ctx_2050, _intToString(ghost_2084['timeout']), ghost_2084['position']['1'], ghost_2084['position']['2']))
                              })(_jsSetFillColor(ctx_2050, '#88d'))
                            } else {
                            if ( LINKS.eq(ghost_2084['state'], {'_label':'Eyes', '_value':{}}) ) {
                              _yield(function () { drawGhostEyes_2070(ghost_2084, eyesAngle_2091, ghostRR_2085, eyeColor_2053, (function (_2107) {
                                _yield(function () { drawGhostPupils_2082(ghost_2084, eyesAngle_2091, ghostRR_2085, pupilColor_2052, _kappa2639) })
                                })) })
                              } else {
                              _kappa2639(_jsFillCircle(ctx_2050, ghost_2084['position']['1'], ghost_2084['position']['2'], ghostR_1909))
                              }
                            }
                          };
                          if ( _2113 ) {
                          _kappa2640(_jsSetFillColor(ctx_2050, color_2083))
                          } else {
                          _yieldCont(function (oneFourthTimeout_2110) {
                            var _kappa2641 = function (_2112) {
                              if ( _2112 ) {
                                _kappa2640(_jsSetFillColor(ctx_2050, vulnerableColor_1912))
                                } else { _kappa2640(_jsSetFillColor(ctx_2050, '#aad')) }
                              };
                              if ( ghost_2084['timeout'] > oneFourthTimeout_2110 ) {
                              _yieldCont(_kappa2641, true)
                              } else { _yieldCont(function (_2111) { _yieldCont(_kappa2641, _2111 > 7) }, ghost_2084['timeout'] % 15) }
                            }, Math.floor(gameState_2042['timeouts']['vulnerable'] / 4))
                          }
                        };
                        if ( _not(LINKS.eq(ghost_2084['state'], {'_label':'Vulnerable', '_value':{}})) ) {
                        _yieldCont(_kappa2642, _not(LINKS.eq(ghost_2084['state2'], {'_label':'Vulnerable', '_value':{}})))
                        } else { _yieldCont(_kappa2642, false) }
                      }
                      function drawPillman_2169(_2167, _2168, __kappa) {
                      var gameState_2118 = _2168;
                        var pillman_2119 = _2167;
                        if ( LINKS.eq(gameState_2118['state'], {'_label':'Eaten2', '_value':{}}) ) {
                        var x_2144 = pillman_2119['position']['1'];
                          var y_2145 = pillman_2119['position']['2'];
                          (function (_2166) {
                          (function (_2165) {
                            (function (_2164) {
                              (function (_2163) {
                                (function (_2162) {
                                  (function (_2161) {
                                    (function (_2160) {
                                      (function (_2159) {
                                        (function (_2158) {
                                          (function (_2157) {
                                            (function (_2156) {
                                              (function (_2155) {
                                                (function (_2154) {
                                                  (function (_2153) {
                                                    (function (_2152) {
                                                      (function (_2151) {
                                                        (function (_2150) {
                                                          (function (_2149) {
                                                            (function (_2148) {
                                                              (function (_2147) {
                                                                (function (_2146) { _yieldCont(__kappa, {}) })(_jsStroke(ctx_2050))
                                                                })(_jsClosePath(ctx_2050))
                                                              })(_jsLineTo(ctx_2050, x_2144 + 4, y_2145 - 4))
                                                            })(_jsMoveTo(ctx_2050, x_2144 + 2, y_2145 - 2))
                                                          })(_jsLineTo(ctx_2050, x_2144 - 4, y_2145 + 4))
                                                        })(_jsMoveTo(ctx_2050, x_2144 - 2, y_2145 + 2))
                                                      })(_jsLineTo(ctx_2050, x_2144 + 4, y_2145 + 4))
                                                    })(_jsMoveTo(ctx_2050, x_2144 + 2, y_2145 + 2))
                                                  })(_jsLineTo(ctx_2050, x_2144 - 4, y_2145 - 4))
                                                })(_jsMoveTo(ctx_2050, x_2144 - 2, y_2145 - 2))
                                              })(_jsLineTo(ctx_2050, x_2144 + 5, y_2145))
                                            })(_jsMoveTo(ctx_2050, x_2144 + 3, y_2145))
                                          })(_jsLineTo(ctx_2050, x_2144 - 5, y_2145))
                                        })(_jsMoveTo(ctx_2050, x_2144 - 3, y_2145))
                                      })(_jsLineTo(ctx_2050, x_2144, y_2145 + 5))
                                    })(_jsMoveTo(ctx_2050, x_2144, y_2145 + 3))
                                  })(_jsLineTo(ctx_2050, x_2144, y_2145 - 5))
                                })(_jsMoveTo(ctx_2050, x_2144, y_2145 - 3))
                              })(_jsBeginPath(ctx_2050))
                            })(_jsStrokeStyle(ctx_2050, pillmanColor_2051))
                          })(_jsLineWidth(ctx_2050, 1))
                        } else {
                        var _kappa2646 = function (_2123) {
                          var piFraction_2120 = _2123['3'];
                            var totalTimeout_2121 = _2123['2'];
                            var timeout_2122 = _2123['1'];
                            var _kappa2645 = function (angle_2124) {
                            var _2125 = pillman_2119['state'];
                              var _kappa2644 = function (mouthOpen_2129) {
                              (function (_2143) {
                                (function (_2142) {
                                  (function (_2141) {
                                    (function (_2140) {
                                      (function (_2139) {
                                        (function (_2138) {
                                          (function (_2137) {
                                            var _kappa2643 = function (_2136) {
                                              if ( _2136 ) {
                                                _yieldCont(__kappa, {})
                                                } else {
                                                var pillmanRR_2130 = (pillman_2119['planet']['r'] + pillmanR_1911) + margin_1906;
                                                  var tailLength_2131 = (0.125 * ((bigR_1918 + pillmanR_1911) + margin_1906)) / pillmanRR_2130;
                                                  (function (_2135) {
                                                  (function (_2134) {
                                                    (function (_2133) {
                                                      (function (_2132) {
                                                        _yieldCont(__kappa, {})
                                                        })(_jsFillCircle(ctx_2050, pillman_2119['planet']['x'] + ((pillmanRR_2130 - 2) * _sin(pillman_2119['angle'] - (pillman_2119['dir'] * tailLength_2131))), pillman_2119['planet']['y'] + ((pillmanRR_2130 - 2) * _cos(pillman_2119['angle'] - (pillman_2119['dir'] * tailLength_2131))), 1))
                                                      })(_jsSetFillColor(ctx_2050, eyeColor_2053))
                                                    })(_jsFillCircle(ctx_2050, pillman_2119['planet']['x'] + ((pillmanRR_2130 - 2) * _sin(pillman_2119['angle'] - (pillman_2119['dir'] * tailLength_2131))), pillman_2119['planet']['y'] + ((pillmanRR_2130 - 2) * _cos(pillman_2119['angle'] - (pillman_2119['dir'] * tailLength_2131))), 2))
                                                  })(_jsSetFillColor(ctx_2050, pupilColor_2052))
                                                }
                                              };
                                              if ( LINKS.eq(gameState_2118['state'], {'_label':'Eaten', '_value':{}}) ) {
                                              _yieldCont(_kappa2643, true)
                                              } else {
                                              _yieldCont(_kappa2643, LINKS.eq(gameState_2118['state'], {'_label':'Eaten2', '_value':{}}))
                                              }
                                            })(_jsFill(ctx_2050))
                                          })(_jsClosePath(ctx_2050))
                                        })(_jsLineTo(ctx_2050, pillman_2119['position']['1'], pillman_2119['position']['2']))
                                      })(_jsArc(ctx_2050, pillman_2119['position']['1'], pillman_2119['position']['2'], pillmanR_1911, (((1 - piFraction_2120) * pi_1905) - mouthOpen_2129) + angle_2124, mouthOpen_2129 + angle_2124, false))
                                    })(_jsMoveTo(ctx_2050, pillman_2119['position']['1'], pillman_2119['position']['2']))
                                  })(_jsBeginPath(ctx_2050))
                                })(_jsSetFillColor(ctx_2050, pillmanColor_2051))
                              };
                              switch (_2125._label) {case 'Backward': {var _2126 = _2125._value; _yieldCont(_kappa2644, (piFraction_2120 * pi_1905) * (_intToFloat((totalTimeout_2121 - timeout_2122) + 1) / _intToFloat(totalTimeout_2121))); break;}
                               case 'Normal': {var _2127 = _2125._value; _yieldCont(_kappa2644, (piFraction_2120 * pi_1905) * (_intToFloat(timeout_2122 + 1) / _intToFloat(totalTimeout_2121))); break;}
                               default: {var _2128 = _2125; _yieldCont(_kappa2644, 0); break;}
                              }
                            };
                            if ( LINKS.eq(pillman_2119['dir'], 1) ) {
                            _yieldCont(_kappa2645, (- pillman_2119['angle']) - ((piFraction_2120 + 0.1) * pi_1905))
                            } else { _yieldCont(_kappa2645, (- pillman_2119['angle']) + ((1.1 - piFraction_2120) * pi_1905)) }
                          };
                          if ( LINKS.eq(gameState_2118['state'], {'_label':'Eaten', '_value':{}}) ) {
                          _yieldCont(_kappa2646, {'3':1, '2':gameState_2118['timeouts']['eaten'] + 1, '1':gameState_2118['timeout']})
                          } else { _yieldCont(_kappa2646, {'3':0.3, '2':gameState_2118['timeouts']['eat'] + 1, '1':pillman_2119['timeout']}) }
                        }
                      }
                      (function (_2278) {
                      (function (_2277) {
                        (function (_2276) {
                          (function (_2275) {
                            var _kappa2658 = function (_2274) {
                              var drawOffset_2170 = {'y':24, 'x':108};
                                (function (_2266) {
                                (function (_2265) {
                                  (function (_2264) {
                                    (function (_2263) {
                                      function _fun__g125_2261(_2260, __kappa) {
                                        var x_2252 = _2260;
                                          (function (_2257) {
                                          (function (_2258) {
                                            (function (_2259) {
                                              (function (_2254) {
                                                (function (_2255) {
                                                  (function (_2256) {
                                                    (function (_2253) { _yieldCont(__kappa, {}) })(_jsStroke(ctx_2050))
                                                    })(_jsLineTo(ctx_2050, x_2252['2']['x'] + _2254, x_2252['2']['y'] + _2255))
                                                  })(_random())
                                                })(_random())
                                              })(_jsMoveTo(ctx_2050, x_2252['1']['x'] + _2257, x_2252['1']['y'] + _2258))
                                            })(_random())
                                          })(_random())
                                        }
                                        _yield(function () { lsMapIgnore(_fun__g125_2261, connections_1952, (function (_2262) {
                                        (function (_2251) {
                                          var _kappa2657 = function (_2250) {
                                            (function (_2238) {
                                              (function (_2234) {
                                                (function (_2235) {
                                                  (function (_2236) {
                                                    (function (_2237) {
                                                      var _kappa2656 = function (_2232) {
                                                        var _kappa2655 = function (_2233) {
                                                          function _fun__g126_2229(_2228, __kappa) {
                                                            var x_2223 = _2228;
                                                              (function (_2224) {
                                                              (function (_2225) {
                                                                (function (_2226) {
                                                                  (function (_2227) {
                                                                    _yieldCont(__kappa, {})
                                                                    })(_jsFillCircle(ctx_2050, x_2223['x'] + _2224, x_2223['y'] + _2225, x_2223['r'] + _2226))
                                                                  })(_random())
                                                                })(_random())
                                                              })(_random())
                                                            }
                                                            _yield(function () { lsMapIgnore(_fun__g126_2229, planets_1951, (function (_2230) {
                                                            (function (_2222) {
                                                              (function (_2218) {
                                                                (function (_2219) {
                                                                  (function (_2220) {
                                                                    (function (_2221) {
                                                                      (function (_2217) {
                                                                        function _fun__g128_2215(_2214, __kappa) {
                                                                          var x_2202 = _2214;
                                                                            function _fun__g127_2213(_2212, __kappa) {
                                                                            var y_2203 = _2212;
                                                                              var _2204 = y_2203['3'];
                                                                              switch (_2204._label) {case 'Power': {var _2205 = _2204._value; (function (_2206) {
                                                                              (function (_2207) {
                                                                                __kappa(_jsFillCircle(ctx_2050, y_2203['1'] + _2206, y_2203['2'] + _2207, powerPillR_1908))
                                                                                })(_random())
                                                                              })(_random()); break;}
                                                                               case 'Regular': {var _2208 = _2204._value; (function (_2209) {
                                                                              (function (_2210) {
                                                                                __kappa(_jsFillCircle(ctx_2050, y_2203['1'] + _2209, y_2203['2'] + _2210, pillR_1907))
                                                                                })(_random())
                                                                              })(_random()); break;}
                                                                               default: {var _2211 = _2204; _yieldCont(__kappa, {}); break;}
                                                                              }
                                                                            }
                                                                            _yield(function () { lsMapIgnore(_fun__g127_2213, x_2202['2'], __kappa) })
                                                                          }
                                                                          _yield(function () { lsMapIgnore(_fun__g128_2215, gameState_2042['pills'], (function (_2216) {
                                                                          var _kappa2650 = function (_2201) {
                                                                            (function (_2183) {
                                                                              var dFps_2171 = 1000 / (_intToFloat(now_2040 - lastTime_2041) + 1);
                                                                                (function (_2182) {
                                                                                var _kappa2649 = function (fpsInfo_2172) {
                                                                                  var _kappa2648 = function (_2181) {
                                                                                    var _kappa2647 = function (gameState_2180) {
                                                                                      _yieldCont(__kappa, fpsInfo_2172)
                                                                                      };
                                                                                      if ( LINKS.eq(gameState_2042['metaState'], {'_label':'Download', '_value':{}}) ) {
                                                                                      (function (downloadNode_2173) {
                                                                                        (function (_2174) {
                                                                                          var imageName_2175 = gameName_1904 + ('-' + (_intToString(_2174) + '.png'));
                                                                                            (function (_2176) {
                                                                                            (function (_2179) {
                                                                                              (function (_2177) {
                                                                                                (function (_2178) {
                                                                                                  _yieldCont(_kappa2647, LINKS.union(LINKS.erase(gameState_2042, ['state']), {'state':{'_label':'On', '_value':{}}}))
                                                                                                  })(_jsSaveCanvas(_2177, downloadNode_2173, 'image/png'))
                                                                                                })(_getNodeById(mainCanvas_2044))
                                                                                              })(_replaceChildren(_Concat(_Concat(_Concat(_Concat(_Concat(_Concat(_stringToXml('\n					'), _stringToXml('Click to download the snapshot as')), _stringToXml('\n					')), LINKS.XML('br', {}, [])), _stringToXml('\n					')), _stringToXml(imageName_2175)), _stringToXml('\n				')), downloadNode_2173))
                                                                                            })(_domSetAttributeFromRef(downloadNode_2173, 'download', imageName_2175))
                                                                                          })(_clientTime())
                                                                                        })(_getNodeById('download'))
                                                                                      } else { _yieldCont(_kappa2647, gameState_2042) }
                                                                                    };
                                                                                    if ( doubleBuffer_2001 ) {
                                                                                    _yield(function () { swapBuffers_2038(mainCanvas_2044, dispCanvas_2043, _kappa2648) })
                                                                                    } else { _yieldCont(_kappa2648, {}) }
                                                                                  };
                                                                                  if ( debug_2004 ) {
                                                                                  _yield(function () { drawFps_2024(ctx_2050, fpsInfo_2039, dFps_2171, _kappa2649) })
                                                                                  } else { _yieldCont(_kappa2649, fpsInfo_2039) }
                                                                                })(_jsSetFillColor(ctx_2050, textColor_2054))
                                                                              })(_jsRestore(ctx_2050))
                                                                            };
                                                                            if ( LINKS.eq(gameState_2042['state'], {'_label':'Over', '_value':{}}) ) {
                                                                            (function (_2200) {
                                                                              (function (_2199) {
                                                                                _yieldCont(_kappa2650, {})
                                                                                })(_jsFillText(ctx_2050, 'GAME     OVER', ghostPlanet_1924['x'] - 37, ghostPlanet_1924['y'] + 48))
                                                                              })(_jsSetFillColor(ctx_2050, gameOverColor_2056))
                                                                            } else {
                                                                            var _kappa2654 = function (_2198) {
                                                                              var _kappa2653 = function (_2192) {
                                                                                var _kappa2652 = function (_2190) {
                                                                                  var _kappa2651 = function (_2191) {
                                                                                    (function (_2186) {
                                                                                      (function (_2185) {
                                                                                        (function (_2184) {
                                                                                          _yieldCont(_kappa2650, {})
                                                                                          })(_jsFillCircle(ctx_2050, rightPortal_1940['x'], rightPortal_1940['y'], rightPortal_1940['r'] * 1.2))
                                                                                        })(_jsFillCircle(ctx_2050, leftPortal_1939['x'], leftPortal_1939['y'], leftPortal_1939['r'] * 1.2))
                                                                                      })(_jsSetFillColor(ctx_2050, '#eec'))
                                                                                    };
                                                                                    if ( _2190 ) {
                                                                                    _yieldCont(_kappa2651, {})
                                                                                    } else {
                                                                                    _yield(function () { drawGhost_2117(gameState_2042['roger'], '#a44', (function (_2189) {
                                                                                      _yield(function () { drawGhost_2117(gameState_2042['johnny'], '#4a4', (function (_2188) {
                                                                                        _yield(function () { drawGhost_2117(gameState_2042['greg'], '#a6a', (function (_2187) {
                                                                                          _yield(function () { drawGhost_2117(gameState_2042['bill'], '#6aa', _kappa2651) })
                                                                                          })) })
                                                                                        })) })
                                                                                      })) })
                                                                                    }
                                                                                  };
                                                                                  if ( LINKS.eq(gameState_2042['state'], {'_label':'Eaten', '_value':{}}) ) {
                                                                                  _yieldCont(_kappa2652, true)
                                                                                  } else {
                                                                                  _yieldCont(_kappa2652, LINKS.eq(gameState_2042['state'], {'_label':'Eaten2', '_value':{}}))
                                                                                  }
                                                                                };
                                                                                if ( LINKS.eq(gameState_2042['state'], {'_label':'Ate', '_value':{}}) ) {
                                                                                _yieldCont(_kappa2653, {})
                                                                                } else {
                                                                                _yield(function () { drawPillman_2169(gameState_2042['pillman'], gameState_2042, _kappa2653) })
                                                                                }
                                                                              };
                                                                              if ( LINKS.eq(gameState_2042['state'], {'_label':'On', '_value':{}}) ) {
                                                                              (function (_2197) {
                                                                                (function (_2193) {
                                                                                  (function (_2194) {
                                                                                    (function (_2195) {
                                                                                      (function (_2196) {
                                                                                        _yieldCont(_kappa2654, {})
                                                                                        })(_jsFillCircle(ctx_2050, gameState_2042['pillman']['planet']['x'] + _2193, gameState_2042['pillman']['planet']['y'] + _2194, (gameState_2042['pillman']['planet']['r'] * 0.8) + _2195))
                                                                                      })(_random())
                                                                                    })(_random())
                                                                                  })(_random())
                                                                                })(_jsSetFillColor(ctx_2050, highlightColor_2058))
                                                                              } else { _yieldCont(_kappa2654, {}) }
                                                                            }
                                                                          })) })
                                                                        })(_jsSetFillColor(ctx_2050, pillmanColor_2051))
                                                                      })(_jsFillCircle(ctx_2050, ghostPlanet_1924['x'] + _2218, ghostPlanet_1924['y'] + _2219, (ghostPlanet_1924['r'] * 0.8) + _2220))
                                                                    })(_random())
                                                                  })(_random())
                                                                })(_random())
                                                              })(_jsSetFillColor(ctx_2050, '#226'))
                                                            })) })
                                                          };
                                                          if ( _2232 ) {
                                                          _kappa2655(_jsSetFillColor(ctx_2050, blinkColor_2055))
                                                          } else { _kappa2655(_jsSetFillColor(ctx_2050, planetColor_2057)) }
                                                        };
                                                        if ( LINKS.eq(gameState_2042['state'], {'_label':'NextLevel', '_value':{}}) ) {
                                                        _yieldCont(function (_2231) {
                                                          _yieldCont(_kappa2656, _2231 > 10)
                                                          }, gameState_2042['timeout'] % 20)
                                                        } else { _yieldCont(_kappa2656, false) }
                                                      })(_jsFillCircle(ctx_2050, ghostPlanet_1924['x'] + _2234, ghostPlanet_1924['y'] + _2235, (ghostPlanet_1924['r'] * 1.2) + _2236))
                                                    })(_random())
                                                  })(_random())
                                                })(_random())
                                              })(_jsSetFillColor(ctx_2050, '#003'))
                                            };
                                            if ( LINKS.eq(gameState_2042['pillman']['planet'], gameState_2042['pillman']['nextPlanet']) ) {
                                            _yieldCont(_kappa2657, {})
                                            } else {
                                            if ( LINKS.eq(gameState_2042['state'], {'_label':'On', '_value':{}}) ) {
                                              (function (_2249) {
                                                (function (_2248) {
                                                  (function (_2247) {
                                                    (function (_2244) {
                                                      (function (_2245) {
                                                        (function (_2246) {
                                                          (function (_2241) {
                                                            (function (_2242) {
                                                              (function (_2243) {
                                                                (function (_2240) {
                                                                  (function (_2239) { _yieldCont(_kappa2657, {}) })(_jsClosePath(ctx_2050))
                                                                  })(_jsStroke(ctx_2050))
                                                                })(_jsLineTo(ctx_2050, gameState_2042['pillman']['nextPlanet']['x'] + _2241, gameState_2042['pillman']['nextPlanet']['y'] + _2242))
                                                              })(_random())
                                                            })(_random())
                                                          })(_jsMoveTo(ctx_2050, gameState_2042['pillman']['planet']['x'] + _2244, gameState_2042['pillman']['planet']['y'] + _2245))
                                                        })(_random())
                                                      })(_random())
                                                    })(_jsLineWidth(ctx_2050, 4))
                                                  })(_jsStrokeStyle(ctx_2050, highlightColor_2058))
                                                })(_jsBeginPath(ctx_2050))
                                              } else { _yieldCont(_kappa2657, {}) }
                                            }
                                          })(_jsClosePath(ctx_2050))
                                        })) })
                                      })(_jsStrokeStyle(ctx_2050, '#222'))
                                    })(_jsBeginPath(ctx_2050))
                                  })(_jsTranslate(ctx_2050, drawOffset_2170['x'], drawOffset_2170['y']))
                                })(_jsSave(ctx_2050))
                              };
                              if ( gameState_2042['lives'] < 0 ) {
                              (function (_2273) {
                                _kappa2658(_jsFillText(ctx_2050, 'GAME OVER', 10, 70))
                                })(_jsSetFillColor(ctx_2050, gameOverColor_2056))
                              } else {
                              (function (_2272) {
                                function _fun__g124_2271(_2270, __kappa) {
                                  var x_2267 = _2270;
                                    var x_2268 = _intToFloat(x_2267);
                                    var pos_2269 = {'2':90, '1':20 + ((x_2268 * 2.5) * pillmanR_1911)};
                                    _yield(function () { drawPillman_2169(LINKS.union(LINKS.erase(pillmanDescription_2006, ['planet', 'position']), {'position':pos_2269, 'planet':{'y':pos_2269['2'], 'x':pos_2269['1'], 'r':- 10}}), LINKS.union(LINKS.erase(gameState_2042, ['state']), {'state':{'_label':'On', '_value':{}}}), __kappa) })
                                  }
                                  _yield(function () { lsMapIgnore(_fun__g124_2271, _lsRange(0, gameState_2042['lives'] - 1), _kappa2658) })
                                })(_jsFillText(ctx_2050, 'Lives: ' + _intToString(gameState_2042['lives']), 10, 70))
                              }
                            })(_jsFillText(ctx_2050, 'Level: ' + _intToString(gameState_2042['level']), 10, 50))
                          })(_jsFillText(ctx_2050, 'Score: ' + _intToString(gameState_2042['score']), 10, 40))
                        })(_jsFillText(ctx_2050, 'Pills: ' + (_intToString(gameState_2042['pillCount']) + ('/' + _intToString(pillCount_1982))), 10, 30))
                      })(_jsSetFillColor(ctx_2050, textColor_2054))
                    })) })
                  })(_jsGetContext2D(_2049))
                })(_getNodeById(mainCanvas_2044))
              };
              if ( _2047 ) {
              _yieldCont(_kappa2659, {'2':canvas2Id_1988, '1':canvasId_1987})
              } else { _yieldCont(_kappa2659, {'2':canvasId_1987, '1':canvas2Id_1988}) }
            };
            if ( _stringEq(_2046, 'none') ) { _yieldCont(_kappa2660, true) } else { _yieldCont(_kappa2660, _not(doubleBuffer_2001)) }
          })(_domGetStyleAttrFromRef(_2045, 'display'))
        })(_getNodeById(canvasId_1987))
      }
      function circleCircleCollision_2291(_2289, _2290, __kappa) {
      var circle2_2285 = _2290;
        var circle1_2286 = _2289;
        _yield(function () { vectorSub(circle1_2286['1'], circle2_2285['1'], (function (v_2287) {
        var r_2288 = circle1_2286['2'] + circle2_2285['2'];
          if ( ((v_2287['1'] * v_2287['1']) + (v_2287['2'] * v_2287['2'])) < (r_2288 * r_2288) ) {
          _yieldCont(__kappa, true)
          } else { _yieldCont(__kappa, false) }
        })) })
      }
      function getCurrentSpeed_2296(_2294, _2295, __kappa) {
      var gameState_2292 = _2295; var base_2293 = _2294; _yieldCont(__kappa, base_2293 + (_intToFloat(gameState_2292['level']) * 0.00012))
      }
      function transformGhost_2303(_2301, _2302, __kappa) {
      var gameState_2297 = _2302;
        var ghost_2298 = _2301;
        var _kappa2661 = function (_2300) {
        if ( _2300 ) {
          _yield(function () { getCurrentSpeed_2296(ghost_2298['baseSpeed'], gameState_2297, (function (_2299) {
            _yieldCont(__kappa, LINKS.union(LINKS.erase(ghost_2298, ['speed', 'state', 'timeout']), {'timeout':gameState_2297['timeouts']['vulnerable'], 'state':{'_label':'Vulnerable', '_value':{}}, 'speed':_2299 * 0.5}))
            })) })
          } else {
          if ( LINKS.eq(ghost_2298['state'], {'_label':'Trapped', '_value':{}}) ) {
            _yieldCont(__kappa, LINKS.union(LINKS.erase(ghost_2298, ['state2', 'timeout2']), {'timeout2':gameState_2297['timeouts']['vulnerable'], 'state2':{'_label':'Vulnerable', '_value':{}}}))
            } else { _yieldCont(__kappa, ghost_2298) }
          }
        };
        if ( LINKS.eq(ghost_2298['state'], {'_label':'Normal', '_value':{}}) ) {
        _yieldCont(_kappa2661, true)
        } else { _yieldCont(_kappa2661, LINKS.eq(ghost_2298['state'], {'_label':'Idle', '_value':{}})) }
      }
      function getNewPillPlanets_2310(_2307, _2308, _2309, __kappa) {
      var gameState_2304 = _2309;
        var headPlanets_2305 = _2308;
        var l_2306 = _2307;
        function getNewPills_2317(_2314, _2315, _2316, __kappa) {
        var gameState_2311 = _2316;
          var headPills_2312 = _2315;
          var l_2313 = _2314;
          if ( _lsEmpty(l_2313) ) {
          _yieldCont(__kappa, {'2':headPills_2312, '1':gameState_2311})
          } else {
          var pill_2318 = _lsHead(l_2313);
            _yield(function () { circleCircleCollision_2291({'2':pillR_1907, '1':{'2':pill_2318['2'], '1':pill_2318['1']}}, {'2':pillmanR_1911, '1':gameState_2311['pillman']['position']}, (function (_2328) {
            if ( _2328 ) {
              var _2319 = pill_2318['3'];
                var _kappa2686 = function (gameState_2327) {
                _yieldCont(__kappa, {'2':_lsAppend(headPills_2312, _lsTail(l_2313)), '1':gameState_2327})
                };
                switch (_2319._label) {case 'Power': {var _2320 = _2319._value; _yield(function () { transformGhost_2303(gameState_2311['roger'], gameState_2311, (function (_2321) {
                _yield(function () { transformGhost_2303(gameState_2311['johnny'], gameState_2311, (function (_2322) {
                  _yield(function () { transformGhost_2303(gameState_2311['greg'], gameState_2311, (function (_2323) {
                    _yield(function () { transformGhost_2303(gameState_2311['bill'], gameState_2311, (function (_2324) {
                      _yieldCont(_kappa2686, LINKS.union(LINKS.erase(gameState_2311, ['bill', 'greg', 'johnny', 'roger', 'score']), {'score':gameState_2311['score'] + powerPillScore_1915, 'roger':_2321, 'johnny':_2322, 'greg':_2323, 'bill':_2324}))
                      })) })
                    })) })
                  })) })
                })) }); break;}
                 case 'Regular': {var _2325 = _2319._value; _yieldCont(_kappa2686, LINKS.union(LINKS.erase(gameState_2311, ['pillCount', 'score']), {'score':gameState_2311['score'] + regularPillScore_1914, 'pillCount':gameState_2311['pillCount'] + 1})); break;}
                 default: {var _2326 = _2319; _yieldCont(_kappa2686, gameState_2311); break;}
                }
              } else {
              _yield(function () { getNewPills_2317(_lsTail(l_2313), _lsAppend(headPills_2312, _lsCons(pill_2318, lsNil_1903)), gameState_2311, __kappa) })
              }
            })) })
          }
        }
        if ( _lsEmpty(l_2306) ) {
        _yieldCont(__kappa, gameState_2304)
        } else {
        var pillPlanet_2329 = _lsHead(l_2306);
          if ( LINKS.eq(gameState_2304['pillman']['planet'], pillPlanet_2329['1']) ) {
          _yield(function () { getNewPills_2317(pillPlanet_2329['2'], lsNil_1903, gameState_2304, (function (_2332) {
            var newPills_2330 = _2332['2'];
              var gameState_2331 = _2332['1'];
              var t_2333 = _ls(_Cons({'2':newPills_2330, '1':gameState_2331['pillman']['planet']}, Nil));
              var d_2334 = _lsAppend(t_2333, _lsTail(l_2306));
              _yieldCont(__kappa, LINKS.union(LINKS.erase(gameState_2331, ['pills']), {'pills':_lsAppend(headPlanets_2305, d_2334)}))
            })) })
          } else {
          _yield(function () { getNewPillPlanets_2310(_lsTail(l_2306), _lsAppend(headPlanets_2305, _ls(_Cons(pillPlanet_2329, Nil))), gameState_2304, __kappa) })
          }
        }
      }
      function changePillmanPlanet_2338(_2337, __kappa) {
      var gameState_2335 = _2337;
        if ( _not(LINKS.eq(gameState_2335['pillman']['nextPlanet'], gameState_2335['pillman']['planet'])) ) {
        var _kappa2662 = function (newPlanet_2336) {
          _yieldCont(__kappa, LINKS.union(LINKS.erase(gameState_2335, ['pillman']), {'pillman':LINKS.union(LINKS.erase(gameState_2335['pillman'], ['angle', 'planet']), {'planet':newPlanet_2336, 'angle':gameState_2335['pillman']['angle'] + pi_1905})}))
          };
          if ( LINKS.eq(gameState_2335['pillman']['nextPlanet'], leftPortal_1939) ) {
          _yieldCont(_kappa2662, rightGhostPlanet_1928)
          } else {
          if ( LINKS.eq(gameState_2335['pillman']['nextPlanet'], rightPortal_1940) ) {
            _yieldCont(_kappa2662, leftGhostPlanet_1927)
            } else { _yieldCont(_kappa2662, gameState_2335['pillman']['nextPlanet']) }
          }
        } else { _yieldCont(__kappa, gameState_2335) }
      }
      function handleKey_2344(_2342, _2343, __kappa) {
      var gameState_2339 = _2343;
        var k_2340 = _2342;
        if ( _objectEq(k_2340, {'_label':'KeyDown', '_value':restartKeyCode_1999}) ) {
        _yieldCont(__kappa, LINKS.union(LINKS.erase(gameState_2339, ['metaState']), {'metaState':{'_label':'Restart', '_value':{}}}))
        } else {
        if ( _objectEq(k_2340, {'_label':'KeyDown', '_value':downloadKeyCode_2000}) ) {
          _yieldCont(__kappa, LINKS.union(LINKS.erase(gameState_2339, ['metaState']), {'metaState':{'_label':'Download', '_value':{}}}))
          } else {
          if ( LINKS.eq(gameState_2339['state'], {'_label':'On', '_value':{}}) ) {
            if ( _objectEq(k_2340, {'_label':'KeyDown', '_value':spaceKeyCode_1996}) ) {
              _yield(function () { changePillmanPlanet_2338(gameState_2339, (function (gameState_2341) {
                _yieldCont(__kappa, LINKS.union(LINKS.erase(gameState_2341, ['pillman']), {'pillman':LINKS.union(LINKS.erase(gameState_2341['pillman'], ['dir']), {'dir':- gameState_2341['pillman']['dir']})}))
                })) })
              } else {
              if ( _objectEq(k_2340, {'_label':'KeyDown', '_value':zKeyCode_1997}) ) {
                _yieldCont(__kappa, LINKS.union(LINKS.erase(gameState_2339, ['pillman']), {'pillman':LINKS.union(LINKS.erase(gameState_2339['pillman'], ['dir']), {'dir':- gameState_2339['pillman']['dir']})}))
                } else {
                if ( _objectEq(k_2340, {'_label':'KeyDown', '_value':xKeyCode_1998}) ) {
                  _yield(function () { changePillmanPlanet_2338(gameState_2339, __kappa) })
                  } else { _yieldCont(__kappa, gameState_2339) }
                }
              }
            } else { _yieldCont(__kappa, gameState_2339) }
          }
        }
      }
      function handleKeys_2349(_2347, _2348, __kappa) {
      var gs_2345 = _2348;
        var i_2346 = _2347;
        if ( _length(i_2346) > 0 ) {
        _yield(function () { fold_right(handleKey_2344, gs_2345, i_2346, __kappa) })
        } else { _yieldCont(__kappa, gs_2345) }
      }
      function pointDistance_2355(_2353, _2354, __kappa) {
      var p2_2350 = _2354;
        var p1_2351 = _2353;
        _yield(function () { vectorSub(p1_2351, p2_2350, (function (diff_2352) {
        _yieldCont(__kappa, _sqrt((diff_2352['1'] * diff_2352['1']) + (diff_2352['2'] * diff_2352['2'])))
        })) })
      }
      function resetGhost_2362(_2360, _2361, __kappa) {
      var gameState_2356 = _2361;
        var ghost_2357 = _2360;
        var _kappa2663 = function (ghost_2359) {
        _yieldCont(__kappa, LINKS.union(LINKS.erase(ghost_2359, ['planet', 'state', 'state2', 'timeout', 'timeout2']), {'timeout2':0, 'timeout':gameState_2356['timeouts']['trapped'], 'state2':{'_label':'Normal', '_value':{}}, 'state':{'_label':'Trapped', '_value':{}}, 'planet':ghostPlanet_1924}))
        };
        if ( LINKS.eq(ghost_2357['state'], {'_label':'Vulnerable', '_value':{}}) ) {
        _yield(function () { getCurrentSpeed_2296(ghost_2357['baseSpeed'], gameState_2356, (function (_2358) {
          _yieldCont(_kappa2663, LINKS.union(LINKS.erase(ghost_2357, ['speed']), {'speed':_2358}))
          })) })
        } else { _yieldCont(_kappa2663, ghost_2357) }
      }
      function resetPillman_2368(_2366, _2367, __kappa) {
      var gameState_2363 = _2367;
        var pillman_2364 = _2366;
        _yield(function () { getCurrentSpeed_2296(pillman_2364['baseSpeed'], gameState_2363, (function (_2365) {
        _yieldCont(__kappa, LINKS.union(LINKS.erase(pillman_2364, ['angle', 'dir', 'nextPlanet', 'planet', 'speed', 'state']), {'state':{'_label':'Normal', '_value':{}}, 'speed':_2365, 'planet':bottomPlanet_1946, 'nextPlanet':bottomPlanet_1946, 'dir':1, 'angle':pi_1905}))
        })) })
      }
      function lineCircleCollision_2386(_2384, _2385, __kappa) {
      var circle_2369 = _2385;
        var line_2370 = _2384;
        _yield(function () { vectorSub(line_2370['2'], line_2370['1'], (function (_2374) {
        _yield(function () { vectorSub(line_2370['1'], circle_2369['1'], (function (_2373) {
          var f_2371 = {'2':_2373, '1':_2374}['2'];
            var d_2372 = {'2':_2373, '1':_2374}['1'];
            var a_2375 = (d_2372['1'] * d_2372['1']) + (d_2372['2'] * d_2372['2']);
            var b_2376 = 2 * ((f_2371['1'] * d_2372['1']) + (f_2371['2'] * d_2372['2']));
            var c_2377 = ((f_2371['1'] * f_2371['1']) + (f_2371['2'] * f_2371['2'])) - (circle_2369['2'] * circle_2369['2']);
            var delta_2378 = (b_2376 * b_2376) - ((4 * a_2375) * c_2377);
            if ( delta_2378 < 0 ) {
            _yieldCont(__kappa, false)
            } else {
            var delta_2379 = _sqrt(delta_2378);
              var t1_2380 = ((- b_2376) - delta_2379) / (2 * a_2375);
              var t2_2381 = ((- b_2376) + delta_2379) / (2 * a_2375);
              var _kappa2665 = function (_2382) {
              var _kappa2664 = function (_2383) { if ( _2383 ) { _yieldCont(__kappa, true) } else { _yieldCont(__kappa, false) } };
                if ( _2382 ) {
                _yieldCont(_kappa2664, true)
                } else { if ( t2_2381 >= 0 ) { _yieldCont(_kappa2664, t2_2381 <= 1) } else { _yieldCont(_kappa2664, false) } }
              };
              if ( t1_2380 >= 0 ) { _yieldCont(_kappa2665, t1_2380 <= 1) } else { _yieldCont(_kappa2665, false) }
            }
          })) })
        })) })
      }
      function getNextPlanet_2391(_2389, _2390, __kappa) {
      var connections_2387 = _2390;
        var entity_2388 = _2389;
        if ( _lsEmpty(connections_2387) ) {
        _yieldCont(__kappa, entity_2388['planet'])
        } else {
        var x_2392 = _lsHead(connections_2387);
          _yield(function () { lineCircleCollision_2386({'2':{'2':x_2392['2']['y'], '1':x_2392['2']['x']}, '1':{'2':x_2392['1']['y'], '1':x_2392['1']['x']}}, {'2':entity_2388['r'], '1':entity_2388['position']}, (function (_2393) {
          if ( _2393 ) {
            if ( LINKS.eq(entity_2388['planet'], x_2392['2']) ) { _yieldCont(__kappa, x_2392['1']) } else { _yieldCont(__kappa, x_2392['2']) }
            } else { _yield(function () { getNextPlanet_2391(entity_2388, _lsTail(connections_2387), __kappa) }) }
          })) })
        }
      }
      function updateGhost_2408(_2406, _2407, __kappa) {
      var gameState_2394 = _2407;
        var ghost_2395 = _2406;
        var trappedGhostRR_2396 = (ghostPlanet_1924['r'] / 4) + ghostR_1909;
        var _kappa2669 = function (ghostRR_2397) {
        var _kappa2668 = function (_2398) {
          var ghost_2399 = LINKS.union(LINKS.erase(ghost_2395, ['planet']), {'planet':_2398});
            _yield(function () { getNextPlanet_2391(ghost_2399, connections_1952, (function (_2400) {
            var ghost_2401 = LINKS.union(LINKS.erase(ghost_2399, ['angle', 'nextPlanet', 'position']), {'position':{'2':ghost_2399['planet']['y'] + (ghostRR_2397 * _cos(ghost_2399['angle'])), '1':ghost_2399['planet']['x'] + (ghostRR_2397 * _sin(ghost_2399['angle']))}, 'nextPlanet':_2400, 'angle':ghost_2399['angle'] + (ghost_2399['dir'] * ghost_2399['speed'])});
              var _kappa2667 = function (ghost_2402) {
              var _kappa2666 = function (ghost_2405) { _yieldCont(__kappa, ghost_2405) };
                if ( LINKS.eq(ghost_2402['state'], {'_label':'Points', '_value':{}}) ) {
                _yield(function () { getCurrentSpeed_2296(ghost_2402['baseSpeed'], gameState_2394, (function (_2404) {
                  _yieldCont(_kappa2666, LINKS.union(LINKS.erase(ghost_2402, ['speed', 'state', 'timeout']), {'timeout':360, 'state':{'_label':'Eyes', '_value':{}}, 'speed':_2404 * 3}))
                  })) })
                } else {
                if ( ghost_2402['timeout'] > 0 ) {
                  _yieldCont(_kappa2666, LINKS.union(LINKS.erase(ghost_2402, ['timeout']), {'timeout':ghost_2402['timeout'] - 1}))
                  } else {
                  if ( LINKS.eq(ghost_2402['state'], {'_label':'Trapped', '_value':{}}) ) {
                    _yieldCont(_kappa2666, LINKS.union(LINKS.erase(ghost_2402, ['state', 'timeout']), {'timeout':gameState_2394['timeouts']['transition'], 'state':{'_label':'Transition', '_value':{}}}))
                    } else {
                    if ( LINKS.eq(ghost_2402['state'], {'_label':'Transition', '_value':{}}) ) {
                      _yieldCont(_kappa2666, LINKS.union(LINKS.erase(ghost_2402, ['state', 'state2', 'timeout', 'timeout2']), {'timeout2':0, 'timeout':ghost_2402['timeout2'], 'state2':{'_label':'Normal', '_value':{}}, 'state':ghost_2402['state2']}))
                      } else {
                      if ( LINKS.eq(ghost_2402['state'], {'_label':'Vulnerable', '_value':{}}) ) {
                        _yield(function () { getCurrentSpeed_2296(ghost_2402['baseSpeed'], gameState_2394, (function (_2403) {
                          _yieldCont(_kappa2666, LINKS.union(LINKS.erase(ghost_2402, ['speed', 'state', 'timeout']), {'timeout':0, 'state':{'_label':'Normal', '_value':{}}, 'speed':_2403}))
                          })) })
                        } else {
                        if ( LINKS.eq(ghost_2402['state'], {'_label':'Idle', '_value':{}}) ) {
                          _yieldCont(_kappa2666, LINKS.union(LINKS.erase(ghost_2402, ['state', 'timeout']), {'timeout':0, 'state':{'_label':'Normal', '_value':{}}}))
                          } else { _yieldCont(_kappa2666, ghost_2402) }
                        }
                      }
                    }
                  }
                }
              };
              if ( ghost_2401['timeout2'] > 0 ) {
              _yieldCont(_kappa2667, LINKS.union(LINKS.erase(ghost_2401, ['timeout2']), {'timeout2':ghost_2401['timeout2'] - 1}))
              } else { _yieldCont(_kappa2667, ghost_2401) }
            })) })
          };
          if ( LINKS.eq(ghost_2395['planet'], leftPortal_1939) ) {
          _yieldCont(_kappa2668, rightGhostPlanet_1928)
          } else {
          if ( LINKS.eq(ghost_2395['planet'], rightPortal_1940) ) {
            _yieldCont(_kappa2668, leftGhostPlanet_1927)
            } else { _yieldCont(_kappa2668, ghost_2395['planet']) }
          }
        };
        if ( LINKS.eq(ghost_2395['state'], {'_label':'Trapped', '_value':{}}) ) {
        _yieldCont(_kappa2669, trappedGhostRR_2396)
        } else {
        if ( LINKS.eq(ghost_2395['state'], {'_label':'Transition', '_value':{}}) ) {
          _yieldCont(_kappa2669, ((ghost_2395['planet']['r'] / _intToFloat(ghost_2395['timeout'] + 1)) + ghostR_1909) + margin_1906)
          } else { _yieldCont(_kappa2669, (ghost_2395['planet']['r'] + ghostR_1909) + margin_1906) }
        }
      }
      function updatePillman_2416(_2415, __kappa) {
      var gameState_2409 = _2415;
        var pillman_2410 = gameState_2409['pillman'];
        var pillmanRR_2411 = (pillman_2410['planet']['r'] + pillmanR_1911) + margin_1906;
        _yield(function () { getNextPlanet_2391(pillman_2410, connections_1952, (function (_2412) {
        var pillman_2413 = LINKS.union(LINKS.erase(pillman_2410, ['angle', 'nextPlanet', 'position']), {'position':{'2':pillman_2410['planet']['y'] + (pillmanRR_2411 * _cos(pillman_2410['angle'])), '1':pillman_2410['planet']['x'] + (pillmanRR_2411 * _sin(pillman_2410['angle']))}, 'nextPlanet':_2412, 'angle':pillman_2410['angle'] + (pillman_2410['dir'] * pillman_2410['speed'])});
          var _kappa2670 = function (pillman_2414) { _yieldCont(__kappa, pillman_2414) };
          if ( pillman_2413['timeout'] > 0 ) {
          _yieldCont(_kappa2670, LINKS.union(LINKS.erase(pillman_2413, ['timeout']), {'timeout':pillman_2413['timeout'] - 1}))
          } else {
          if ( LINKS.eq(pillman_2413['state'], {'_label':'Normal', '_value':{}}) ) {
            _yieldCont(_kappa2670, LINKS.union(LINKS.erase(pillman_2413, ['state', 'timeout']), {'timeout':gameState_2409['timeouts']['eat'], 'state':{'_label':'Backward', '_value':{}}}))
            } else {
            if ( LINKS.eq(pillman_2413['state'], {'_label':'Backward', '_value':{}}) ) {
              _yieldCont(_kappa2670, LINKS.union(LINKS.erase(pillman_2413, ['state', 'timeout']), {'timeout':gameState_2409['timeouts']['eat'], 'state':{'_label':'Normal', '_value':{}}}))
              } else { _yieldCont(_kappa2670, pillman_2413) }
            }
          }
        })) })
      }
      function mainGameLogic_2549(_2547, _2548, __kappa) {
      var i_2417 = _2548;
        var gameState_2418 = _2547;
        _yield(function () { handleKeys_2349(i_2417, gameState_2418, (function (gameState_2419) {
        function ghostToInt_2422(_2421, __kappa) {
          var ghost_2420 = _2421;
            if ( LINKS.eq(ghost_2420['state'], {'_label':'Vulnerable', '_value':{}}) ) {
            _yieldCont(__kappa, 1)
            } else { _yieldCont(__kappa, 2) }
          }
          function ghostCollision_2425(_2424, __kappa) {
          var ghost_2423 = _2424;
            _yield(function () { circleCircleCollision_2291({'2':pillmanR_1911, '1':gameState_2419['pillman']['position']}, {'2':ghostR_1909, '1':ghost_2423['position']}, __kappa) })
          }
          function isEatState_2428(_2427, __kappa) {
          var ghost_2426 = _2427;
            if ( LINKS.eq(ghost_2426['state'], {'_label':'Normal', '_value':{}}) ) {
            _yieldCont(__kappa, true)
            } else { _yieldCont(__kappa, LINKS.eq(ghost_2426['state'], {'_label':'Idle', '_value':{}})) }
          }
          function ghostToPoints_2433(_2431, _2432, __kappa) {
          var score_2429 = _2432;
            var ghost_2430 = _2431;
            _yieldCont(__kappa, LINKS.union(LINKS.erase(ghost_2430, ['state', 'state2', 'timeout', 'timeout2']), {'timeout2':0, 'timeout':score_2429, 'state2':{'_label':'Normal', '_value':{}}, 'state':{'_label':'Points', '_value':{}}}))
          }
          function eatPillman_2434(__kappa) {
          _yieldCont(__kappa, LINKS.union(LINKS.erase(gameState_2419, ['pillman', 'state', 'timeout']), {'timeout':gameState_2419['timeouts']['eaten'], 'state':{'_label':'Eaten', '_value':{}}, 'pillman':LINKS.union(LINKS.erase(gameState_2419['pillman'], ['state']), {'state':{'_label':'Normal', '_value':{}}})}))
          }
          var _2435 = gameState_2419['state'];
          switch (_2435._label) {case 'Ate': {var _2436 = _2435._value; if ( gameState_2419['timeout'] > 0 ) {
          _yieldCont(__kappa, LINKS.union(LINKS.erase(gameState_2419, ['timeout']), {'timeout':gameState_2419['timeout'] - 1}))
          } else {
          _yieldCont(__kappa, LINKS.union(LINKS.erase(gameState_2419, ['state', 'timeout']), {'timeout':0, 'state':{'_label':'On', '_value':{}}}))
          }; break;}
           case 'Eaten': {var _2437 = _2435._value; var _kappa2671 = function (gameState_2438) { _yieldCont(__kappa, gameState_2438) };
          if ( gameState_2419['timeout'] > 0 ) {
          _yieldCont(_kappa2671, LINKS.union(LINKS.erase(gameState_2419, ['timeout']), {'timeout':gameState_2419['timeout'] - 1}))
          } else {
          _yieldCont(_kappa2671, LINKS.union(LINKS.erase(gameState_2419, ['state', 'timeout']), {'timeout':30, 'state':{'_label':'Eaten2', '_value':{}}}))
          }; break;}
           case 'Eaten2': {var _2439 = _2435._value; var _kappa2672 = function (gameState_2445) {
          if ( gameState_2445['lives'] < 0 ) {
            _yieldCont(__kappa, LINKS.union(LINKS.erase(gameState_2445, ['state']), {'state':{'_label':'Over', '_value':{}}}))
            } else { _yieldCont(__kappa, gameState_2445) }
          };
          if ( gameState_2419['timeout'] > 0 ) {
          _yieldCont(_kappa2672, LINKS.union(LINKS.erase(gameState_2419, ['timeout']), {'timeout':gameState_2419['timeout'] - 1}))
          } else {
          _yield(function () { resetPillman_2368(gameState_2419['pillman'], gameState_2419, (function (_2440) {
            _yield(function () { resetGhost_2362(gameState_2419['roger'], gameState_2419, (function (_2441) {
              _yield(function () { resetGhost_2362(gameState_2419['johnny'], gameState_2419, (function (_2442) {
                _yield(function () { resetGhost_2362(gameState_2419['greg'], gameState_2419, (function (_2443) {
                  _yield(function () { resetGhost_2362(gameState_2419['bill'], gameState_2419, (function (_2444) {
                    _yieldCont(_kappa2672, LINKS.union(LINKS.erase(gameState_2419, ['bill', 'greg', 'johnny', 'lives', 'pillman', 'roger', 'state']), {'state':{'_label':'On', '_value':{}}, 'roger':_2441, 'pillman':_2440, 'lives':gameState_2419['lives'] - 1, 'johnny':_2442, 'greg':_2443, 'bill':_2444}))
                    })) })
                  })) })
                })) })
              })) })
            })) })
          }; break;}
           case 'NextLevel': {var _2446 = _2435._value; if ( gameState_2419['timeout'] > 0 ) {
          _yieldCont(__kappa, LINKS.union(LINKS.erase(gameState_2419, ['timeout']), {'timeout':gameState_2419['timeout'] - 1}))
          } else {
          _yieldCont(__kappa, LINKS.union(LINKS.erase(gameState_2419, ['state', 'timeout']), {'timeout':0, 'state':{'_label':'NextLevel2', '_value':{}}}))
          }; break;}
           case 'NextLevel2': {var _2447 = _2435._value; var gameState_2448 = LINKS.union(LINKS.erase(gameState_2419, ['level']), {'level':gameState_2419['level'] + 1});
          _yield(function () { resetPillman_2368(gameState_2448['pillman'], gameState_2448, (function (_2449) {
          _yield(function () { resetGhost_2362(gameState_2448['roger'], gameState_2448, (function (_2450) {
            _yield(function () { resetGhost_2362(gameState_2448['johnny'], gameState_2448, (function (_2451) {
              _yield(function () { resetGhost_2362(gameState_2448['greg'], gameState_2448, (function (_2452) {
                _yield(function () { resetGhost_2362(gameState_2448['bill'], gameState_2448, (function (_2453) {
                  _yieldCont(function (_2454) {
                    _yieldCont(function (_2455) {
                      _yieldCont(function (_2456) {
                        _yieldCont(function (_2457) {
                          _yieldCont(function (_2458) {
                            var gameState_2459 = LINKS.union(LINKS.erase(gameState_2448, ['bill', 'greg', 'johnny', 'pillCount', 'pillman', 'pills', 'roger', 'state', 'timeout', 'timeouts']), {'timeouts':LINKS.union(LINKS.erase(gameState_2448['timeouts'], ['eat', 'idle', 'transition', 'trapped', 'vulnerable']), {'vulnerable':timeouts_1913['vulnerable'] - _2455, 'trapped':timeouts_1913['trapped'] - _2454, 'transition':timeouts_1913['transition'] - _2456, 'idle':timeouts_1913['idle'] - _2457, 'eat':timeouts_1913['eat'] - _2458}), 'timeout':0, 'state':{'_label':'On', '_value':{}}, 'roger':_2450, 'pills':initialPills_1968, 'pillman':_2449, 'pillCount':0, 'johnny':_2451, 'greg':_2452, 'bill':_2453});
                              if ( gameState_2459['level'] > 255 ) {
                              _yieldCont(__kappa, LINKS.union(LINKS.erase(gameState_2459, ['state']), {'state':{'_label':'Won', '_value':{}}}))
                              } else { _yieldCont(__kappa, gameState_2459) }
                            }, Math.floor(gameState_2448['level'] / 50))
                          }, Math.floor(gameState_2448['level'] / 7))
                        }, Math.floor(gameState_2448['level'] / 25))
                      }, Math.floor(gameState_2448['level'] / 7))
                    }, Math.floor(gameState_2448['level'] / 7))
                  })) })
                })) })
              })) })
            })) })
          })) }); break;}
           case 'On': {var _2460 = _2435._value; function updateEyesGhostAI_2468(_2467, __kappa) {
          var ghost_2461 = _2467;
            if ( LINKS.eq(ghost_2461['planet'], ghostPlanet_1924) ) {
            _yield(function () { getCurrentSpeed_2296(ghost_2461['baseSpeed'], gameState_2419, (function (_2466) {
              _yieldCont(__kappa, LINKS.union(LINKS.erase(ghost_2461, ['speed', 'state', 'state2', 'timeout', 'timeout2']), {'timeout2':0, 'timeout':gameState_2419['timeouts']['trapped'], 'state2':{'_label':'Normal', '_value':{}}, 'state':{'_label':'Trapped', '_value':{}}, 'speed':_2466}))
              })) })
            } else {
            if ( LINKS.eq(ghost_2461['planet'], ghost_2461['nextPlanet']) ) {
              if ( ghost_2461['timeout'] > 0 ) {
                _yieldCont(__kappa, LINKS.union(LINKS.erase(ghost_2461, ['timeout']), {'timeout':ghost_2461['timeout'] - 1}))
                } else {
                _yield(function () { getCurrentSpeed_2296(ghost_2461['baseSpeed'], gameState_2419, (function (_2465) {
                  _yieldCont(__kappa, LINKS.union(LINKS.erase(ghost_2461, ['planet', 'speed', 'state', 'state2', 'timeout', 'timeout2']), {'timeout2':0, 'timeout':gameState_2419['timeouts']['trapped'], 'state2':{'_label':'Normal', '_value':{}}, 'state':{'_label':'Trapped', '_value':{}}, 'speed':_2465, 'planet':ghostPlanet_1924}))
                  })) })
                }
              } else {
              var targetPosition_2462 = {'2':ghostPlanet_1924['y'], '1':ghostPlanet_1924['x']};
                _yield(function () { pointDistance_2355({'2':ghost_2461['nextPlanet']['y'], '1':ghost_2461['nextPlanet']['x']}, targetPosition_2462, (function (_2464) {
                _yield(function () { pointDistance_2355({'2':ghost_2461['planet']['y'], '1':ghost_2461['planet']['x']}, targetPosition_2462, (function (_2463) {
                  if ( _2464 < _2463 ) {
                    _yieldCont(__kappa, LINKS.union(LINKS.erase(ghost_2461, ['angle', 'planet']), {'planet':ghost_2461['nextPlanet'], 'angle':ghost_2461['angle'] + pi_1905}))
                    } else { _yieldCont(__kappa, ghost_2461) }
                  })) })
                })) })
              }
            }
          }
          function updateVulnerableGhostAI_2476(_2475, __kappa) {
          var ghost_2469 = _2475;
            var pillman_2470 = gameState_2419['pillman'];
            var _kappa2673 = function (ghost_2474) {
            if ( LINKS.eq(ghost_2474['planet'], pillman_2470['planet']) ) {
              _yieldCont(__kappa, LINKS.union(LINKS.erase(ghost_2474, ['dir']), {'dir':pillman_2470['dir']}))
              } else { _yieldCont(__kappa, ghost_2474) }
            };
            if ( LINKS.eq(ghost_2469['planet'], ghost_2469['nextPlanet']) ) {
            _yieldCont(_kappa2673, ghost_2469)
            } else {
            var targetPosition_2471 = {'2':pillman_2470['planet']['y'], '1':pillman_2470['planet']['x']};
              _yield(function () { pointDistance_2355({'2':ghost_2469['nextPlanet']['y'], '1':ghost_2469['nextPlanet']['x']}, targetPosition_2471, (function (_2473) {
              _yield(function () { pointDistance_2355({'2':ghost_2469['planet']['y'], '1':ghost_2469['planet']['x']}, targetPosition_2471, (function (_2472) {
                if ( _2473 > _2472 ) {
                  _yieldCont(_kappa2673, LINKS.union(LINKS.erase(ghost_2469, ['angle', 'planet']), {'planet':ghost_2469['nextPlanet'], 'angle':ghost_2469['angle'] + pi_1905}))
                  } else { _yieldCont(_kappa2673, ghost_2469) }
                })) })
              })) })
            }
          }
          function updateBillAI_2485(_2484, __kappa) {
          var ghost_2477 = _2484;
            var pillman_2478 = gameState_2419['pillman'];
            var _kappa2674 = function (ghost_2483) { _yieldCont(__kappa, ghost_2483) };
            if ( LINKS.eq(ghost_2477['state'], {'_label':'Normal', '_value':{}}) ) {
            var _kappa2675 = function (ghost_2482) {
              if ( LINKS.eq(ghost_2482['planet'], pillman_2478['planet']) ) {
                _yieldCont(_kappa2674, LINKS.union(LINKS.erase(ghost_2482, ['dir']), {'dir':- gameState_2419['johnny']['dir']}))
                } else { _yieldCont(_kappa2674, ghost_2482) }
              };
              if ( LINKS.eq(ghost_2477['planet'], ghost_2477['nextPlanet']) ) {
              _yieldCont(_kappa2675, ghost_2477)
              } else {
              var targetPosition_2479 = {'2':pillman_2478['position']['2'], '1':pillman_2478['position']['1']};
                _yield(function () { pointDistance_2355({'2':ghost_2477['nextPlanet']['y'], '1':ghost_2477['nextPlanet']['x']}, targetPosition_2479, (function (_2481) {
                _yield(function () { pointDistance_2355({'2':ghost_2477['planet']['y'], '1':ghost_2477['planet']['x']}, targetPosition_2479, (function (_2480) {
                  if ( _2481 < _2480 ) {
                    _yieldCont(_kappa2675, LINKS.union(LINKS.erase(ghost_2477, ['angle', 'planet']), {'planet':ghost_2477['nextPlanet'], 'angle':ghost_2477['angle'] + pi_1905}))
                    } else { _yieldCont(_kappa2675, ghost_2477) }
                  })) })
                })) })
              }
            } else {
            if ( LINKS.eq(ghost_2477['state'], {'_label':'Vulnerable', '_value':{}}) ) {
              _yield(function () { updateVulnerableGhostAI_2476(ghost_2477, _kappa2674) })
              } else {
              if ( LINKS.eq(ghost_2477['state'], {'_label':'Eyes', '_value':{}}) ) {
                _yield(function () { updateEyesGhostAI_2468(ghost_2477, _kappa2674) })
                } else { _yieldCont(_kappa2674, ghost_2477) }
              }
            }
          }
          function updateGregAI_2495(_2494, __kappa) {
          var ghost_2486 = _2494;
            var pillman_2487 = gameState_2419['pillman'];
            var _kappa2676 = function (ghost_2493) { _yieldCont(__kappa, ghost_2493) };
            if ( LINKS.eq(ghost_2486['state'], {'_label':'Normal', '_value':{}}) ) {
            var _kappa2677 = function (ghost_2492) { _yieldCont(_kappa2676, ghost_2492) };
              if ( LINKS.eq(ghost_2486['planet'], ghost_2486['nextPlanet']) ) {
              _yieldCont(_kappa2677, ghost_2486)
              } else {
              var targetPosition_2488 = {'2':gameState_2419['roger']['planet']['y'], '1':gameState_2419['roger']['planet']['x']};
                var targetPosition2_2489 = {'2':pillman_2487['planet']['y'], '1':pillman_2487['planet']['x']};
                _yield(function () { pointDistance_2355({'2':ghost_2486['nextPlanet']['y'], '1':ghost_2486['nextPlanet']['x']}, targetPosition_2488, (function (_2491) {
                _yield(function () { pointDistance_2355({'2':ghost_2486['planet']['y'], '1':ghost_2486['planet']['x']}, targetPosition2_2489, (function (_2490) {
                  if ( _2491 < _2490 ) {
                    _yieldCont(_kappa2677, LINKS.union(LINKS.erase(ghost_2486, ['angle', 'planet', 'state', 'timeout']), {'timeout':gameState_2419['timeouts']['idle'], 'state':{'_label':'Idle', '_value':{}}, 'planet':ghost_2486['nextPlanet'], 'angle':ghost_2486['angle'] + pi_1905}))
                    } else { _yieldCont(_kappa2677, ghost_2486) }
                  })) })
                })) })
              }
            } else {
            if ( LINKS.eq(ghost_2486['state'], {'_label':'Vulnerable', '_value':{}}) ) {
              _yield(function () { updateVulnerableGhostAI_2476(ghost_2486, _kappa2676) })
              } else {
              if ( LINKS.eq(ghost_2486['state'], {'_label':'Eyes', '_value':{}}) ) {
                _yield(function () { updateEyesGhostAI_2468(ghost_2486, _kappa2676) })
                } else { _yieldCont(_kappa2676, ghost_2486) }
              }
            }
          }
          function updateJohnnyAI_2505(_2504, __kappa) {
          var ghost_2496 = _2504;
            var pillman_2497 = gameState_2419['pillman'];
            var _kappa2678 = function (ghost_2503) { _yieldCont(__kappa, ghost_2503) };
            if ( LINKS.eq(ghost_2496['state'], {'_label':'Normal', '_value':{}}) ) {
            var _kappa2679 = function (ghost_2502) { _yieldCont(_kappa2678, ghost_2502) };
              if ( LINKS.eq(ghost_2496['planet'], ghost_2496['nextPlanet']) ) {
              _yieldCont(_kappa2679, ghost_2496)
              } else {
              var targetPosition_2498 = {'2':pillman_2497['planet']['y'], '1':pillman_2497['planet']['x']};
                var targetPosition2_2499 = {'2':gameState_2419['greg']['planet']['y'], '1':gameState_2419['greg']['planet']['x']};
                _yield(function () { pointDistance_2355({'2':gameState_2419['roger']['planet']['y'], '1':gameState_2419['roger']['planet']['x']}, targetPosition_2498, (function (_2501) {
                _yield(function () { pointDistance_2355({'2':ghost_2496['planet']['y'], '1':ghost_2496['planet']['x']}, targetPosition2_2499, (function (_2500) {
                  if ( _2501 < _2500 ) {
                    _yieldCont(_kappa2679, LINKS.union(LINKS.erase(ghost_2496, ['angle', 'dir', 'planet', 'state', 'timeout']), {'timeout':gameState_2419['timeouts']['idle'], 'state':{'_label':'Idle', '_value':{}}, 'planet':ghost_2496['nextPlanet'], 'dir':- ghost_2496['dir'], 'angle':ghost_2496['angle'] + pi_1905}))
                    } else { _yieldCont(_kappa2679, ghost_2496) }
                  })) })
                })) })
              }
            } else {
            if ( LINKS.eq(ghost_2496['state'], {'_label':'Vulnerable', '_value':{}}) ) {
              _yield(function () { updateVulnerableGhostAI_2476(ghost_2496, _kappa2678) })
              } else {
              if ( LINKS.eq(ghost_2496['state'], {'_label':'Eyes', '_value':{}}) ) {
                _yield(function () { updateEyesGhostAI_2468(ghost_2496, _kappa2678) })
                } else { _yieldCont(_kappa2678, ghost_2496) }
              }
            }
          }
          function updateRogerAI_2514(_2513, __kappa) {
          var ghost_2506 = _2513;
            var pillman_2507 = gameState_2419['pillman'];
            var _kappa2680 = function (ghost_2512) { _yieldCont(__kappa, ghost_2512) };
            if ( LINKS.eq(ghost_2506['state'], {'_label':'Normal', '_value':{}}) ) {
            var _kappa2681 = function (ghost_2511) {
              if ( LINKS.eq(ghost_2511['planet'], pillman_2507['planet']) ) {
                _yieldCont(_kappa2680, LINKS.union(LINKS.erase(ghost_2511, ['dir']), {'dir':- pillman_2507['dir']}))
                } else { _yieldCont(_kappa2680, ghost_2511) }
              };
              if ( LINKS.eq(ghost_2506['planet'], ghost_2506['nextPlanet']) ) {
              _yieldCont(_kappa2681, ghost_2506)
              } else {
              var targetPosition_2508 = {'2':pillman_2507['planet']['y'], '1':pillman_2507['planet']['x']};
                _yield(function () { pointDistance_2355({'2':ghost_2506['nextPlanet']['y'], '1':ghost_2506['nextPlanet']['x']}, targetPosition_2508, (function (_2510) {
                _yield(function () { pointDistance_2355({'2':ghost_2506['planet']['y'], '1':ghost_2506['planet']['x']}, targetPosition_2508, (function (_2509) {
                  if ( _2510 < _2509 ) {
                    _yieldCont(_kappa2681, LINKS.union(LINKS.erase(ghost_2506, ['angle', 'planet']), {'planet':ghost_2506['nextPlanet'], 'angle':ghost_2506['angle'] + pi_1905}))
                    } else { _yieldCont(_kappa2681, ghost_2506) }
                  })) })
                })) })
              }
            } else {
            if ( LINKS.eq(ghost_2506['state'], {'_label':'Vulnerable', '_value':{}}) ) {
              _yield(function () { updateVulnerableGhostAI_2476(ghost_2506, _kappa2680) })
              } else {
              if ( LINKS.eq(ghost_2506['state'], {'_label':'Eyes', '_value':{}}) ) {
                _yield(function () { updateEyesGhostAI_2468(ghost_2506, _kappa2680) })
                } else { _yieldCont(_kappa2680, ghost_2506) }
              }
            }
          }
          _yield(function () { updatePillman_2416(gameState_2419, (function (_2515) {
          _yield(function () { updateRogerAI_2514(gameState_2419['roger'], (function (_2516) {
            _yield(function () { updateGhost_2408(_2516, gameState_2419, (function (_2517) {
              _yield(function () { updateJohnnyAI_2505(gameState_2419['johnny'], (function (_2518) {
                _yield(function () { updateGhost_2408(_2518, gameState_2419, (function (_2519) {
                  _yield(function () { updateGregAI_2495(gameState_2419['greg'], (function (_2520) {
                    _yield(function () { updateGhost_2408(_2520, gameState_2419, (function (_2521) {
                      _yield(function () { updateBillAI_2485(gameState_2419['bill'], (function (_2522) {
                        _yield(function () { updateGhost_2408(_2522, gameState_2419, (function (_2523) {
                          var gameState_2524 = LINKS.union(LINKS.erase(gameState_2419, ['bill', 'greg', 'johnny', 'pillman', 'roger']), {'roger':_2517, 'pillman':_2515, 'johnny':_2519, 'greg':_2521, 'bill':_2523});
                            _yield(function () { getNewPillPlanets_2310(gameState_2524['pills'], _lsNilF(), gameState_2524, (function (gameState_2525) {
                            _yield(function () { ghostToInt_2422(gameState_2525['roger'], (function (_2529) {
                              _yield(function () { ghostToInt_2422(gameState_2525['johnny'], (function (_2528) {
                                _yield(function () { ghostToInt_2422(gameState_2525['greg'], (function (_2527) {
                                  _yield(function () { ghostToInt_2422(gameState_2525['bill'], (function (_2526) {
                                    var ghostScore_2530 = (((200 * _2529) * _2528) * _2527) * _2526;
                                      _yield(function () { ghostCollision_2425(gameState_2525['roger'], (function (_2542) {
                                      var _kappa2683 = function (gameState_2543) {
                                        var _kappa2682 = function (gameState_2544) { _yieldCont(__kappa, gameState_2544) };
                                          if ( LINKS.eq(gameState_2543['pillCount'], pillCount_1982) ) {
                                          _yieldCont(_kappa2682, LINKS.union(LINKS.erase(gameState_2543, ['state', 'timeout']), {'timeout':60, 'state':{'_label':'NextLevel', '_value':{}}}))
                                          } else { _yieldCont(_kappa2682, gameState_2543) }
                                        };
                                        if ( _2542 ) {
                                        if ( LINKS.eq(gameState_2525['roger']['state'], {'_label':'Vulnerable', '_value':{}}) ) {
                                          _yield(function () { ghostToPoints_2433(gameState_2525['roger'], ghostScore_2530, (function (_2541) {
                                            _yieldCont(_kappa2683, LINKS.union(LINKS.erase(gameState_2525, ['roger', 'score', 'state', 'timeout']), {'timeout':gameState_2525['timeouts']['ate'], 'state':{'_label':'Ate', '_value':{}}, 'score':gameState_2525['score'] + ghostScore_2530, 'roger':_2541}))
                                            })) })
                                          } else {
                                          _yield(function () { isEatState_2428(gameState_2525['roger'], (function (_2540) {
                                            if ( _2540 ) {
                                              _yield(function () { eatPillman_2434(_kappa2683) })
                                              } else { _yieldCont(_kappa2683, gameState_2525) }
                                            })) })
                                          }
                                        } else {
                                        _yield(function () { ghostCollision_2425(gameState_2525['johnny'], (function (_2539) {
                                          if ( _2539 ) {
                                            if ( LINKS.eq(gameState_2525['johnny']['state'], {'_label':'Vulnerable', '_value':{}}) ) {
                                              _yield(function () { ghostToPoints_2433(gameState_2525['johnny'], ghostScore_2530, (function (_2538) {
                                                _yieldCont(_kappa2683, LINKS.union(LINKS.erase(gameState_2525, ['johnny', 'score', 'state', 'timeout']), {'timeout':gameState_2525['timeouts']['ate'], 'state':{'_label':'Ate', '_value':{}}, 'score':gameState_2525['score'] + ghostScore_2530, 'johnny':_2538}))
                                                })) })
                                              } else {
                                              _yield(function () { isEatState_2428(gameState_2525['johnny'], (function (_2537) {
                                                if ( _2537 ) {
                                                  _yield(function () { eatPillman_2434(_kappa2683) })
                                                  } else { _yieldCont(_kappa2683, gameState_2525) }
                                                })) })
                                              }
                                            } else {
                                            _yield(function () { ghostCollision_2425(gameState_2525['greg'], (function (_2536) {
                                              if ( _2536 ) {
                                                if ( LINKS.eq(gameState_2525['greg']['state'], {'_label':'Vulnerable', '_value':{}}) ) {
                                                  _yield(function () { ghostToPoints_2433(gameState_2525['greg'], ghostScore_2530, (function (_2535) {
                                                    _yieldCont(_kappa2683, LINKS.union(LINKS.erase(gameState_2525, ['greg', 'score', 'state', 'timeout']), {'timeout':gameState_2525['timeouts']['ate'], 'state':{'_label':'Ate', '_value':{}}, 'score':gameState_2525['score'] + ghostScore_2530, 'greg':_2535}))
                                                    })) })
                                                  } else {
                                                  _yield(function () { isEatState_2428(gameState_2525['greg'], (function (_2534) {
                                                    if ( _2534 ) {
                                                      _yield(function () { eatPillman_2434(_kappa2683) })
                                                      } else { _yieldCont(_kappa2683, gameState_2525) }
                                                    })) })
                                                  }
                                                } else {
                                                _yield(function () { ghostCollision_2425(gameState_2525['bill'], (function (_2533) {
                                                  if ( _2533 ) {
                                                    if ( LINKS.eq(gameState_2525['bill']['state'], {'_label':'Vulnerable', '_value':{}}) ) {
                                                      _yield(function () { ghostToPoints_2433(gameState_2525['bill'], ghostScore_2530, (function (_2532) {
                                                        _yieldCont(_kappa2683, LINKS.union(LINKS.erase(gameState_2525, ['bill', 'score', 'state', 'timeout']), {'timeout':gameState_2525['timeouts']['ate'], 'state':{'_label':'Ate', '_value':{}}, 'score':gameState_2525['score'] + ghostScore_2530, 'bill':_2532}))
                                                        })) })
                                                      } else {
                                                      _yield(function () { isEatState_2428(gameState_2525['bill'], (function (_2531) {
                                                        if ( _2531 ) {
                                                          _yield(function () { eatPillman_2434(_kappa2683) })
                                                          } else { _yieldCont(_kappa2683, gameState_2525) }
                                                        })) })
                                                      }
                                                    } else { _yieldCont(_kappa2683, gameState_2525) }
                                                  })) })
                                                }
                                              })) })
                                            }
                                          })) })
                                        }
                                      })) })
                                    })) })
                                  })) })
                                })) })
                              })) })
                            })) })
                          })) })
                        })) })
                      })) })
                    })) })
                  })) })
                })) })
              })) })
            })) })
          })) }); break;}
           case 'Over': {var _2545 = _2435._value; _yieldCont(__kappa, gameState_2419); break;}
           default: {var _2546 = _2435; _yieldCont(__kappa, gameState_2419); break;}
          }
        })) })
      }
      function getInitialGameState_2550(__kappa) {
      _yieldCont(__kappa, {'timeouts':timeouts_1913, 'timeout':0, 'state':{'_label':'On', '_value':{}}, 'score':0, 'roger':rogerGhost_1983, 'pills':initialPills_1968, 'pillman':pillmanDescription_2006, 'pillCount':0, 'metaState':{'_label':'Run', '_value':{}}, 'lives':3, 'level':1, 'johnny':johnnyGhost_1984, 'greg':gregGhost_1985, 'bill':billGhost_1986})
      }
      function updateLogic_2557(_2554, _2555, _2556, __kappa) {
      var i_2551 = _2556;
        var gameState_2552 = _2555;
        var dt_2553 = _2554;
        if ( dt_2553 > step_2002 ) {
        _yield(function () { mainGameLogic_2549(gameState_2552, i_2551, (function (gameState_2558) {
          _yield(function () { updateLogic_2557(dt_2553 - step_2002, gameState_2558, Nil, __kappa) })
          })) })
        } else { _yieldCont(__kappa, {'2':dt_2553, '1':gameState_2552}) }
      }
      function updateState_2559(__kappa) {
      function mainLoop_2570(_2565, _2566, _2567, _2568, _2569, __kappa) {
        var ii_2560 = _2569;
          var fpsInfo_2561 = _2568;
          var lastTime_2562 = _2567;
          var dt_2563 = _2566;
          var gameState_2564 = _2565;
          (function (now_2571) {
          _yield(function () { fmin(1, _intToFloat(now_2571 - lastTime_2562) / 1000, (function (_2572) {
            var dt_2573 = dt_2563 + _2572;
              function aux_2576(_2575, __kappa) {
              var auxi_2574 = _2575;
                (function (_2578) {
                if ( _2578 ) {
                  _yield(function () { recv((function (_2577) { _yield(function () { aux_2576(_Cons(_2577, auxi_2574), __kappa) }) })) })
                  } else { _yieldCont(__kappa, auxi_2574) }
                })(_haveMail())
              }
              _yield(function () { aux_2576(ii_2560, (function (i_2579) {
              _yield(function () { updateLogic_2557(dt_2573, gameState_2564, i_2579, (function (_2582) {
                var dtPrim_2580 = _2582['2'];
                  var gameStatePrim_2581 = _2582['1'];
                  if ( LINKS.eq(gameStatePrim_2581['metaState'], {'_label':'Restart', '_value':{}}) ) {
                  _yieldCont(__kappa, {})
                  } else {
                  if ( _floatEq(dtPrim_2580, dt_2573) ) {
                    _yield(function () { mainLoop_2570(gameStatePrim_2581, dtPrim_2580, now_2571, fpsInfo_2561, i_2579, __kappa) })
                    } else {
                    var _kappa2685 = function (_2583) {
                      _yield(function () { draw_2284(gameStatePrim_2581, lastTime_2562, now_2571, fpsInfo_2561, (function (_2584) {
                        _yield(function () { mainLoop_2570(_2583, dtPrim_2580, now_2571, _2584, Nil, __kappa) })
                        })) })
                      };
                      if ( LINKS.eq(gameStatePrim_2581['metaState'], {'_label':'Download', '_value':{}}) ) {
                      _yieldCont(_kappa2685, LINKS.union(LINKS.erase(gameStatePrim_2581, ['metaState']), {'metaState':{'_label':'Run', '_value':{}}}))
                      } else { _yieldCont(_kappa2685, gameStatePrim_2581) }
                    }
                  }
                })) })
              })) })
            })) })
          })(_clientTime())
        }
        _yield(function () { recv((function (_2585) {
        _yield(function () { getInitialGameState_2550((function (_2589) {
          (function (_2590) {
            _yield(function () { mainLoop_2570(_2589, 0, _2590, initialFpsInfo_2003, Nil, (function (_2591) {
              (function (_2587) {
                var _kappa2684 = function (_2588) { _yield(function () { updateState_2559(__kappa) }) };
                  if ( _not(_2587) ) {
                  (function (_2586) { _kappa2684(_Send(_2586, {'_label':'CarryOn', '_value':{}})) })(_self())
                  } else { _yieldCont(_kappa2684, {}) }
                })(_haveMail())
              })) })
            })(_clientTime())
          })) })
        })) })
      }
      function _fun__g129_2593(__kappa) { _yield(function () { updateState_2559((function (_2592) { _yieldCont(__kappa, _2592) })) }) }
      (function (updateProcId_2594) {
      function onKeyUp_2598(_2597, __kappa) {
        var e_2595 = _2597;
          (function (_2596) { _yieldCont(__kappa, {}) })(_Send(updateProcId_2594, {'_label':'KeyUp', '_value':_getCharCode(e_2595)}))
        }
        function onKeyDown_2602(_2601, __kappa) {
        var e_2599 = _2601;
          (function (_2600) { _yieldCont(__kappa, {}) })(_Send(updateProcId_2594, {'_label':'KeyDown', '_value':_getCharCode(e_2599)}))
        }
        function initialize_2610(__kappa) {
        _yield(function () { recv((function (_2603) {
          (function (_2608) {
            (function (_2609) {
              (function (_2606) {
                (function (_2607) {
                  (function (_2604) {
                    (function (_2605) {
                      __kappa(_Send(updateProcId_2594, {'_label':'CarryOn', '_value':{}}))
                      })(_domSetStyleAttrFromRef(_2604, 'display', 'none'))
                    })(_getNodeById('info'))
                  })(_jsSetOnEvent(_2606, 'keyup', onKeyUp_2598, true))
                })(_getNodeById(containerId_1989))
              })(_jsSetOnKeyDown(_2608, onKeyDown_2602))
            })(_getNodeById(containerId_1989))
          })) })
        }
        function _fun__g130_2611(__kappa) { _yield(function () { initialize_2610(__kappa) }) }
        (function (initializeProcId_2612) {
        function _fun__g131_2616(_2615, __kappa) {
          var event_2613 = _2615; (function (_2614) { _yieldCont(__kappa, {}) })(_Send(initializeProcId_2612, 0))
          }
          (function (_2617) {
          _yield(function () { bodyP(LINKS.XML('html', {}, [_stringToXml('\n			'), LINKS.XML('head', {}, [_stringToXml('\n            '), LINKS.XML('style', {}, [_stringToXml('\n				body '), _stringToXml('{'), _stringToXml('\n					background-color: #111;\n					color: #ddd;\n				'), _stringToXml('}'), _stringToXml('\n\n				a '), _stringToXml('{'), _stringToXml('\n					color: #d99;\n				'), _stringToXml('}'), _stringToXml('\n\n				#info '), _stringToXml('{'), _stringToXml('\n					font-size: 48px;\n				'), _stringToXml('}'), _stringToXml('\n\n				#container '), _stringToXml('{'), _stringToXml('\n					width: 50%;\n					margin: auto;\n					text-align: center;\n				'), _stringToXml('}'), _stringToXml('\n\n				#'), _stringToXml(containerId_1989), _stringToXml(' '), _stringToXml('{'), _stringToXml('\n					position: relative;\n					width: '), _stringToXml(_floatToString(canvasWidth_1990)), _stringToXml('px;\n					height: '), _stringToXml(_floatToString(canvasHeight_1991)), _stringToXml('px;\n					background-color: #010101;\n					margin: auto;\n				'), _stringToXml('}'), _stringToXml('\n\n				#'), _stringToXml(canvas2Id_1988), _stringToXml(' '), _stringToXml('{'), _stringToXml('\n					display: none;\n					position: absolute;\n					top: 0px;\n					left: 0px;\n				'), _stringToXml('}'), _stringToXml('\n\n				#'), _stringToXml(canvasId_1987), _stringToXml(' '), _stringToXml('{'), _stringToXml('\n					display: block;\n					position: absolute;\n					top: 0px;\n					left: 0px;\n				'), _stringToXml('}'), _stringToXml('\n            ')]), _stringToXml('\n			')]), _stringToXml('\n\n			'), LINKS.XML('body', {}, [_stringToXml('\n				'), LINKS.XML('div', {'id':'container'}, [_stringToXml('\n					'), LINKS.XML('h1', {}, [_stringToXml('Pillman')]), _stringToXml('\n\n					'), LINKS.XML('div', {'tabindex':'1', 'key':_2617, 'id':containerId_1989}, [_stringToXml('\n						'), LINKS.XML('canvas', {'width':_floatToString(canvasWidth_1990), 'id':canvas2Id_1988, 'height':_floatToString(canvasHeight_1991)}, []), _stringToXml('\n						'), LINKS.XML('canvas', {'width':_floatToString(canvasWidth_1990), 'id':canvasId_1987, 'height':_floatToString(canvasHeight_1991)}, []), _stringToXml('\n						'), LINKS.XML('div', {'id':'info'}, [_stringToXml('Click this canvas to start.')]), _stringToXml('\n					')]), _stringToXml('\n					'), LINKS.XML('div', {'id':'msg'}, []), _stringToXml('\n					'), LINKS.XML('span', {}, [_stringToXml('The canvas above must be focused for the keyboard input to work.')]), LINKS.XML('br', {}, []), _stringToXml('\n					'), LINKS.XML('span', {}, [_stringToXml('[SPACEBAR] controls Pillman')]), LINKS.XML('br', {}, []), _stringToXml('\n					'), LINKS.XML('span', {}, [_stringToXml('or alternatively')]), LINKS.XML('br', {}, []), _stringToXml('\n					'), LINKS.XML('span', {}, [_stringToXml('[Z] changes Pillman\'s direction and [X] changes Pillman\'s planet')]), LINKS.XML('br', {}, []), _stringToXml('\n					'), LINKS.XML('br', {}, []), _stringToXml('\n					'), LINKS.XML('span', {}, [_stringToXml('[F2] restarts the game')]), LINKS.XML('br', {}, []), _stringToXml('\n					'), LINKS.XML('span', {}, [_stringToXml('[F4] snapshots the canvas')]), LINKS.XML('br', {}, []), _stringToXml('\n					'), LINKS.XML('a', {'tabindex':'2', 'id':'download', 'download':''}, []), _stringToXml('\n				')]), _stringToXml('\n			')]), _stringToXml('\n		')]), __kappa) })
          })(_registerEventHandlers(_Cons({'2':_fun__g131_2616, '1':'focus'}, Nil)))
        })(_spawn(_fun__g130_2611))
      })(_spawn(_fun__g129_2593))
    })) })
  })) })
}
_yield(function () { main((function (_2619) { _yield(function () { renderPage(_2619, _start) }) })) });
  </script>
</html>
